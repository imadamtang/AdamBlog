{"posts": [{"title": "Nand Flash \u7ed3\u6784", "date": "2025-01-06T16:00:00+08.00", "path": "https://blog.imadamtang.cn/archives/Nand%20Flash%20%E7%BB%93%E6%9E%84/", "text": "\u80cc\u666f\nNand Flash\u662f\u4e00\u79cd\u975e\u6613\u5931\u6027\u5b58\u50a8\u5668\uff0c\u751f\u6d3b\u4e2d\u5e38\u89c1\u7684u\u76d8\u3001ssd\u76d8\u3001sd\u5361\u7b49\u5668\u4ef6\u90fd\u6709\u5305\u542b\u3002\nThe two main types of flash memory, NOR flash and NAND flash, are named for the NOR and NAND logic gates. Both use the same cell design, consisting of floating-gate MOSFETs. They differ at the circuit level depending on whether the state of the bit line or word lines is pulled high or low: in NAND flash, the relationship between the bit line and the word lines resembles a NAND gate; in NOR flash, it resembles a NOR gate.\n\u6839\u636e\u7ef4\u57fa\u767e\u79d1\u5173\u4e8e\u7684\u4ecb\u7ecd\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230Nand Flash\u662fFlash Memory\u4e2d\u7684\u4e00\u79cd\uff0c\u5176\u4e2dNand\u4e3aNOT AND\uff08\u4e0e\u975e\uff09\u7f29\u5199\uff0c\u53e6\u4e00\u79cd\u662fNor Flash\uff0cNor\u4e3aNOT OR\uff08\u6216\u975e\uff09\u7f29\u5199\u3002\u4e4b\u6240\u4ee5\u8fd9\u4e48\u53eb\uff0c\u662f\u56e0\u4e3a\u8fd9\u4e24\u79cdFlash\u67b6\u6784\u4e0e\u903b\u8f91\u7535\u8def\u4e2d\u7684\u4e0e\u975e\u95e8\u3001\u6216\u975e\u95e8\u7c7b\u4f3c\uff0c\u8fd9\u4e2a\u5730\u65b9\u505a\u4e00\u4e2a\u521d\u6b65\u4e86\u89e3\u5373\u53ef\u3002\n\u6d6e\u6805MOS\u7ba1\nNand Flash\u4e3a\u4ec0\u4e48\u80fd\u5b58\u50a8\u6570\u636e\uff0c\u8fd9\u5c31\u7275\u6d89\u5230\u4e00\u4e2a\u53ebMOS\u7ba1\u7684\u4e1c\u897f\u3002\u8ba4\u8bc6MOS\u7ba1\u4e4b\u524d\uff0c\u5148\u4e86\u89e3\u4e0b\u4ec0\u4e48\u662fPN\u7ed3\u3002PN\u7ed3\u662f\u7531N\u578b\u6750\u6599\u548cP\u578b\u6750\u6599\u7ec4\u5408\u800c\u6210\u7684\u3002N\u578b\u6750\u6599\u5305\u542b\u8f83\u591a\u7535\u5b50\uff0c\u5e26\u8d1f\u7535\uff1bP\u578b\u6750\u6599\u5305\u542b\u8f83\u591a\u7a7a\u7a74\uff0c\u5e26\u6b63\u7535\u3002\u5f53\u4e24\u79cd\u6750\u6599\u7ed3\u5408\u65f6\uff0cN\u578b\u6750\u6599\u4e2d\u7684\u7535\u5b50\u5929\u7136\u5730\u8dd1\u5411P\u578b\u6750\u6599\uff0c\u5728PN\u6750\u6599\u7ed3\u5408\u5904\uff0c\u4f1a\u5f62\u6210\u4e00\u4e2a\u8fc7\u6e21\u5c42\uff08\u4e5f\u53eb\u8017\u5c3d\u5c42\uff09\uff0c\u8fd9\u5c31\u53ebPN\u7ed3\u3002\n\u7531\u4e8ePN\u7ed3\u4e2d\u7535\u5b50\u4eceN\u5411P\u6269\u6563\uff0c\u5bfc\u81f4\u9760N\u533a\u4e00\u4fa7\u5931\u53bb\u7535\u5b50\u5e26\u6b63\u7535\uff0c\u9760P\u533a\u4e00\u4fa7\u83b7\u5f97\u7535\u5b50\u5e26\u8d1f\u7535\uff0c\u5f62\u6210N\u533a\u6307\u5411P\u533a\u7684\u7535\u573a\uff0c\u5373PN\u7ed3\u5185\u7535\u573a\u3002\u4e5f\u6b63\u662f\u7531\u4e8e\u8fd9\u7535\u573a\u7684\u5b58\u5728\uff0cN\u533a\u7535\u5b50\u65e0\u6cd5\u7ee7\u7eed\u6269\u6563\uff0c\u4f7f\u5f97PN\u7ed3\u6574\u4f53\u5448\u7535\u4e2d\u6027\u3002\u800c\u5f53N\u533a\u4e00\u4fa7\u63a5\u8d1f\u6781\uff0cP\u533a\u4e00\u4fa7\u63a5\u6b63\u6781\u65f6\uff0c\u5916\u90e8\u6b63\u5411\u7535\u538b\u5f62\u6210\u7684\u7535\u573a\u65b9\u5411\u4e0ePN\u7ed3\u5185\u7535\u573a\u65b9\u5411\u76f8\u53cd\uff0c\u4f7f\u5f97\u5185\u7535\u573a\u88ab\u524a\u5f31\uff0c\u4ece\u800c\u4f7f\u5f97\u7535\u5b50\u80fd\u591f\u4eceN\u533a\u987a\u5229\u6269\u6563\u5230P\u533a\uff0cPN\u7ed3\u5bfc\u901a\u3002\u53cd\u4e4b\uff0c\u5185\u7535\u573a\u6269\u5927\uff0c\u7535\u5b50\u66f4\u52a0\u65e0\u6cd5\u6269\u6563\uff0cPN\u65e0\u6cd5\u5bfc\u901a\u3002\uff08\u53cd\u5411\u7535\u538b\u8db3\u591f\u5927\u65f6\uff0c\u53ef\u80fd\u9020\u6210\u51fb\u7a7f\u800c\u6025\u5267\u6f0f\u7535\uff09\u3002\u603b\u4e4b\uff0c\u7ed3\u8bba\u5c31\u662f\uff1aPN\u6750\u6599\u7ed3\u5408\uff0c\u5f62\u6210\u4e00\u4e2a\u5355\u5411\u5bfc\u901a\u7684\u7279\u6027\uff0c\u5373\u7535\u5b50\u53ea\u80fd\u4eceN\u578b\u6750\u6599\u6d41\u5411P\u578b\u6750\u6599\u3002ok\uff0c\u540e\u6765\u6709\u4e00\u4e2a\u806a\u660e\u4eba\uff0c\u5229\u7528PN\u7ed3\u7684\u7279\u6027\uff0c\u8bbe\u8ba1\u4e86\u4e0b\u56fe\u7684MOS\u7ba1\u7ed3\u6784\u3002\u5176\u4e2d\uff0c\u9ed1\u8272\u4e3a\u91d1\u5c5e\u7ea7\uff0c\u7528\u4e8e\u5bfc\u7535\uff0c\u84dd\u8272\u4e3aN\u578b\u6750\u6599\uff0c\u7eff\u8272\u4e3aP\u578b\u6750\u6599\u3002\n\u5f53\u7ed9\u6e90\u6781\u548c\u6f0f\u6781\u63a5\u901a\u7535\u6e90\u65f6\uff0c\u7531\u4e8eP\u578b\u6750\u6599\u542b\u6709\u8f83\u5c11\u7535\u5b50\uff0c\u6e90\u6781\u548c\u6f0f\u6781\u4e4b\u95f4\u4e0d\u80fd\u5f62\u6210\u5bfc\u7535\u6c9f\u9053\uff0c\u7535\u8def\u65e0\u6cd5\u5bfc\u901a\u3002\n\u5f53\u7ed9\u6805\u6781\u63a5\u901a\u6b63\u6781\u65f6\uff0c\u6805\u6781\u5230P\u578b\u6750\u6599\u4e4b\u95f4\u5f62\u6210\u6b63\u7535\u538b\uff0c\u6805\u6781\u4e0b\u662f\u4e8c\u6c27\u5316\u7845\uff0c\u662f\u7edd\u7f18\u7684\u3002\u6240\u4ee5P\u578b\u6750\u6599\u4e2d\u7684\u7535\u5b50\u4f1a\u5728\u7535\u573a\u529b\u7684\u4f5c\u7528\u4e0b\uff0c\u805a\u96c6\u5230\u7edd\u7f18\u5c42\u4e0b\u9762\u3002\u5f53\u805a\u96c6\u7684\u7535\u5b50\u6570\u8db3\u591f\u591a\u65f6\uff0c\u4fbf\u5728\u6e90\u6781\u548c\u6f0f\u6781\u4e4b\u95f4\u5f62\u6210\u5bfc\u7535\u6c9f\u9053\uff0c\u4f7f\u5f97\u6e90\u6781\u548c\u6f0f\u6781\u53ef\u4ee5\u5bfc\u901a\u3002\u6240\u4ee5\uff0cMOS\u7ba1\u7684\u7279\u6027\u603b\u7ed3\u4e0b\u6765\u5c31\u662f\uff1a\u7ed9\u6805\u6781\u9ad8\u7535\u5e73\uff0c\u6e90\u6781\u548c\u6f0f\u6781\u5c31\u80fd\u5bfc\u901a\uff1b\u7ed9\u4f4e\u7535\u5e73\uff0c\u6e90\u6781\u548c\u6f0f\u6781\u5c31\u65e0\u6cd5\u5bfc\u901a\u3002\u5728MOS\u7ba1\u4e2d\u7684\u7edd\u7f18\u5c42\uff0c\u589e\u52a0\u4e00\u4e2a\u53ef\u4ee5\u5bfc\u7535\u7684\u6d6e\u6805\u5c42\uff0c\u5c31\u5f62\u6210\u4e86\u6d6e\u6805MOS\u7ba1\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002\n\u7ed9\u6805\u6781\u63a5\u9ad8\u7535\u538b\uff0cP\u578b\u6750\u6599\u7684\u886c\u5e95\u63a5\u4f4e\u7535\u538b\uff0c\u7535\u5b50\u4f1a\u805a\u96c6\u5728\u7edd\u7f18\u5c42\u9644\u8fd1\uff0c\u4f46\u7531\u4e8e\u7edd\u7f18\u5c42\u4e2d\u95f4\u589e\u52a0\u4e86\u6d6e\u6805\u5c42\uff0c\u7edd\u7f18\u5c42\u975e\u5e38\u8584\uff0c\u7535\u5b50\u5728\u9ad8\u538b\u7684\u4f5c\u7528\u4e0b\u901a\u8fc7\u96a7\u7a7f\u6548\u5e94\uff0c\u7a7f\u8fc7\u7edd\u7f18\u5c42\uff0c\u8fdb\u5165\u6d6e\u6805\u5c42\u3002\u8fd9\u5c31\u662fNand\u5199\u5165\u7684\u8fc7\u7a0b\u3002\u5f53\u6805\u6781\u7535\u538b\u6d88\u5931\u540e\uff0c\u7531\u4e8e\u7edd\u7f18\u5c42\u7684\u5b58\u5728\uff0c\u7535\u5b50\u5c31\u88ab\u9501\u5728\u6d6e\u6805\u5c42\u4e2d\uff08\u4e5f\u5c31\u5f97\u5230\u4e86\u975e\u6613\u5931\u6027\u7684\u5b58\u50a8\u7279\u6027\uff09\u3002\u53cd\u4e4b\uff0c\u79e4\u5e95\u589e\u52a0\u9ad8\u538b\uff0c\u6805\u6781\u589e\u52a0\u4f4e\u538b\uff0c\u7535\u5b50\u53c8\u4f1a\u96a7\u7a7f\u56deP\u578b\u6750\u6599\uff0c\u6d6e\u6805\u5c42\u5185\u7535\u5b50\u6d41\u5931\uff0c\u8fd9\u5c31\u662f\u64e6\u9664\u7684\u8fc7\u7a0b\u3002\u6240\u4ee5\uff0c\u6d6e\u6805MOS\u7ba1\uff0c\u5c31\u662f\u901a\u8fc7\uff1a\u901a\u8fc7\u6d6e\u6805\u5c42\u4e2d\u662f\u5426\u6709\u7535\u5b50\uff0c\u6765\u8868\u793a0\u6216\u80051\uff0c\u4ece\u800c\u50a8\u5b58\u4fe1\u606f\u3002\n\u6d6e\u6805\u5c42\u4e2d\u662f\u5426\u6709\u7535\u5b50\uff0c\u8868\u793a0\u62161\uff0c\u8fd9\u5c31\u662fNand\u4e2d\u7684SLC\u3002\u540c\u65f6\uff0c\u5f53\u7535\u5b50\u8db3\u591f\u591a\u65f6\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u6309\u7167\u6709\u7535\u5b50\u7684\u591a\u5c11\uff0c\u6765\u8868\u793a\u66f4\u591abit\u7684\u4fe1\u606f\u3002MLC\u5c31\u662f2bit\uff0cTLC\u5c31\u662f3bit\uff0cQLC\u5c31\u662f4bit\u3002\u6bcfn\u4e2abit\u9700\u8981 $2^{n}$ \u4e2a\u7535\u5b50\u6570\u91cf\u6765\u8868\u793a\u3002\nNand\u7ed3\u6784\n2D Nand\n\u628a\u6d6e\u6805MOS\u7ba1\u6309\u7167\u4e0b\u56fe\u65b9\u5f0f\u7ec4\u5408\u8d77\u6765\uff0c\u5f62\u6210\u7684Nand\u5c31\u662f2D Nand\u3002\n\u5176\u4e2d\uff0c\u6a2a\u7740\u5171\u7528\u6805\u6781\u7684\uff0c\u53eb\u505aWord Line\uff08\u5b57\u7ebf\uff09\uff1b\u7ad6\u7740\u6e90\u6781\u548c\u6f0f\u6781\u4e32\u8054\u8d77\u6765\u7684\u662fBit Line\uff08\u4f4d\u7ebf\uff09\u3002\n\u5176\u4e2d\uff0c\u4e3a\u4e86\u6210\u672c\u8003\u8651\uff0c\u67d0\u4e00\u5757\u6240\u6709\u5b57\u7ebf\u548c\u4f4d\u7ebf\u7684\u6d6e\u6805MOS\u7ba1\u662f\u5171\u7528\u886c\u5e95\u7684\uff0c\u6240\u4ee5\u64e6\u9664\u662f\u4ee5block\u4e3a\u5355\u4f4d\u8fdb\u884c\u7684\u64e6\u9664\u3002\n\u5728\u4e00\u4e2a\u4f4d\u7ebf\u4e2d\uff0c\u5f53\u9700\u8981\u7ed9\u5176\u4e2d\u7684\u67d0\u4e00\u4e2a\u6d6e\u6805MOS\u7ba1\u505a\u64cd\u4f5c\u65f6\uff0c\u7531\u4e8e\u6240\u6709\u6d6e\u6805MOS\u7ba1\u7684\u6e90\u6781\u548c\u6f0f\u6781\u662f\u4e32\u8054\u8d77\u6765\u7684\uff0c\u6240\u4ee5\u9700\u8981\u5c06\u4f4d\u7ebf\u4e2d\u7684\u5176\u4ed6\u6d6e\u6805MOS\u7ba1\u7f6e\u4e8e\u5bfc\u901a\u72b6\u6001\uff0c\u6240\u4ee5\u5176\u4ed6\u6d6e\u6805MOS\u7ba1\u6240\u5904\u7684\u5b57\u7ebf\u9700\u8981\u52a0\u4e00\u4e2a $V_{pass}$ \u5bfc\u901a\u7535\u538b\u3002\n3D Nand\n2D Nand\u4e3a\u4e86\u589e\u52a0\u5355\u4f4d\u4f53\u79ef\u5185\u7684\u5bb9\u91cf\uff0c\u53ea\u80fd\u4e0d\u65ad\u7f29\u5c0f\u6d6e\u6805MOS\u7ba1\u7684\u4f53\u79ef\uff0c\u4f46\u968f\u7740\u4f53\u79ef\u7684\u7f29\u5c0f\uff0c\u5e26\u6765\u4e86\u5f88\u591a\u95ee\u9898\u3002\u6bd4\u5982\u6c27\u5316\u5c42\u53d8\u8584\u540e\uff0c\u96a7\u7a7f\u6b21\u6570\u7a0d\u5fae\u591a\u4e00\u4e9b\uff0c\u6c27\u5316\u5c42\u5c31\u5bb9\u6613\u5931\u6548\uff0c\u5bfc\u81f4\u65e0\u6cd5\u9501\u4f4f\u7535\u5b50\uff0c\u5b58\u50a8\u5355\u5143\u5c31\u5931\u6548\u4e86\u3002\u6240\u4ee5\uff0c\u540e\u9762\u4eba\u4eec\u5c31\u53d1\u660e\u4e863D Nand \u7ed3\u6784\uff0c\u901a\u8fc7\u5806\u53e0\u7684\u65b9\u5f0f\uff0c\u80fd\u66f4\u52a0\u6709\u6548\u5730\u589e\u52a0\u5355\u4f4d\u4f53\u79ef\u5185\u7684\u5b58\u50a8\u5bb9\u91cf\u3002\u5982\u4e0b\u56fe\uff0c\u5c31\u662f3D Nand\u7ed3\u6784\u793a\u610f\u56fe\u3002\n", "categories": [{"name": "\u5b66\u4e60", "slug": "\u5b66\u4e60", "permalink": "https://blog.imadamtang.cn/category/%E5%AD%A6%E4%B9%A0/"}], "tags": []}, {"title": "Hive", "date": "2024-07-21T13:00:00+08.00", "path": "https://blog.imadamtang.cn/archives/Hive/", "text": "\u4e00\u3001\u57fa\u7840\n1.1 \u6982\u5ff5\nApache Hive \u662f\u4e00\u4e2a\u6b3e\u5efa\u7acb\u5728 Hadoop \u4e4b\u4e0a\u7684\u5f00\u6e90\u6570\u636e\u4ed3\u5e93\u7cfb\u7edf\uff0c\u53ef\u4ee5\u5c06\u5b58\u50a8\u5728 Hadoop \u4e2d\u7684\u7684\u7ed3\u6784\u5316\u548c\u534a\u7ed3\u6784\u5316\u6570\u636e\u6620\u5c04\u4e3a\u4e00\u5f20\u6570\u636e\u5e93\u8868\uff0c\u57fa\u4e8e\u8868\u63d0\u4f9b\u4e86\u4e00\u79cd\u7c7b SQL \u67e5\u8be2\u8bed\u8a00\uff08HQL\uff09\u3002\u5173\u4e8eHive\u5efa\u7acb\u5728Hadoop\u4e4b\u4e0a\u7684\u7406\u89e3\uff1a\nHive\u6570\u636e\u5b58\u50a8\u5728Hadoop\u7684HDFS\u4e0a\n\u8ba1\u7b97\u5f15\u64ce\u4e3aMapReduce\uff08\u53ef\u4ee5\u7531Spark\u66ff\u4ee3\uff09\n\u4efb\u52a1\u8c03\u5ea6\u4e3aYARN\n\nHive\u7684\u4f5c\u7528\u4e3b\u8981\u662f\u89e3\u91caSQL\u8bed\u53e5\uff0c\u5e76\u8f6c\u6362\u4e3aMapReduce\u7a0b\u5e8f\u6216Spark\u7a0b\u5e8f\uff0c\u5e76\u63d0\u4ea4\u5230Hadoop\u96c6\u7fa4\u6267\u884c\u30021.2 \u67b6\u6784\n\n\u7528\u6237\u63a5\u53e3\uff1a\u5305\u62ec CLI\u3001JDBC/ODBC\u3001WEBUI\u3002\u5176\u4e2d\uff0cCLI(command line interface)\u4e3a shell \u547d\u4ee4\u884c\uff1bHive \u4e2d\u7684 Thrift \u670d\u52a1\u5668\u5141\u8bb8\u5916\u90e8\u5ba2\u6237\u7aef\u901a\u8fc7\u7f51\u7edc\u4e0e Hive \u8fdb\u884c\u4ea4\u4e92\uff0c\u7c7b\u4f3c\u4e8e JDBC \u6216 ODBC \u534f\u8bae\u3002WebGUI \u662f\u901a\u8fc7\u6d4f\u89c8\u5668\u8bbf\u95ee Hive\u3002\n\u5143\u6570\u636e\uff08Metastore\uff09\uff1a\u7528\u4ee5\u5b58\u50a8 Hive \u4e2d\u7684\u5e93\u3001\u8868\u3001\u5217\u3001\u6ce8\u91ca\u3001\u5206\u533a\u3001\u8868\u5c5e\u6027\u7b49\u4fe1\u606f\u3002\u9ed8\u8ba4\u662f\u5b58\u50a8\u5728 Hive \u81ea\u5e26\u7684 Derby \u6570\u636e\u5e93\u4e2d\u7684\uff0c\u4f01\u4e1a\u4e2d\u4e00\u822c\u4f1a\u901a\u8fc7\u914d\u7f6e\u5c06\u5176\u5b58\u50a8\u5230 MySQL \u4e2d\u3002\nDriver \u9a71\u52a8\u7a0b\u5e8f\uff1aDriver \u9a71\u52a8\u7a0b\u5e8f\u5305\u62ec\u89e3\u6790\u5668\uff08SQL Parser\uff09\u3001\u7f16\u8bd1\u5668\uff08Physical Plan\uff09\u3001\u4f18\u5316\u5668\uff08Query Optimize\uff09\u3001\u6267\u884c\u5668\uff08Execution\uff09\u3002\u89e3\u6790\u5668\u5c06 SQL \u5b57\u7b26\u4e32\u8f6c\u6362\u6210\u62bd\u8c61\u8bed\u6cd5\u6811 AST\uff0c\u5e76\u5bf9\u62bd\u8c61\u8bed\u6cd5\u6811\u8fdb\u884c\u5206\u6790\uff0c\u6bd4\u5982\u5224\u65ad\u5b57\u6bb5\u662f\u5426\u5b58\u5728\u3001\u7c7b\u578b\u662f\u5426\u5408\u7406\u7b49\uff0c\u7f16\u8bd1\u5668\u8d1f\u8d23\u5c06 AST \u7f16\u8bd1\u6210\u903b\u8f91\u6267\u884c\u8ba1\u5212\uff0c\u5e76\u7531\u4f18\u5316\u5668\u5bf9\u903b\u8f91\u6267\u884c\u8ba1\u5212\u8fdb\u884c\u4f18\u5316\uff0c\u6700\u540e\u7531\u6267\u884c\u5668\u5c06\u903b\u8f91\u6267\u884c\u8ba1\u5212\u8f6c\u6362\u4e3a\u5c4b\u91cc\u8fd0\u884c\u8ba1\u5212\u3002\n\u6267\u884c\u5f15\u64ce\uff1aHive \u672c\u8eab\u662f\u4e0d\u4f1a\u5904\u7406\u6570\u636e\u7684\uff0c\u800c\u662f\u901a\u8fc7\u6267\u884c\u5f15\u64ce\u6765\u5904\u7406\u3002\u9ed8\u8ba4\u7684\u6267\u884c\u5f15\u64ce\u5c31\u662f MapReduce\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u5c06\u6267\u884c\u5f15\u64ce\u66ff\u6362\u4e3a Spark\u3001Tez \u6216\u8005 Presto \u7b49\u3002\n\n\u4e8c\u3001Demo\n2.1 \u4f7f\u7528Docker\u5feb\u901f\u90e8\u7f72\n2.1.1 \u5b89\u88c5Docker\n\u6b64\u5904\u5ffd\u75652.1.2 \u5b89\u88c5Git\u5e76\u914d\u7f6egithub\n\u6b64\u5904\u5ffd\u75652.1.3 \u90e8\u7f72Hive\n\u4f7f\u7528\u522b\u4eba\u505a\u597d\u7684docker-hive\uff0c\u5305\u542bhadoop\u6846\u67b6\u3001postgresql\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u76f4\u63a5\u5b89\u88c5git clone git@github.com:big-data-europe/docker-hive.git\n\n# \u6ce8\uff1a\u672c\u6587\u6240\u6709docker-compose\u90fd\u662f\u5728docker-hive\u76ee\u5f55\u4e0b\u6267\u884c\u7684\ncd docker-hive\n\n# \u8fd9\u6b65\u5728\u540e\u53f0\u8d77\u4e00\u4e2ahive\uff0c\u5143\u6570\u636e\u5e93\u7528\u7684\u662fpostgresql\n# \u4f1a\u8d39\u4e00\u70b9\u65f6\u95f4\uff0c\u9700\u8981\u8010\u5fc3\u7b49\u5f85\ndocker-compose up -d\n\n\u8fd0\u884c\u5b8c\u6210\u540e\uff0c\u6267\u884c docker-compose ps\u547d\u4ee4\u67e5\u770b\u6b63\u5728\u8fd0\u884c\u7684\u955c\u50cf\u770b\u5230\u6709namenode\u3001datanode\u3001hive\u7b49\uff0c\u8868\u793a\u90e8\u7f72\u6210\u529f2.2 \u4f7f\u7528Hive\n\u8fdb\u5165docker\u5bb9\u5668\uff0c\u8be5\u547d\u4ee4\u4f1a\u5728hive-server\u5bb9\u5668\u4e2d\u6267\u884cbash\u547d\u4ee4\uff0c\u5f00\u59cb\u4ea4\u4e92docker-compose exec hive-server bash\n\n\n\u4f7f\u7528\u547d\u4ee4 exit \u9000\u51fa\u5bb9\u5668\n\u4f7f\u7528beeline\u5ba2\u6237\u7aef\u8fde\u63a5beeline -u jdbc:hive2://localhost:10000\n\n\nbeeline\u662fhive\u7684\u547d\u4ee4\u884c\u5ba2\u6237\u7aef\u5de5\u5177\uff0c\u57fa\u4e8eSQLLine CLI\u7684JDBC\u5ba2\u6237\u7aef\n\u6267\u884cSQL\u8bed\u53e5\uff08\u955c\u50cf\u5e26\u4e86example\u6587\u4ef6\uff09\uff0c\u521b\u5efapokes\u8868\uff0c\u5e76\u5c06txt\u6587\u4ef6\u6570\u636e\u5199\u5165\u8868\u4e2dCREATE TABLE pokes (foo INT, bar STRING);\nLOAD DATA LOCAL INPATH &#39;/opt/hive/examples/files/kv1.txt&#39; OVERWRITE INTO TABLE pokes;\n\n\u6267\u884cSQL\u8bed\u53e5\u67e5\u8be2\u8868\u4fe1\u606fSELECT * FROM pokes;\n\n\u53ef\u4ee5\u770b\u5230\uff0chive\u5df2\u7ecf\u5b89\u88c5\u5b8c\u6210\u30022.3 Metastore\n\u901a\u8fc7\u4e0a\u8ff0\u64cd\u4f5c\uff0c\u6211\u4eec\u5c06 kv1.txt \u6587\u4ef6\u901a\u8fc7hive\u63d0\u4f9b\u7684SQL\u63a5\u53e3\uff0c\u5b58\u653e\u5230\u4e86Hadoop\u96c6\u7fa4\u7684HDFS\u4e2d\uff0c\u5e76\u4ee5SQL\u8868\u7684\u5f62\u5f0f\u5bf9\u5916\u5448\u73b0\u3002kv1.txt \u6570\u636e\u548c pokes \u8868\u7684\u6620\u5c04\u5173\u7cfb\u6570\u636e\uff0c\u79f0\u4e4b\u4e3aHive\u7684\u5143\u6570\u636eMetadata\u3002Metadata\u5373\u5143\u6570\u636e\uff0c\u5305\u542bHive\u521b\u5efa\u7684database\u3001table\u3001\u8868\u5b57\u6bb5\u7b49\u5143\u4fe1\u606f\uff0c\u8be5\u5143\u6570\u636e\u5305\u5b58\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\u3002\u5982Hive\u5185\u7f6e\u7684Derby\u3002\u4f46\u7531\u4e8e\u5185\u7f6e\u6570\u636e\u5e93\u7684\u6027\u80fd\u8f83\u5dee\uff0c\u6211\u4eec\u4e00\u822c\u90fd\u4fdd\u5b58\u5728\u7b2c\u4e09\u65b9\u7684\u6570\u636e\u5e93\u4e2d\uff0c\u5982MySQL\u3001PostgreSQL\u7b49\u3002Metastore\u670d\u52a1\u5373\u5143\u6570\u636e\u670d\u52a1\uff0c\u662fHive\u7ba1\u7406\u5e93\u8868\u5143\u6570\u636e\u7684\u4e00\u4e2a\u670d\u52a1\u3002\u7531\u4e8e\u6211\u4eec\u5143\u6570\u636e\u662f\u5b58\u5728MySQL\u7b49\u6570\u636e\u5e93\u4e2d\u7684\uff0c\u7406\u8bba\u4e0a\u8981\u60f3\u83b7\u5f97\u5143\u6570\u636e\uff0c\u9700\u8981\u83b7\u5f97MySQL\u7b49\u6570\u636e\u5e93\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u4f46\u8fd9\u6837\u505a\u592a\u9ebb\u70e6\u4e14\u4e0d\u591f\u7edf\u4e00\uff0c\u6240\u4ee5Hive\u901a\u8fc7\u4e00\u4e2a\u670d\u52a1\u5c06\u5143\u6570\u636e\u66b4\u9732\u51fa\u53bb\uff0c\u8fd9\u6837\u4e0a\u5c42\u7684\u670d\u52a1\u5c31\u53ef\u4ee5\u57fa\u4e8e\u7ed3\u6784\u5316\u7684\u5e93\u8868\u4fe1\u606f\u6765\u6784\u5efa\u8ba1\u7b97\u6846\u67b6\uff0c\u8fd9\u4e2a\u670d\u52a1\u5c31\u662fMetastore\u670d\u52a1\u3002\u53c2\u8003\nDocker-Hive Github\n\n\u4e09\u3001Hive\u5ba2\u6237\u7aef\nHive\u662f\u4e00\u4e2aCS\u67b6\u6784\uff0c\u6709Hive-Server\u7684\u670d\u52a1\u7aef\uff0c\u80af\u5b9a\u8fd8\u6709\u4e00\u4e2aHive-Client\u7684\u5ba2\u6237\u7aef\u3002Hive\u4ece\u5386\u53f2\u4e0a\uff0c\u4e00\u5171\u6709\u4e24\u4e2a\u5ba2\u6237\u7aef\u5de5\u5177\uff0c\u5206\u522b\u662fhive\u548cbeeline\u3002\u524d\u8005\u5df2\u7ecf\u8fc7\u65f6\uff0c\u5b98\u65b9\u4e0d\u63a8\u8350\u4f7f\u7528\u3002\u540e\u8005\u662f\u4e00\u4e2aJDBC\u5ba2\u6237\u7aef\uff0c\u662f\u5b98\u65b9\u63a8\u5956\u7684Hive\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u6027\u80fd\u548c\u5b89\u5168\u6027\u90fd\u6bd4hive\u5de5\u5177\u66f4\u597d\u3002\u4f7f\u7528beeline\u5ba2\u6237\u7aef\u8fde\u63a5beeline -u jdbc:hive2://localhost:10000\n\n", "categories": [{"name": "\u5b66\u4e60", "slug": "\u5b66\u4e60", "permalink": "https://blog.imadamtang.cn/category/%E5%AD%A6%E4%B9%A0/"}], "tags": []}, {"title": "Spark", "date": "2024-07-21T12:00:00+08.00", "path": "https://blog.imadamtang.cn/archives/Spark/", "text": "\u4e00\u3001\u57fa\u7840\n1.1 \u6982\u5ff5\nSpark \u662f\u4e00\u79cd\u57fa\u4e8e\u5185\u5b58\u7684\u5feb\u901f\u3001\u901a\u7528\u3001\u53ef\u6269\u5c55\u7684\u5927\u6570\u636e\u5206\u6790\u8ba1\u7b97\u5f15\u64ce\u3002\u53ef\u4ee5\u7406\u89e3\u4e3aHadoop\u751f\u6001\u4e2d\u7684\u8ba1\u7b97\u7ec4\u4ef6\uff0c\u548cMapReduce\u540c\u5c5e\u4e00\u4e2a\u5c42\u9762\u30021.2 \u7279\u70b9\n\n\u901f\u5ea6\u5feb\n\n\nSpark\u76f8\u5bf9MapReduce\u66f4\u5feb\u7684\u539f\u56e0\uff1a\n\u51cf\u5c11\u78c1\u76d8IO\u3002Spark\u5c06\u8ba1\u7b97\u7ed3\u679c\u4fdd\u5b58\u5230\u5185\u5b58\u4e2d\uff0c\u800c\u975e\u50cfMapReduce\u4e00\u6837\u5199\u5230\u786c\u76d8\u91cc\u3002\n\u589e\u52a0\u5e76\u884c\u5ea6\u3002Spark\u4e2d\u7684\u4efb\u52a1\u662f\u4ee5\u7ebf\u7a0b\u7684\u65b9\u5f0f\u6267\u884c\uff0c\u4e14\u7531\u4e8eSpark\u5c06\u4e0d\u540c\u7684\u73af\u8282\u62bd\u8c61\u6210Stage\uff0c\u6545\u5141\u8bb8\u591a\u4e2aStage\u5e76\u884c\u6267\u884c\u3002\n\u907f\u514d\u91cd\u590d\u8ba1\u7b97\u3002Spark\u57fa\u4e8eDAG\uff08\u6709\u5411\u65e0\u73af\u56fe\uff09\u3002\n\n\n\n\u6613\u7528\u6027\u5f3a\n\n\nSpark \u652f\u6301 Java\u3001Python \u548c Scala \u7684 API\uff0c\u8fd8\u652f\u6301\u8d85\u8fc7 80 \u79cd\u9ad8\u7ea7\u7b97\u6cd5\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u5feb\u901f\u6784\u5efa\u4e0d\u540c\u7684\u5e94\u7528\u3002\n\n\u901a\u7528\u6027\u5f3a\n\n\n\u5728 Spark \u7684\u57fa\u7840\u4e0a\uff0cSpark \u8fd8\u63d0\u4f9b\u4e86\u5305\u62ec Spark SQL\u3001Spark Streaming\u3001MLib \u53ca GraphX \u5728\u5185\u7684\u591a\u4e2a\u5de5\u5177\u5e93\uff0c\u53ef\u4ee5\u5728\u4e00\u4e2a\u5e94\u7528\u4e2d\u65e0\u7f1d\u5730\u4f7f\u7528\u8fd9\u4e9b\u5de5\u5177\u5e93\u3002\u5176\u4e2d\uff0cSpark SQL \u63d0\u4f9b\u4e86\u7ed3\u6784\u5316\u7684\u6570\u636e\u5904\u7406\u65b9\u5f0f\uff0cSpark Streaming \u4e3b\u8981\u9488\u5bf9\u6d41\u5f0f\u5904\u7406\u4efb\u52a1\uff0cMLlib \u63d0\u4f9b\u4e86\u5f88\u591a\u6709\u7528\u7684\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u5e93\uff0cGraphX \u63d0\u4f9b\u56fe\u5f62\u548c\u56fe\u5f62\u5e76\u884c\u5316\u8ba1\u7b97\u3002\n\n\u517c\u5bb9\u6027\u5f3a\n\n\nSpark \u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u5730\u4e0e\u5176\u4ed6\u7684\u5f00\u6e90\u4ea7\u54c1\u8fdb\u884c\u878d\u5408\u3002\u6bd4\u5982\uff0cSpark \u53ef\u4ee5\u4f7f\u7528 Hadoop \u7684 YARN \u548c Apache Mesos \u4f5c\u4e3a\u5b83\u7684\u8d44\u6e90\u7ba1\u7406\u548c\u8c03\u5ea6\u5668\uff0c\u5e76\u4e14\u53ef\u4ee5\u5904\u7406\u6240\u6709 Hadoop \u652f\u6301\u7684\u6570\u636e\uff0c\u5305\u62ec HDFS\u3001HBase \u7b49\u3002\n1.3 \u7ec4\u4ef6\nSpark \u6846\u67b6\u6838\u5fc3\u6a21\u5757\u4e3aSpark Core\uff0c\u5728\u5176\u4e4b\u4e0a\u6709Spark SQL\u3001 Spark Streaming\u3001 Spark GraphX\u3001Spark MLlib\uff0c\u65b0\u7248\u8fd8\u6269\u5c55\u51fa\u4e86\u65b0\u7684\u6d41\u8ba1\u7b97\u7ec4\u4ef6 Structured Streaming\u3002\nSpark Core\n\n\n\u5b9e\u73b0\u4e86 Spark \u7684\u57fa\u672c\u529f\u80fd\uff0c\u5305\u542b\u4efb\u52a1\u8c03\u5ea6\u3001\u5185\u5b58\u7ba1\u7406\u3001\u9519\u8bef\u6062\u590d\u3001\u4e0e\u5b58\u50a8\u7cfb\u7edf\u4ea4\u4e92\u7b49\u6a21\u5757\u3002Spark Core \u4e2d\u8fd8\u5305\u542b\u4e86\u5bf9\u5f39\u6027\u5206\u5e03\u5f0f\u6570\u636e\u96c6(Resilient Distributed DataSet\uff0c\u7b80\u79f0 RDD)\u7684 API \u5b9a\u4e49\u3002\n\nSpark SQL\n\n\n\u662f Spark \u7528\u6765\u64cd\u4f5c\u7ed3\u6784\u5316\u6570\u636e\u7684\u7a0b\u5e8f\u5305\u3002\u901a\u8fc7 Spark SQL\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 SQL \u6216\u8005 Apache Hive \u7248\u672c\u7684 SQL \u65b9\u8a00(HQL)\u6765\u67e5\u8be2\u6570\u636e\u3002Spark SQL \u652f\u6301\u591a\u79cd\u6570\u636e\u6e90\uff0c\u6bd4\u5982 Hive \u8868\u3001Parquet \u4ee5\u53ca JSON \u7b49\u3002\n\nSpark Streaming\n\n\n\u662f Spark \u63d0\u4f9b\u7684\u5bf9\u5b9e\u65f6\u6570\u636e\u8fdb\u884c\u6d41\u5f0f\u8ba1\u7b97\u7684\u7ec4\u4ef6\u3002\u63d0\u4f9b\u4e86\u7528\u6765\u64cd\u4f5c\u6570\u636e\u6d41\u7684 API\uff0c\u5e76\u4e14\u4e0e Spark Core \u4e2d\u7684 RDD API \u9ad8\u5ea6\u5bf9\u5e94\u3002\n\nSpark MLlib\n\n\n\u63d0\u4f9b\u5e38\u89c1\u7684\u673a\u5668\u5b66\u4e60(ML)\u529f\u80fd\u7684\u7a0b\u5e8f\u5e93\u3002\u5305\u62ec\u5206\u7c7b\u3001\u56de\u5f52\u3001\u805a\u7c7b\u3001\u534f\u540c\u8fc7\u6ee4\u7b49\uff0c\u8fd8\u63d0\u4f9b\u4e86\u6a21\u578b\u8bc4\u4f30\u3001\u6570\u636e\u5bfc\u5165\u7b49\u989d\u5916\u7684\u652f\u6301\u529f\u80fd\u3002\n\nSpark GraphX\n\n\nSpark \u4e2d\u7528\u4e8e\u56fe\u8ba1\u7b97\u7684 API\uff0c\u6027\u80fd\u826f\u597d\uff0c\u62e5\u6709\u4e30\u5bcc\u7684\u529f\u80fd\u548c\u8fd0\u7b97\u7b26\uff0c\u80fd\u5728\u6d77\u91cf\u6570\u636e\u4e0a\u81ea\u5982\u5730\u8fd0\u884c\u590d\u6742\u7684\u56fe\u7b97\u6cd5\u3002\n\nStructured Streaming\n\n\nStructured Streaming \u662f\u7ed3\u6784\u5316\u6d41\u5904\u7406\u6a21\u5757\uff0c\u5c06\u6d41\u5f0f\u7ed3\u6784\u5316\u6570\u636e\u5c01\u88c5\u5230 DataFrame \u4e2d\u8fdb\u884c\u5206\u6790\u3002\u662f\u5efa\u7acb\u5728 SparkSQL \u5f15\u64ce\u4e4b\u4e0a\u7684\u53ef\u4f38\u7f29\u548c\u9ad8\u5bb9\u9519\u7684\u6d41\u5f0f\u5904\u7406\u5f15\u64ce\uff0c\u53ef\u4ee5\u50cf\u64cd\u4f5c\u9759\u6001\u6570\u636e\u7684\u6279\u91cf\u8ba1\u7b97\u4e00\u6837\u6765\u6267\u884c\u6d41\u5f0f\u8ba1\u7b97\u3002\u5f53\u6d41\u5f0f\u6570\u636e\u4e0d\u65ad\u7684\u5230\u8fbe\u7684\u8fc7\u7a0b\u4e2d Spark SQL \u7684\u5f15\u64ce\u4f1a\u8fde\u7eed\u4e0d\u65ad\u7684\u6267\u884c\u8ba1\u7b97\u5e76\u66f4\u65b0\u6700\u7ec8\u7ed3\u679c\u3002\u7b80\u800c\u8a00\u4e4b\uff0cStructured Streaming \u63d0\u4f9b\u4e86\u5feb\u901f\u3001\u53ef\u4f38\u7f29\u3001\u53ef\u5bb9\u9519\u3001\u7aef\u5230\u7aef\u7cbe\u786e\u7684\u6d41\u5904\u7406\u3002\n\u4e8c\u3001\u8fd0\u884c\u6a21\u5f0f\n2.1 \u8fd0\u884c\u6a21\u5f0f\nSpark \u7684\u8fd0\u884c\u6a21\u5f0f\u5206\u4e09\u7c7b\uff1aLocal \u6a21\u5f0f\u3001\u96c6\u7fa4\u6a21\u5f0f\u3001\u4e91\u670d\u52a1\u6a21\u5f0f\u3002\u5176\u4e2d\u96c6\u7fa4\u6a21\u5f0f\u53c8\u5206\u4e3aStandalone\u3001Yarn \u3001Mesos \u4e09\u79cd\uff0c\u4e91\u670d\u52a1\u6a21\u5f0f\u4e3b\u8981\u662f Kubernetes \u6a21\u5f0f\u3002\nLocal \u6a21\u5f0f\n\n\nLocal \u6a21\u5f0f\u4e5f\u5c31\u662f\u672c\u5730\u6a21\u5f0f\uff0c\u5c06 Spark \u5e94\u7528\u7a0b\u5e8f\u4e2d\u4efb\u52a1 Task \u8fd0\u884c\u5728\u4e00\u4e2a\u672c\u5730 JVM Process \u8fdb\u7a0b\u4e2d\uff0c\u901a\u5e38\u5f00\u53d1\u6d4b\u8bd5\u4f7f\u7528\u3002\n\nStandalone \u6a21\u5f0f\n\n\n\u642d\u5efa\u91c7\u7528 Master + Worker \u6a21\u5f0f\u7684\u96c6\u7fa4\uff0c\u4f7f\u7528 Spark \u5185\u7f6e\u7684\u4efb\u52a1\u8c03\u5ea6\u6a21\u5757\u8fdb\u884c\u4efb\u52a1\u8c03\u5ea6\u548c\u8d44\u6e90\u7ba1\u7406\u3002\n\nYarn \u6a21\u5f0f\n\n\n\u642d\u5efa\u91c7\u7528 Master + Worker \u6a21\u5f0f\u7684\u96c6\u7fa4\uff0c\u501f\u52a9 Yarn \u8fdb\u884c\u4efb\u52a1\u8c03\u5ea6\u548c\u8d44\u6e90\u7ba1\u7406\uff0cSpark \u53ea\u8d1f\u8d23\u8ba1\u7b97\uff0c\u751f\u4ea7\u73af\u5883\u7528\u7684\u6700\u591a\u3002\n\nMesos\u6a21\u5f0f\n\n\n\u8fd0\u884c\u5728 Mesos \u8d44\u6e90\u7ba1\u7406\u5668\u6846\u67b6\u4e4b\u4e0a\uff0c\u7531 Mesos \u8d1f\u8d23\u8d44\u6e90\u7ba1\u7406\uff0cSpark \u8d1f\u8d23\u4efb\u52a1\u8c03\u5ea6\u548c\u8ba1\u7b97\u3002\u56fd\u5185\u5f88\u5c11\u4f7f\u7528\u3002\n\nKubernetes\u6a21\u5f0f\n\n\nSpark 2.3 \u5f00\u59cb\u652f\u6301\u5c06 Spark \u5f00\u53d1\u5e94\u7528\u8fd0\u884c\u5230 Kubernetes \u4e0a\u3002\n2.2 \u90e8\u7f72\u6a21\u5f0f\nSpark Application \u7684\u90e8\u7f72\u6a21\u5f0f\u5206\u4e3a Client \u548c Cluster \u4e24\u79cd\u3002\u4e24\u79cd\u6a21\u5f0f\u7684\u4e3b\u8981\u533a\u522b\u662f Driver \u7a0b\u5e8f\u8fd0\u884c\u5728\u54ea\u4e2a\u4e3b\u673a\u4e0a\uff0c\u9ed8\u8ba4\u662f Client \u6a21\u5f0f\uff0c\u4f46\u662f\u5728\u5de5\u4f5c\u4e2d\u90fd\u91c7\u7528 Cluster \u6a21\u5f0f\uff0c\u901a\u8fc7--deploy-mode cluster\u53c2\u6570\u6307\u5b9a\u3002\u4e09\u3001\u76f8\u5173\u672f\u8bed\n3.1 \u96c6\u7fa4\n\nCluster Manager\uff1aSpark \u7684\u96c6\u7fa4\u7ba1\u7406\u8005\uff0c\u4e3b\u8981\u8d1f\u8d23\u5bf9\u6574\u4e2a\u96c6\u7fa4\u8d44\u6e90\u7684\u7ba1\u7406\u4e0e\u5206\u914d\u3002Standalone \u6a21\u5f0f\u4e0b\u4e3a Master\uff0cYarn \u6a21\u5f0f\u4e0b\u4e3a ResourceManager\uff1b\nWorker\uff1aSpark \u7684\u5de5\u4f5c\u8282\u70b9\u3002\u5728 Yarn \u6a21\u5f0f\u4e0b\u7531 NodeManager \u66ff\u4ee3\u3002\u4e3b\u8981\u8d1f\u8d23\uff1a\n\u5c06\u81ea\u5df1\u7684\u5185\u5b58\u3001CPU \u7b49\u8d44\u6e90\u4fe1\u606f\u5411 Cluster Manager \u6ce8\u518c\n\u521b\u5efa Executor\n\u5c06\u8d44\u6e90\u548c\u4efb\u52a1\u5206\u914d\u7ed9 Executor\n\u540c\u6b65\u8d44\u6e90\u4fe1\u606f\u3001Executor \u72b6\u6001\u4fe1\u606f\n\n\n\n3.2 \u4efb\u52a1\n\nDriver\uff1aSpark Application \u9a71\u52a8\u7a0b\u5e8f\u3002\u5b83\u8d1f\u8d23\u521b\u5efa SparkContext\u3001\u521b\u5efa RDD\uff0c\u4ee5\u53ca\u8fdb\u884c RDD \u7684\u8f6c\u5316\u64cd\u4f5c\u548c\u884c\u52a8\u64cd\u4f5c\u4ee3\u7801\u7684\u6267\u884c\u3002\u5982\u679c\u4f60\u662f\u7528 Spark Shell\uff0c\u90a3\u4e48\u5f53\u4f60\u542f\u52a8 Spark Shell \u7684\u65f6\u5019\uff0c\u7cfb\u7edf\u540e\u53f0\u81ea\u542f\u4e86\u4e00\u4e2a Spark \u9a71\u52a8\u5668\u7a0b\u5e8f\uff0c\u5c31\u662f\u5728 Spark Shell \u4e2d\u9884\u52a0\u8f7d\u7684\u4e00\u4e2a\u53eb\u4f5c sc \u7684 SparkContext \u5bf9\u8c61\u3002\u5982\u679c\u9a71\u52a8\u5668\u7a0b\u5e8f\u7ec8\u6b62\uff0c\u90a3\u4e48 Spark \u5e94\u7528\u4e5f\u5c31\u7ed3\u675f\u4e86\u3002\u4e3b\u8981\u8d1f\u8d23\uff1a\n\u628a\u7528\u6237\u7a0b\u5e8f\u8f6c\u4e3a Job\uff1b\n\u8ddf\u8e2a Executor \u7684\u8fd0\u884c\u72b6\u51b5\n\u4e3a\u6267\u884c\u5668\u8282\u70b9\u8c03\u5ea6\u4efb\u52a1\nUI \u5c55\u793a\u5e94\u7528\u8fd0\u884c\u72b6\u51b5\n\n\nExecutor\uff1a\u662f\u8fd0\u884c\u5728\u5de5\u4f5c\u8282\u70b9 Worker \u4e0a\u7684\u8fdb\u7a0b\uff0c\u8d1f\u8d23\u5728 Spark \u4f5c\u4e1a\u4e2d\u8fd0\u884c\u4efb\u52a1\uff0c\u4efb\u52a1\u95f4\u76f8\u4e92\u72ec\u7acb\u3002Spark \u5e94\u7528\u542f\u52a8\u65f6\uff0cExecutor \u8282\u70b9\u88ab\u540c\u65f6\u542f\u52a8\uff0c\u5e76\u4e14\u59cb\u7ec8\u4f34\u968f\u7740\u6574\u4e2a Spark \u5e94\u7528\u7684\u751f\u547d\u5468\u671f\u800c\u5b58\u5728\u3002\u5982\u679c\u6709 Executor \u8282\u70b9\u53d1\u751f\u4e86\u6545\u969c\u6216\u5d29\u6e83\uff0cSpark \u5e94\u7528\u4e5f\u53ef\u4ee5\u7ee7\u7eed\u6267\u884c\uff0c\u4f1a\u5c06\u51fa\u9519\u8282\u70b9\u4e0a\u7684\u4efb\u52a1\u8c03\u5ea6\u5230\u5176\u4ed6 Executor \u4e0a\u7ee7\u7eed\u8fd0\u884c\u3002\u4e3b\u8981\u8d1f\u8d23\uff1a\n\u8fd0\u884c\u7ec4\u6210 Spark \u5e94\u7528\u7684\u4efb\u52a1\uff0c\u5e76\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u9a71\u52a8\u5668\u8fdb\u7a0b\uff1b\n\u901a\u8fc7\u81ea\u8eab\u7684\u5757\u7ba1\u7406\u5668\uff08Block Manager\uff09\u4e3a\u7528\u6237\u7a0b\u5e8f\u4e2d\u8981\u6c42\u7f13\u5b58\u7684 RDD \u63d0\u4f9b\u5185\u5b58\u5f0f\u5b58\u50a8\u3002\n\n\nApplication\uff1a\u6307\u7684\u662f\u7528\u6237\u7f16\u5199\u7684 Spark \u5e94\u7528\u7a0b\u5e8f/\u4ee3\u7801\uff0c\u5305\u542b\u4e86 Driver \u529f\u80fd\u4ee3\u7801\u548c\u5206\u5e03\u5728\u96c6\u7fa4\u4e2d\u591a\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u7684 Executor \u4ee3\u7801\u3002\u521d\u59cb\u5316\u4e00\u4e2a SparkContext \u5373\u751f\u6210\u4e00\u4e2a Application\uff1b\nDAG\uff1aDirected Acyclic Graph \u6709\u5411\u65e0\u73af\u56fe\uff0c\u53cd\u6620 RDD \u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u548c\u6267\u884c\u6d41\u7a0b\uff1b\nJob\uff1a\u4e00\u4e2a Action \u7b97\u5b50\u5c31\u4f1a\u751f\u6210\u4e00\u4e2a Job\uff1b\nStage\uff1a\u9636\u6bb5\uff0c\u662f\u4f5c\u4e1a\u7684\u57fa\u672c\u8c03\u5ea6\u5355\u4f4d\uff0c\u9047\u5230\u4e00\u4e2a\u5bbd\u4f9d\u8d56\u5219\u5212\u5206\u4e00\u4e2a Stage\u3002\u540c\u4e00\u4e2a Stage \u4e2d\u7684 Task \u53ef\u4ee5\u5e76\u884c\u6267\u884c\uff0c\u591a\u4e2a Task \u7ec4\u6210 TaskSet \u4efb\u52a1\u96c6\uff1b\nTask\uff1a\u4efb\u52a1\uff0c\u8fd0\u884c\u5728 Executor \u4e0a\u7684\u5de5\u4f5c\u5355\u5143\uff0c1 \u4e2a Task \u8ba1\u7b97 1 \u4e2a\u5206\u533a\uff0c\u5305\u62ec pipline \u4e0a\u7684\u4e00\u7cfb\u5217\u64cd\u4f5c\uff1b\nPartition\uff1a\u6570\u636e\u5206\u533a\uff0c\u4e00\u4e2a RDD \u53ef\u4ee5\u5212\u5206\u4e3a\u591a\u4e2a\u5206\u533a\uff0cSpark \u6839\u636e Partition \u6570\u91cf\u6765\u786e\u5b9a Task \u7684\u6570\u91cf\uff0c\u4e00\u4e2a Partition \u5bf9\u5e94\u4e00\u4e2a Task\u3002\n\n", "categories": [{"name": "\u5b66\u4e60", "slug": "\u5b66\u4e60", "permalink": "https://blog.imadamtang.cn/category/%E5%AD%A6%E4%B9%A0/"}], "tags": []}, {"title": "Hadoop", "date": "2024-07-10T12:00:00+08.00", "path": "https://blog.imadamtang.cn/archives/Hadoop/", "text": "\u4ecb\u7ecd\nApache Hadoop \u662f\u4e00\u79cd\u5f00\u6e90\u6846\u67b6\uff0c\u7528\u4e8e\u9ad8\u6548\u5b58\u50a8\u548c\u5904\u7406\u4ece GB \u7ea7\u5230 PB \u7ea7\u7684\u5927\u578b\u6570\u636e\u96c6\u3002\u5229\u7528 Hadoop\uff0c\u60a8\u53ef\u4ee5\u5c06\u591a\u53f0\u8ba1\u7b97\u673a\u7ec4\u6210\u96c6\u7fa4\u4ee5\u4fbf\u66f4\u5feb\u5730\u5e76\u884c\u5206\u6790\u6d77\u91cf\u6570\u636e\u96c6\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u4e00\u53f0\u5927\u578b\u8ba1\u7b97\u673a\u6765\u5b58\u50a8\u548c\u5904\u7406\u6570\u636e\u3002\u4e09\u5927\u7ec4\u4ef6\nHDFS\nHDFS\uff08Hadoop Distributed File System\uff09\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\uff0c\u8d1f\u8d23\u6570\u636e\u5b58\u50a8\uff0c\u8fd0\u884c\u5728\u5206\u5e03\u5f0f\u96c6\u7fa4\u4e2d\u7684\u4e0d\u540c\u8282\u70b9\u4e0a\u3002\u5199\u6587\u4ef6\u6d41\u7a0b\uff1a\u8bfb\u6587\u4ef6\u6d41\u7a0b\uff1aYARN\nYARN\uff08Yet Another Resource Negotiator\uff09\uff0cHadoop \u8d44\u6e90\u7ba1\u7406\u5668\uff0c\u7ba1\u7406\u4e0e\u76d1\u63a7\u96c6\u7fa4\u8282\u70b9\u548c\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u3002YARN \u7684\u57fa\u672c\u601d\u60f3\u662f\u521b\u5efa\u4e00\u4e2a\u5168\u5c40\u7684ResourceManager(RM)\u548c\u82e5\u5e72\u4e2a\u9488\u5bf9\u5e94\u7528\u7a0b\u5e8f\u7684ApplicationMaster(AM)\u3002\u6d41\u7a0b\uff1aMapReduce\nMapReduce\uff0c\u8d1f\u8d23\u8ba1\u7b97\uff0c\u5c06\u4efb\u52a1\u62c6\u5206\u4e0b\u53d1\uff0c\u8ba1\u7b97\u540e\u5f52\u7ea6\u5230\u4e00\u8d77\u3002\u6d41\u7a0b\uff1a\u53c2\u8003\n\nHadoop\u6838\u5fc3\u7ec4\u4ef6\u8be6\u89e3\n\n", "categories": [{"name": "\u5b66\u4e60", "slug": "\u5b66\u4e60", "permalink": "https://blog.imadamtang.cn/category/%E5%AD%A6%E4%B9%A0/"}], "tags": []}, {"title": "\u6444\u5f71\u5b66\u4e60", "date": "2024-06-18T14:00:00+08.00", "path": "https://blog.imadamtang.cn/archives/%E6%91%84%E5%BD%B1%E5%AD%A6%E4%B9%A0/", "text": "\u601d\u8def\n\n\u8ba9\u5408\u9002\u7684\u5149\u5728\u5408\u9002\u7684\u65f6\u95f4\u4fdd\u7559\u4e0b\u6765\n\u8868\u8fbe\u601d\u60f3\n\n1. \u66dd\u5149\u4e09\u8981\u7d20\n\u6444\u5f71\u4e09\u5927\u8981\u7d20\uff1a\u5149\u5708\u3001\u5feb\u95e8\u3001ISO\uff08\u611f\u5149\u5ea6\uff09\uff0c\u8fd9\u4e09\u5927\u8981\u7d20\u662f\u4ece\u4e0d\u540c\u89d2\u5ea6\u63a7\u5236\u5149\u7684\u91cf\u3002\n\n\n  \u8981\u7d20\n  \u539f\u7406\n  \u6548\u679c\n  \u8d8a\u5927\n  \u8d8a\u5c0f\n\n\n\n\n  \u5149\u5708\uff08F\uff09\n  \u63a7\u5236\u5149\u9525\u89d2\u5ea6\u5f71\u54cd\u8fdb\u5149\u91cf\n  \u865a\u5316\n  \u666f\u6df1\u6d45\uff0c\u865a\u5316\u591a\n  \u666f\u6df1\u6df1\uff0c\u865a\u5316\u5c11\n\n\n  \u5feb\u95e8\uff08n/m\uff09\n  \u63a7\u5236\u8fdb\u5149\u65f6\u95f4\n  \u52a8\u6001\u6a21\u7cca\n  \u52a8\u6001\u6a21\u7cca\u591a\n  \u52a8\u6001\u6a21\u7cca\u5c11\n\n\n  ISO\uff08\u6570\u503c\uff09\n  \u63a7\u5236\u5149\u654f\u611f\u7a0b\u5ea6\uff08\u4eae\u5ea6\u624b\u52a8\u8865\u507f\uff09\n  \u4eae\u5ea6\u548c\u8e81\u70b9\n  \u4eae\u5ea6\u9ad8\uff0c\u8e81\u70b9\u5c11\n  \u4eae\u5ea6\u4f4e\uff0c\u8e81\u70b9\u9ad8\n\n\n\n\n\u5149\u5708\u5b9e\u9645\u5927\u5c0f\u548cF\u6570\u503c\u5448\u53cd\u6bd4\uff0c\u8868\u683c\u4ee5\u5149\u5708\u5b9e\u9645\u5927\u5c0f\u8fdb\u884c\u9610\u8ff0\n\u66dd\u5149\u539f\u74062. \u76f8\u673a\u53c2\u6570\n2.1 \u6863\u4f4d\n\u76f8\u673a\u5e38\u89c1\u6863\u4f4d\uff1aA\u3001S\u3001P\u3001M\n\n\n  \u6863\u4f4d\n  \u5149\u5708\n  \u5feb\u95e8\n  ISO\n  \u7528\u9014\n  \u9650\u5236\n\n\n\n\n  A/AV\n  \u624b\u52a8\n  \u81ea\u52a8\n  \u81ea\u52a8/\u624b\u52a8\n  \u9759\u6001\u7269\u4f53\n  \u5149\u7ebf\u4e0d\u8db3\u4f1a\u5bfc\u81f4\u5feb\u95e8\u589e\u52a0\uff0c\u5bfc\u81f4\u7167\u7247\u52a8\u6001\u6a21\u7cca\n\n\n  S/TV\n  \u81ea\u52a8\n  \u624b\u52a8\n  \u81ea\u52a8/\u624b\u52a8\n  \u8fd0\u52a8\u7269\u4f53\n  \u5149\u7ebf\u5145\u8db3\u65f6\u5bfc\u81f4\u5149\u5708\u6559\u5927\uff0c\u865a\u5316\u8f83\u5f31\n\n\n  P\n  \u81ea\u52a8\n  \u81ea\u52a8\n  \u81ea\u52a8/\u624b\u52a8\n  \\\n  \u8c03\u6574\u5149\u5708/\u5feb\u95e8\u65f6\uff0c\u76f8\u673a\u81ea\u52a8\u8c03\u6574\u5feb\u95e8/\u5149\u5708\n\n\n  M\n  \u624b\u52a8\n  \u624b\u52a8\n  \u81ea\u52a8/\u624b\u52a8\n  \\\n  \u5168\u90e8\u624b\u52a8\u63a7\u5236\uff0c\u4f46\u9700\u8981\u8db3\u591f\u7684\u521b\u4f5c\u65f6\u95f4\n\n\n\n\n\u66dd\u5149\u8865\u507f\uff1a\u4e00\u79cd\u7a0b\u5e8f\u7b97\u6cd5\uff0c\u989d\u5916\u589e\u52a0\u66dd\u5149\u76f4\u65b9\u56fe\uff1a\u5224\u65ad\u66dd\u5149\u7684\u6570\u636e\u5316\u5224\u65ad\u65b9\u6cd5\n2.2 RAW\nRAW\u662f\u4e00\u79cd\u6ca1\u6709\u5904\u7406\u548c\u538b\u7f29\u7684\u539f\u59cb\u6570\u636e\u683c\u5f0f\uff0c\u538b\u7f29\u5904\u7406\u8fc7\u7684\u53ebjpg\u3002RAW\u4f1a\u4fdd\u7559\u7167\u7247\u7684\u6240\u6709\u8272\u5f69\u548c\u4eae\u5ea6\u4fe1\u606f\uff0c\u65b9\u4fbf\u540e\u671f\u5904\u7406\u3002\u800cjpg\u5219\u662f\u5904\u7406\u538b\u7f29\u540e\u7684\u6570\u636e\uff0c\u65e0\u6cd5\u8fd8\u539f\uff0c\u4f46\u597d\u5904\u662f\u8282\u7701\u7a7a\u95f4\u3002RAW\u5e38\u7528\u4e8e\u5904\u7406\u66dd\u5149\u4e0d\u51c6\u786e\u3001\u8272\u5f69\u504f\u8272\u3001\u8272\u5f69\u65ad\u5c42\u7684\u95ee\u9898\u30022.3 \u767d\u5e73\u8861\n\u76f8\u673a\u662f\u4ee5\u767d\u8272\u4e3a\u57fa\u51c6\u6765\u751f\u6210\u5176\u4ed6\u989c\u8272\u7684\uff0c\u6240\u4ee5\u767d\u8272\u7684\u51c6\u786e\u6027\u5f71\u54cd\u7740\u6574\u4e2a\u753b\u9762\u989c\u8272\u7684\u51c6\u786e\u6027\u3002\u767d\u5e73\u8861\u5c31\u662f\u544a\u8bc9\u76f8\u673a\u54ea\u4e00\u4e2a\u662f\u51c6\u786e\u7684\u767d\u8272\u3002\u800c\u7531\u4e8e\u73af\u5883\u5149\u7684\u5f71\u54cd\uff0c\u4e0d\u540c\u573a\u666f\u4e0b\uff0c\u4f8b\u5982\u6674\u5929\u3001\u5ba4\u5185\u3001\u767d\u70bd\u706f\u7b49\uff0c\u767d\u8272\u5b9e\u9645\u663e\u793a\u662f\u4e0d\u540c\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u9700\u8981\u5728\u7279\u5b9a\u7684\u573a\u666f\u4e2d\u544a\u8bc9\u76f8\u673a\u767d\u8272\u5e94\u8be5\u662f\u54ea\u79cd\u989c\u8272\uff0c\u5c31\u9700\u8981\u9009\u62e9\u4e0d\u540c\u7684\u767d\u5e73\u8861\u3002\u5927\u90e8\u5206\u573a\u666f\u90fd\u57283500k\u52305600k\u5de6\u53f3\uff0c\u5e38\u7528\u7684\u53ef\u4ee5\u8bbe\u7f6e\u4e3a5000k\u3002\u767d\u5e73\u8861\u548c\u8272\u6e29\n\u91c7\u7528RAW\u683c\u5f0f\u540e\u671f\u53ef\u4ee5\u624b\u52a8\u8c03\u6574\u767d\u5e73\u8861\n2.4 \u6d4b\u5149\n\u6d4b\u5149\u662f\u6d4b\u8bd5\u4eae\u5ea6\u662f\u5426\u6b63\u5e38\u7684\u4e00\u4e2a\u624b\u6bb5\u3002\u7531\u4e8e\u753b\u9762\u4e2d\u4e0d\u540c\u4f4d\u7f6e\u7684\u7269\u4f53\u660e\u6697\u4e0d\u540c\uff0c\u76f8\u673a\u4e0d\u80fd\u667a\u80fd\u7684\u8bc6\u522b\u4e3b\u4f53\uff0c\u6211\u4eec\u9700\u8981\u544a\u8bc9\u76f8\u673a\u4ee5\u54ea\u4e9b\u4f4d\u7f6e\u7684\u4eae\u5ea6\u4e3a\u4e3b\uff0c\u4ece\u800c\u63a7\u5236\u753b\u9762\u7684\u66dd\u5149\u91cf\u3002\n\n\n  \u6d4b\u5149\u6a21\u5f0f\n  \u539f\u7406\n  \u4f7f\u7528\u573a\u666f\n\n\n\n\n  \u591a\u91cd\u6d4b\u5149\n  \u753b\u9762\u591a\u4e2a\u70b9\u6d4b\u5149\uff0c\u53d6\u5e73\u5747\u503c\n  \u6ca1\u6709\u592a\u591a\u660e\u6697\u5dee\u8ddd\n\n\n  \u4e2d\u592e\u6d4b\u5149\n  \u4ee5\u4e2d\u592e\u70b9\u8fdb\u884c\u6d4b\u5149\n  \u4e3b\u4f53\u5728\u753b\u9762\u4e2d\u5fc3\u70b9\n\n\n  \u70b9\u6d4b\u5149/\u5c40\u90e8\u6d4b\u5149\n  \u4ee5\u753b\u9762\u67d0\u4e00\u70b9/\u5c40\u90e8\u8fdb\u884c\u6d4b\u5149\n  \u4e3b\u9898\u5728\u753b\u9762\u67d0\u4e2a\u56fa\u5b9a\u4f4d\u7f6e\n\n\n\n\n\u4eae\u5ea6\u9501\uff1a\u5f53\u79fb\u52a8\u955c\u5934\u5bfc\u81f4\u6d4b\u5149\u70b9\u53d1\u751f\u6539\u53d8\u65f6\uff0c\u76f8\u673a\u4eae\u5ea6\u4ecd\u7136\u4fdd\u6301\u4e0d\u53d8\uff0c\u9002\u7528\u4e8e\u56fa\u5b9a\u573a\u666f\u3002\n2.5 \u5bf9\u7126\n\u7531\u66dd\u5149\u539f\u7406\u53ef\u77e5\uff0c\u76f8\u673a\u6210\u50cf\u65f6\uff0c\u6709\u4e00\u6bb5\u8ddd\u79bb\u7684\u7269\u4f53\u5448\u73b0\u6d45\u666f\u6df1\uff0c\u753b\u9762\u6e05\u6670\uff0c\u6211\u4eec\u79f0\u4e3a\u7126\u8ddd\u5185\uff08\u7126\u5185\uff09\u3002\u800c\u524d\u540e\u865a\u5316\u7684\u90e8\u5206\uff0c\u6211\u4eec\u79f0\u4e3a\u7126\u8ddd\u5916\uff08\u7126\u5916\uff09\u3002\u5bf9\u7126\uff0c\u5c31\u662f\u5c06\u88ab\u6444\u4e3b\u4f53\u653e\u5728\u7126\u5185\u7684\u8fc7\u7a0b\u3002\u800c\u5149\u5708\uff0c\u53ef\u4ee5\u63a7\u5236\u5668\u6e05\u6670\u90e8\u5206\u7684\u8ddd\u79bb\u3002\u5f53\u91c7\u7528\u5927\u5149\u5708\u65f6\uff0c\u6e05\u6670\u8ddd\u79bb\u8f83\u77ed\uff0c\u865a\u5316\u8f83\u5f3a\uff0c\u5bf9\u7126\u8303\u56f4\u66f4\u5e7f\uff1b\u5f53\u91c7\u7528\u5c0f\u5149\u5708\u65f6\uff0c\u6e05\u6670\u8ddd\u79bb\u8f83\u957f\uff0c\u865a\u5316\u8f83\u5f31\uff0c\u5bf9\u7126\u8303\u56f4\u66f4\u7a84\u3002\u63a7\u5236\u5bf9\u7126\u7684\u53c2\u6570\u5982\u4e0b\uff1a\n\n\n  \u5bf9\u7126\u53c2\u6570\n  \u539f\u7406\n  \u8d8a\u5927\n  \u8d8a\u5c0f\n\n\n\n\n  \u5149\u5708\n  \u5bf9\u7126\u8303\u56f4\n  \u8d8a\u5c0f\n  \u8d8a\u5927\n\n\n  \u5bf9\u7126\u73af\n  \u7126\u8ddd\n  \u8d8a\u8fdc\n  \u8d8a\u8fd1\n\n\n\n\u7531\u4e8e\u88ab\u6444\u4e3b\u4f53\u5e76\u975e\u5b8c\u5168\u9759\u6b62\u7684\uff0c\u6240\u4ee5\u6839\u636e\u4e3b\u4f53\u7684\u8fd0\u52a8\u60c5\u51b5\uff0c\u8fd8\u9700\u8981\u9009\u62e9\u4e0d\u540c\u7684\u5bf9\u7126\u6a21\u5f0f\u3002\u63a7\u5236\u5bf9\u7126\u7684\u6a21\u5f0f\u5982\u4e0b\uff1a\n\n\n  \u5bf9\u7126\u6a21\u5f0f\n  \u539f\u7406\n  \u9002\u7528\u573a\u666f\n\n\n\n\n  \u624b\u52a8\u5bf9\u7126\n  \u624b\u52a8\u63a7\u5236\u7126\u8ddd\n  \\\n\n\n  \u5355\u6b21\u81ea\u52a8\u5bf9\u7126\uff08AF-S\uff09\n  \u81ea\u52a8\u5bf9\u7126\u4e00\u6b21\u4e3b\u4f53\n  \u9759\u6b62\u4e3b\u4f53\n\n\n  \u8fde\u7eed\u81ea\u52a8\u5bf9\u7126 \uff08AF-C\uff09\n  \u81ea\u52a8\u5bf9\u7126\u591a\u6b21\u4e3b\u4f53\n  \u8fd0\u52a8\u4e3b\u4f53\n\n\n  \u591a\u6b21\u81ea\u52a8\u5bf9\u7126\uff08AF-A\uff09\n  \u81ea\u52a8\u9009\u62e9AF-S\u6216AF-C\n  \u9759\u6b62+\u8fd0\u52a8\u4e3b\u4f53\n\n\n\n\u800c\u88ab\u6444\u4e3b\u4f53\u7531\u4e8e\u5728\u753b\u9762\u4e2d\u4e0d\u540c\u4f4d\u7f6e\u53ef\u80fd\u8fdc\u8fd1\u4e0d\u540c\uff0c\u548c\u6d4b\u5149\u6a21\u5f0f\u4e00\u6837\uff0c\u5728\u81ea\u52a8\u5bf9\u7126\u65f6\uff0c\u5bf9\u7126\u4e5f\u6709\u5bf9\u7126\u533a\u57df\u7684\u533a\u522b\uff1a\n\n\n  \u5bf9\u7126\u533a\u57df\n  \u539f\u7406\n  \u9002\u7528\u573a\u666f\n\n\n\n\n  \u5e7f\u57df\u5bf9\u7126\n  \u6574\u4e2a\u753b\u9762\u68c0\u6d4b\u5bf9\u7126\u70b9\n  \u901a\u7528\n\n\n  \u533a\u57df\u5bf9\u7126\n  \u56fa\u5b9a\u4e00\u90e8\u5206\u533a\u57df\u8fdb\u884c\u5bf9\u7126\n  \u4e3b\u4f53\u56fa\u5b9a\u5728\u67d0\u4e00\u533a\u57df\n\n\n  \u70b9\u5bf9\u7126\n  \u56fa\u5b9a\u67d0\u4e00\u70b9\u8fdb\u884c\u5bf9\u7126\n  \u4e3b\u4f53\u56fa\u5b9a\u5728\u67d0\u4e00\u70b9\n\n\n\n\n\u90e8\u5206\u76f8\u673a\u5df2\u6709\u4eba\u8138/\u773c\u90e8\u5bf9\u7126\uff0c\u9002\u7528\u4e8e\u4eba\u50cf\u62cd\u6444\u7684\u5bf9\u7126\u6a21\u5f0f\u3002\n2.6 \u7126\u8ddd\n\u7126\u8ddd\u662f\u955c\u5934\u5230\u6210\u50cf\u5355\u5143CMOS\u4e4b\u95f4\u7684\u8ddd\u79bb\uff0c\u6539\u53d8\u8fd9\u4e2a\u8ddd\u79bb\uff0c\u53ef\u4ee5\u6539\u53d8\u89c6\u89d2\u5927\u5c0f\u3002\u6309\u7167\u7126\u8ddd\u7684\u957f\u77ed\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u955c\u5934\u5206\u4e3a\u4e09\u7c7b\uff1a\u5e7f\u89d2\u3001\u6807\u51c6\u3001\u957f\u7126\n\n\n  \u955c\u5934\u7c7b\u522b\n  \u7126\u8ddd\uff08mm\uff09\n  \u89c6\u89d2\n  \u5bf9\u900f\u89c6\u5173\u7cfb\u7684\u5f71\u54cd\n\n\n\n\n  \u5e7f\u89d2\u955c\u5934\n  &lt; 35\n  \u5e7f\n  \u8fd1\u5927\u8fdc\u5c0f\u7a81\u51fa\uff0c\u6709\u8f83\u5f3a\u7684\u538b\u8feb\u611f\n\n\n  \u6807\u51c6\u955c\u5934\n  24\uff0c50\n  \u6b63\u5e38\n  \u63a5\u8fd1\u4eba\u773c\n\n\n  \u957f\u7126\u955c\u5934\n  &gt; 85\n  \u7a84\n  \u8fd1\u5927\u8fdc\u5c0f\u4e0d\u660e\u663e\uff0c\u753b\u9762\u538b\u7f29\u611f\u5f3a\n\n\n\n\n\u7126\u6bb5\uff1a\u53d8\u7126\u955c\u5934\u652f\u6301\u7684\u7126\u8ddd\u8303\u56f4\n3. \u6784\u56fe\n\u6838\u5fc3\u70b9\uff1a\u7a81\u51fa\u4e3b\u4f53\u3001\u753b\u9762\u5e73\u8861\n\u7a81\u51fa\u4e3b\u4f53\u662f\u4e00\u4e2a\u5bbd\u6cdb\u7684\u6982\u5ff5\uff0c\u5e76\u975e\u5c06\u4e3b\u4f53\u7f6e\u4e8e\u4e2d\u592e\u6216\u653e\u5927\uff0c\u800c\u662f\u8ba9\u7167\u7247\u5185\u5bb9\u4e3a\u4e3b\u4f53\u670d\u52a1\u3002\n\u901a\u8fc7\u4e00\u4e9b\u57fa\u672c\u6280\u5de7\uff0c\u5b66\u4e60\u5982\u4f55\u5229\u7528\u6784\u56fe\u8fdb\u884c\u753b\u9762\u7684\u9610\u8ff03.1 \u5e38\u89c1\u7684\u6784\u56fe\u6280\u5de7\n\u4e09\u5206\u7ebf\u6784\u56fe\u79d1\u5b66\u8bc1\u660e\uff0c\u4eba\u773c\u6700\u5bb9\u6613\u88ab\u5438\u5f15\u5230\u753b\u9762\u7684\u4e09\u5206\u7ebf\u4f4d\u7f6e\uff0c\u4e5f\u5c31\u662f\u4e0b\u56fe\u4e2d\u76844\u4e2a\u70b9\u3002\u4e09\u5206\u7ebf\u5c06\u4e3b\u4f53\u7f6e\u4e8e\u4e09\u5206\u7ebf\u5904\uff0c\u4f1a\u4f7f\u5f97\u753b\u9762\u66f4\u5177\u6545\u4e8b\u611f/\u7535\u5f71\u611f\u3002\u4f46\u662f\u8981\u6ce8\u610f\uff0c\u53e6\u4e00\u7aef\u7aef\u4e09\u5206\u7ebf\u9700\u8981\u6709\u80cc\u666f\u5bf9\u753b\u9762\u8fdb\u884c\u5e73\u8861\uff0c\u5426\u5219\u5c06\u4f7f\u5f97\u753b\u9762\u7565\u663e\u7a7a\u6d1e\u3002\u6b64\u5916\uff0c\u5982\u679c\u6211\u4eec\u5c06\u4e3b\u4f53\u7f6e\u4e8e\u753b\u9762\u4e2d\u5fc3\u4f4d\u7f6e\u65f6\uff0c\u4f1a\u4f7f\u5f97\u4e3b\u4f53\u975e\u5e38\u7a81\u51fa\uff0c\u4f1a\u663e\u793a\u51fa\u6743\u5a01\u3001\u538b\u8feb\u3001\u4e25\u8083\u7b49\u611f\u89c9\u3002\u5e73\u8861\u7ed9\u753b\u9762\u4e00\u79cd\u5b8c\u6574\u611f\u3002\u5e73\u8861\u6df1\u5ea6\u901a\u8fc7\u5927\u5149\u5708\uff0c\u5f97\u5230\u6d45\u666f\u6df1\uff0c\u4f7f\u5f97\u80cc\u666f\u865a\u5316\uff0c\u5c06\u4e3b\u4f53\u4ece\u6742\u4e71\u7684\u80cc\u666f\u4e2d\u51f8\u663e\u51fa\u73b0\uff0c\u662f\u4e00\u79cd\u8f83\u4e3a\u5e38\u89c1\u7684\u9664\u6742\u65b9\u6cd5\u3002\u666f\u6df1\u9664\u4e86\u666f\u6df1\uff0c\u8fd8\u6709\u589e\u52a0\u753b\u9762\u70b9\u524d\u666f\u6216\u8005\u540e\u666f\uff0c\u4f7f\u5f97\u753b\u9762\u7eb5\u6df1\u611f\u66f4\u591a\u3002\u524d\u540e\u666f\u5f15\u5bfc\u7ebf\u5f15\u5bfc\u89c2\u4f17\u5bf9\u4e3b\u4f53\u5bf9\u6ce8\u610f\u529b\u5f15\u5bfc\u7ebf\u5bf9\u79f0\u753b\u9762\u5bf9\u79f0\u4f1a\u4f7f\u5f97\u753b\u9762\u66f4\u5177\u79e9\u5e8f\u6027\uff0c\u4e5f\u53ef\u80fd\u7a81\u51fa\u4e3b\u4f53\u3001\u9664\u6742\u3002\u5bf9\u79f0\u4e3b\u5bfc\u5730\u4f4d\u9700\u8981\u8ba9\u89c2\u4f17\u77e5\u9053\u773c\u775b\u8be5\u770b\u54ea\u91cc\uff0c\u62cd\u6444\u7684\u4e3b\u4f53\u5bf9\u8c61\u662f\u4ec0\u4e48\uff0c\u4e0d\u80fd\u8ba9\u89c2\u4f17\u5206\u6563\u6ce8\u610f\u529b\u3002\u4e3b\u5bfc\u5730\u4f4d\u6253\u7834\u89c4\u5219\u6444\u5f71\u4e2d\u7684\u4e00\u4e9b\u89c4\u5219\u4f1a\u4f7f\u5f97\u6211\u4eec\u5bf9\u753b\u9762\u8868\u8fbe\u975e\u5e38\u201c\u6b63\u786e\u201d\uff0c\u4f46\u5728\u4e00\u4e9b\u8868\u8fbe\u4e2d\uff0c\u6211\u4eec\u5e0c\u671b\u753b\u9762\u8868\u8fbe\u51fa\u4e00\u79cd\u201c\u4e0d\u6b63\u786e\u201d\u7684\u60f3\u6cd5\u3002\u53ef\u80fd\u662f\u88ab\u62cd\u6444\u7684\u4e3b\u89d2\u5f88\u6e3a\u5c0f\uff0c\u6240\u4ee5\u4ed6\u6ca1\u6709\u653e\u5728\u4e2d\u5fc3\u70b9\u6216\u4e09\u5206\u7ebf\u4e0a\u3002\u53ef\u80fd\u662f\u88ab\u62cd\u6444\u7684\u4e3b\u89d2\u5f88\u8ff7\u832b\u614c\u4e71\uff0c\u6240\u4ee5\u4ed6\u7684\u80cc\u666f\u4e5f\u53ef\u80fd\u975e\u5e38\u6742\u4e71\u65e0\u7ae0\u3002\u8fd9\u91cc\u53c8\u8bf4\u56de\u6784\u56fe\u7684\u672c\u8d28\uff0c\u6784\u56fe\u662f\u901a\u8fc7\u753b\u9762\u7ed3\u6784\u6765\u8f85\u52a9\u8868\u8fbe\u5bf9\u601d\u60f3\uff0c\u5b83\u4e00\u5b9a\u662f\u8f85\u52a9\u800c\u975e\u4e3b\u5bfc\u7684\u3002\u6240\u4ee5\u5f53\u8868\u8fbe\u7684\u601d\u60f3\u53d1\u751f\u4e00\u4e9b\u6539\u53d8\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0d\u7528\u9075\u5faa\u6784\u56fe\u7684\u89c4\u5219\uff0c\u800c\u8fdb\u884c\u9002\u5f53\u7684\u6253\u7834\u3002\u4f46\u8fd9\u4e9b\u6253\u7834\u901a\u5e38\u9700\u8981\u5927\u91cf\u7684\u7ecf\u9a8c\u548c\u5ba1\u7f8e\u80fd\u529b\u624d\u4f1a\u8ba9\u4eba\u8ba9\u6253\u7834\u89c4\u5219\u7684\u6784\u56fe\u8f85\u52a9\u5230\u6211\u4eec\u60f3\u8868\u8fbe\u7684\u601d\u60f3\u3002", "categories": [{"name": "\u6444\u5f71", "slug": "\u6444\u5f71", "permalink": "https://blog.imadamtang.cn/category/%E6%91%84%E5%BD%B1/"}], "tags": []}, {"title": "Ceph\u4ece\u5165\u95e8\u5230\u7785\u7785", "date": "2024-06-05T21:23:00+08.00", "path": "https://blog.imadamtang.cn/archives/Ceph%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%9E%85%E7%9E%85/", "text": "1. \u6982\u8ff0\n1.1 \u5b9a\u4e49\nCeph\u662f\u4e00\u79cd\u4e3a\u4f18\u79c0\u7684\u6027\u80fd\u3001\u53ef\u9760\u6027\u548c\u53ef\u6269\u5c55\u6027\u800c\u8bbe\u8ba1\u7684\u7edf\u4e00\u7684\u3001\u5f00\u6e90\u7684\u5206\u5e03\u5f0f\u7684\u5b58\u50a8\u7cfb\u7edf\u3002\u8be6\u7ec6\u5185\u5bb9\u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u6587\u68631.2 \u7279\u70b9\n\nCeph\u63d0\u4f9b\u7ed9\u4e86\u5bf9\u8c61\u3001\u5757\u3001\u6587\u4ef6\u5b58\u50a8\u529f\u80fd\uff0c\u9002\u5408\u6d77\u91cf\u6570\u636e\u7684\u7ba1\u7406\u3002\n\u6709\u5f3a\u5927\u7684\u4f38\u7f29\u6027\uff1a\u4f9b\u7528\u6237\u8bbf\u95eePB\u4e43\u81f3EB\u7ea7\u7684\u6570\u636e\nCeph\u5b58\u50a8\u96c6\u7fa4\u7ec7\u8d77\u4e86\u5927\u91cf\u8282\u70b9\uff0c\u5b83\u4eec\u4e4b\u95f4\u9760\u76f8\u4e92\u901a\u8baf\u6765\u590d\u5236\u6570\u636e\u3001\u5e76\u52a8\u6001\u5730\u91cd\u5206\u5e03\u6570\u636e\u3002\n\n1.3 \u6838\u5fc3\u7ec4\u4ef6\nCeph\u7684\u6838\u5fc3\u7ec4\u4ef6\u5305\u62ecCeph OSD\u3001Ceph Monitor\u3001Ceph MDS\u4e09\u5927\u7ec4\u4ef6\u3002\nCeph OSD\n\nObject Storage Device\uff0c\u4e3b\u8981\u529f\u80fd\u662f\u5b58\u50a8\u6570\u636e\u3001\u590d\u5236\u6570\u636e\u3001\u5e73\u8861\u6570\u636e\u3001\u6062\u590d\u6570\u636e\u7b49\uff0c\u4e0e\u5176\u4ed6OSD\u8fdb\u884c\u5fc3\u8df3\u68c0\u67e5\uff0c\u4e0a\u62a5\u53d8\u5316\u60c5\u51b5\u7ed9Ceph Monitor\u3002\u4e00\u822c\u4e00\u4e2aOSD\u5bf9\u5e94\u4e00\u4e2a\u786c\u76d8\uff08\u6216\u5206\u533a\uff09\uff0c\u5e76\u5bf9\u5176\u8fdb\u884c\u7ba1\u7406\u3002\nCeph Monitor\n\n\u8d1f\u8d23\u76d1\u89c6Ceph\u96c6\u7fa4\uff0c\u7ef4\u62a4Ceph\u96c6\u7fa4\u7684\u5065\u5eb7\u72b6\u6001\u3001Cluster Map\u3002\nCluster Map\u662fRADOS\u7684\u5173\u952e\u6570\u636e\u7ed3\u6784\uff0c\u7ba1\u7406\u96c6\u7fa4\u79cd\u7684\u6240\u6709\u6210\u5458\u3001\u5173\u7cfb\u3001\u5c5e\u6027\u7b49\u4fe1\u606f\uff0c\u4ee5\u53ca\u6570\u636e\u5206\u53d1\u3002\u5f53\u7528\u6237\u9700\u8981\u5b58\u50a8\u6570\u636e\u5230Ceph\u96c6\u7fa4\u65f6\uff0cOSD\u5148\u901a\u8fc7Monitor\u83b7\u53d6\u6700\u65b0Map\u56fe\uff0c\u518d\u6839\u636eMap\u56fe\u548cObject id\u7b49\uff0c\u8ba1\u7b97\u51fa\u6570\u636e\u6700\u7ec8\u5b58\u50a8\u4f4d\u7f6e\u3002\n\nCeph MDS\n\nCeph MetaData Server\uff0c\u4e3b\u8981\u4fdd\u5b58\u7684\u6587\u4ef6\u7cfb\u7edf\u670d\u52a1\u7684\u5143\u6570\u636e\uff0c\u4f46\u5bf9\u8c61\u5b58\u50a8\u548c\u5757\u5b58\u50a8\u8bbe\u5907\u662f\u4e0d\u9700\u8981\u4f7f\u7528\u8be5\u670d\u52a1\u7684\u3002\n\u5143\u6570\u636e\uff1a\u53c8\u79f0\u4e3a\u4e2d\u4ecb\u6570\u636e\u3001\u4e2d\u7ee7\u6570\u636e\u3002\u4e3b\u8981\u63cf\u8ff0\u6570\u636e\u5c5e\u6027\u7684\u4fe1\u606f\uff0c\u7528\u6765\u652f\u6301\u5982\u6307\u793a\u5b58\u50a8\u4f4d\u7f6e\u3001\u5386\u53f2\u6570\u636e\u3001\u8d44\u6e90\u67e5\u627e\u3001\u6587\u4ef6\u8bb0\u5f55\u7b49\u529f\u80fd\u3002\u7b80\u8a00\u4e4b\uff0c\u5c31\u662f\u7528\u4e8e\u63cf\u8ff0\u4e00\u4e2a\u6587\u4ef6\u7279\u5f81\u7684\u7cfb\u7edf\u6570\u636e\uff0c\u6bd4\u5982\u8bbf\u95ee\u6743\u9650\u3001\u6587\u4ef6\u62e5\u6709\u8005\u4ee5\u53ca\u6587\u4ef6\u6570\u636e\u5e93\u7684\u5206\u5e03\u4fe1\u606f\uff08inode)\u7b49\u7b49\u3002\u5728\u96c6\u7fa4\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u5206\u5e03\u4fe1\u606f\u5305\u62ec\u6587\u4ef6\u5728\u78c1\u76d8\u4e0a\u7684\u4f4d\u7f6e\u4ee5 \u53ca\u78c1\u76d8\u5728\u96c6\u7fa4\u4e2d\u7684\u4f4d\u7f6e\u3002\u7528\u6237\u9700\u8981\u64cd\u4f5c\u4e00\u4e2a\u6587\u4ef6\u5c31\u5fc5\u987b\u9996\u5148\u5f97\u5230\u5b83\u7684\u5143\u6570\u636e\uff0c\u624d\u80fd\u5b9a\u4f4d\u5230\u6587\u4ef6\u7684\u4f4d\u7f6e\u5e76\u4e14\u5f97\u5230\u6587\u4ef6\u7684\u5185\u5bb9\u6216\u76f8\u5173\u5c5e\u6027\u3002\n\nManagers\n\nCeph Manager\u5b88\u62a4\u8fdb\u7a0b\uff08ceph-mgr\uff09\u8d1f\u8d23\u8ddf\u8e2a\u8fd0\u884c\u65f6\u6307\u6807\u548cCeph\u96c6\u7fa4\u7684\u5f53\u524d\u72b6\u6001\uff0c\u5305\u62ec\u5b58\u50a8\u5229\u7528\u7387\uff0c\u5f53\u524d\u6027\u80fd\u6307\u6807\u548c\u7cfb\u7edf\u8d1f\u8f7d\u3002\nCeph Manager\u5b88\u62a4\u8fdb\u7a0b\u8fd8\u57fa\u4e8epython\u7684\u63d2\u4ef6\u6765\u7ba1\u7406\u548c\u516c\u5f00Ceph\u96c6\u7fa4\u4fe1\u606f\uff0c\u5305\u62ec\u57fa\u4e8eWeb\u7684Ceph Manager Dashboard\u548c REST API\u3002\u9ad8\u53ef\u7528\u6027\u901a\u5e38\u81f3\u5c11\u9700\u8981\u4e24\u4e2a\u7ba1\u7406\u5668\u3002\n1.4 \u67b6\u6784\n\u67b6\u6784\u56feCeph\u53ef\u5206\u4e3a\u56db\u4e2a\u5c42\u7ea7\n\uff081\uff09\u57fa\u7840\u5b58\u50a8\u7cfb\u7edfRADOS\n\nRADOS (Reliable, Autonomic, Distributed Object Store) \u610f\u4e3a\u53ef\u9760\u3001\u81ea\u52a8\u3001\u5206\u5e03\u5f0f\u7684\u5bf9\u8c61\u5b58\u50a8\uff0c\u8fd9\u4e00\u5c42\u662fCeph\u7684\u57fa\u7840\uff0c\u5373\u7528\u6765\u5b58\u50a8\u7528\u6237\u6570\u636e\u4e00\u5c42\u3002\n\uff082\uff09\u57fa\u7840\u5e93librados\n\n\u5bf9RADOS\u62bd\u8c61\u3001\u5c01\u88c5\uff0c\u5411\u4e0a\u5c42\u63d0\u4f9bAPI\uff0c\u4fbf\u4e8e\u76f4\u63a5\u57fa\u4e8eRADOS\u8fdb\u884c\u5f00\u53d1\u3002\nRADOS\u91c7\u7528C++\u5f00\u53d1\uff0c\u539f\u751flibrados API\u5305\u62ecC\u548cC++\u4e24\u7c7b\u3002librados\u548c\u57fa\u4e8e\u5176\u5f00\u53d1\u7684\u5e94\u7528\u5728\u7269\u7406\u4e0a\u4f4d\u4e8e\u540c\u4e00\u53f0\u673a\u5668\uff0c\u4e5f\u56e0\u6b64\u88ab\u79f0\u4e3a\u672c\u5730API\u3002\u5e94\u7528\u901a\u8fc7\u672c\u5730\u8c03\u7528librados API\uff0c\u518d\u7531librados API\u901a\u8fc7socket\u4e0eRADOS\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u901a\u4fe1\u5b8c\u6210\u64cd\u4f5c\u3002\n\n\uff083\uff09\u9ad8\u5c42\u5e94\u7528\u63a5\u53e3\nRADOS GW (RADOS Gateway) \uff1a\u662f\u4e00\u4e2a\u63d0\u4f9b\u4e0eAmazon S3\u548cSwift\u517c\u5bb9\u7684RESTful API\u7684gateway\uff0c\u4ee5\u4f9b\u76f8\u5e94\u7684\u5bf9\u8c61\u5b58\u50a8\u5e94\u7528\u5f00\u53d1\u4f7f\u7528\u3002RADOS GW\u63d0\u4f9b\u7684API\u62bd\u8c61\u5c42\u6b21\u66f4\u9ad8\uff0c\u4f46\u529f\u80fd\u5219\u4e0d\u5982librados\u5f3a\u5927\u3002\u56e0\u6b64\uff0c\u5f00\u53d1\u8005\u5e94\u9488\u5bf9\u81ea\u5df1\u7684\u9700\u6c42\u9009\u62e9\u4f7f\u7528\u3002\nRBD (Reliable Block Device)\uff1a\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6807\u51c6\u7684\u5757\u8bbe\u5907\u63a5\u53e3\uff0c\u5e38\u7528\u4e8e\u5728\u865a\u62df\u5316\u7684\u573a\u666f\u4e0b\u4e3a\u865a\u62df\u673a\u521b\u5efavolume\u3002\u76ee\u524d\uff0cRed Hat\u5df2\u7ecf\u5c06RBD\u9a71\u52a8\u96c6\u6210\u5728KVM/QEMU\u4e2d\uff0c\u4ee5\u63d0\u9ad8\u865a\u62df\u673a\u8bbf\u95ee\u6027\u80fd\u3002\n\n\n**\uff084\uff09Ceph FS **\n\nCeph FS(Ceph File System) \uff0c\u5373Ceph\u96c6\u7fa4\u7684\u6587\u4ef6\u7ba1\u7406\u7cfb\u7edf\u3002\u901a\u8fc7Linux\u5185\u6838\u5ba2\u6237\u7aef\u548cFUSE\u6765\u63d0\u4f9b\u4e00\u4e2a\u517c\u5bb9POSIX\u7684\u6587\u4ef6\u7cfb\u7edf\u3002RADOS\u7684\u5b58\u50a8\u903b\u8f91\u67b6\u6784RADOS\u7cfb\u7edf\u7ed3\u6784\u56feRADOS\u96c6\u7fa4\u4e3b\u8981\u6709\u4e24\u79cd\u8282\u70b9\uff1a\nOSD\uff08\u8d1f\u8d23\u6570\u636e\u5b58\u50a8\u548c\u7ef4\u62a4\uff09\nMonitor\uff08\u7cfb\u7edf\u72b6\u6001\u68c0\u6d4b\u548c\u7ef4\u62a4\uff09\n\nOSD\u548cMonitor\u4e4b\u95f4\u76f8\u4e92\u4f20\u8f93\u8282\u70b9\u72b6\u6001\u4fe1\u606f\uff0c\u5f62\u6210Cluster Map\u3002Cluster Map\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u548cRADOS\u63d0\u4f9b\u7684\u7279\u5b9a\u7b97\u6cd5\u76f8\u7ed3\u5408\uff0c\u5b9e\u73b0\u4e86Ceph\u201c\u65e0\u9700\u67e5\u8868\uff0c\u7b97\u7b97\u5c31\u597d\u201d\u7684\u6838\u5fc3\u673a\u5236\u548c\u82e5\u5e72\u4f18\u79c0\u7279\u6027\u3002\n\u5982\u4f55\u201c\u7b97\u201d\u51fa\u5b58\u50a8\u4f4d\u7f6e\uff1aCRUSH\n\u5ba2\u6237\u7aef\u7a0b\u5e8f\u901a\u8fc7Cluster Map\u83b7\u53d6\u8282\u70b9\u72b6\u6001\u4fe1\u606f\uff0c\u7136\u540e\u5728\u672c\u5730\u8ba1\u7b97\u51faOSD\u4f4d\u7f6e\uff0c\u4e4b\u540e\u76f4\u63a5\u4e0eOSD\u901a\u4fe1\uff0c\u5b8c\u6210\u64cd\u4f5c\u3002\u7531\u6b64\u53ef\u89c1\uff0c\u53ea\u8981\u4fdd\u8bc1Cluster Map\u4e0d\u9891\u7e41\u66f4\u65b0\uff0c\u5219\u5ba2\u6237\u7aef\u5b8c\u5168\u4e0d\u9700\u8981\u67e5\u8868\uff0c\u4e5f\u4e0d\u4f9d\u8d56\u4e8e\u4efb\u4f55\u5143\u6570\u636e\u670d\u52a1\u5668\uff0c\u5c31\u53ef\u4ee5\u8bbf\u95eeOSD\u3002RADOS\u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0cCluster Map\u7684\u66f4\u65b0\u53d6\u51b3\u4e8e\u7cfb\u7edf\u72b6\u6001\u7684\u53d8\u5316\uff0c\u53ea\u6709\u4e24\u79cd\uff1a\nOSD\u51fa\u73b0\u6545\u969c\u3002\nRADOS\u89c4\u6a21\u6269\u5927\u3002\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e24\u79cd\u4e8b\u4ef6\u53d1\u751f\u7684\u9891\u7387\u663e\u7136\u8fdc\u8fdc\u4f4e\u4e8e\u5ba2\u6237\u7aef\u5bf9\u6570\u636e\u8fdb\u884c\u8bbf\u95ee\u7684\u9891\u7387\u3002\n\n\n2. Ceph\u5de5\u4f5c\u539f\u7406\u53ca\u6d41\u7a0b\n2.1 RADOS\u5bf9\u8c61\u5bfb\u5740\nCeph\u5b58\u50a8\u96c6\u7fa4\uff0c\u4eceCeph\u5ba2\u6237\u7aef\u63a5\u6536\u6570\u636e\u5e76\u5b58\u50a8\u4e3a\u5bf9\u8c61\u3002\u5bf9\u8c61\u662f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4e00\u4e2a\u6587\u4ef6\uff0c\u5b58\u50a8\u5728OSD\u4e0a\uff0c\u7531Ceph OSD\u5b88\u62a4\u8fdb\u7a0b\u5904\u7406OSD\u4e0a\u7684\u8bfb/\u5199\u64cd\u4f5c\u3002\u901a\u5e38\u6765\u8bf4\uff0c\u4e00\u5757\u78c1\u76d8\u548c\u8be5\u78c1\u76d8\u5bf9\u5e94\u7684\u5b88\u62a4\u8fdb\u7a0b\u79f0\u4e3a\u4e00\u4e2aOSD\u3002\u4f20\u7edf\u67b6\u6784\u4e2d\uff0c\u5ba2\u6237\u7aef\u4e0e\u4e00\u4e2a\u4e2d\u5fc3\u5316\u7ec4\u4ef6\u901a\u4fe1\uff08\u7f51\u5173\u3001API\u3001\u4e2d\u95f4\u4ef6\u7b49\uff09\uff0c\u53ef\u80fd\u5bfc\u81f4\u5355\u70b9\u6545\u969c\u5e76\u9650\u5236\u4e86\u6027\u80fd\u4e0e\u4f38\u7f29\u6027\u3002Ceph\u6d88\u9664\u4e86\u96c6\u4e2d\u7f51\u5173\uff0c\u5141\u8bb8\u5ba2\u6237\u7aef\u76f4\u63a5\u548cCeph OSD\u5b88\u62a4\u8fdb\u7a0b\u901a\u8baf\u3002\u540c\u65f6Ceph\u4f1a\u81ea\u52a8\u5728\u5176\u4ed6Ceph\u8282\u70b9\u521b\u5efa\u5bf9\u8c61\u526f\u672c\u6765\u786e\u4fdd\u6570\u636e\u5b89\u5168\u548c\u9ad8\u53ef\u7528\u6027\u3002\u6b64\u5916\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u9ad8\u53ef\u7528\u6027\uff0cCeph Monitor\u4e5f\u5b9e\u73b0\u4e86\u96c6\u7fa4\u5316\u3002\u8be5\u529f\u80fd\u57fa\u4e8eCRUSH\u7b97\u6cd5\u3002Ceph\u5bfb\u5740\u6d41\u7a0b\u56fe\nFile\n\n\u7528\u6237\u5b58\u50a8/\u8bbf\u95ee\u7684\u6587\u4ef6\u3002\u7528\u6237\u5b58\u50a8\u6570\u636e\u5230Ceph\u96c6\u7fa4\u65f6\uff0c\u5b58\u50a8\u6570\u636e\u4f1a\u88ab\u5206\u5272\u6210\u591a\u4e2aobject\u3002\nobject\n\nCeph\u5b58\u50a8\u7684\u6700\u5c0f\u5b58\u50a8\u5355\u5143\u3002\u6bcf\u4e2aobject\u90fd\u6709\u4e00\u4e2aobject id\uff0c\u6bcf\u4e2aobject\u7684\u5927\u5c0f\u662f\u53ef\u4ee5\u8bbe\u7f6e\u7684\uff0c\u9ed8\u8ba4\u662f4MB\u3002\nPG\n\nPlacement Group\uff0c\u5bf9object\u7684\u5b58\u50a8\u8fdb\u884c\u7ec4\u7ec7\u548c\u4f4d\u7f6e\u6620\u5c04\u3002PG\u662f\u4e00\u4e2a\u903b\u8f91\u6982\u5ff5\uff0c\u7c7b\u4f3c\u4e8e\u6570\u636e\u5e93\u4e2d\u7684\u7d22\u5f15\u8868\uff0c\u5b83\u7684\u6570\u91cf\u662f\u56fa\u5b9a\u7684\uff0c\u4e0d\u4f1a\u968f\u7740OSD\u589e\u52a0\u6216\u51cf\u5c11\u800c\u6539\u53d8\u3002\u6bcf\u4e2aobject\u6700\u540e\u90fd\u4f1a\u901a\u8fc7CRUSH\u8ba1\u7b97\u6620\u5c04\u5230\u67d0\u4e2aPG\u4e2d\uff0c\u4e00\u4e2aPG\u53ef\u4ee5\u5305\u542b\u591a\u4e2aobject\u3002\u800cPG\u548cOSD\u4e4b\u95f4\u5219\u662f\u201c\u591a\u5bf9\u591a\u201d\u7684\u6620\u5c04\u5173\u7cfb\u3002\u8fdb\u884c\u6570\u636e\u8fc1\u79fb\u65f6\uff0cCeph\u4f1a\u4ee5PG\u4e3a\u5355\u4f4d\u8fdb\u884c\u8fc1\u79fb\uff0c\u4e0d\u4f1a\u76f4\u63a5\u64cd\u4f5c\u5bf9\u8c61\u3002PG\u5b58\u5728\u7684\u610f\u4e49\u662f\u63d0\u9ad8ceph\u5b58\u50a8\u7cfb\u7edf\u7684\u6027\u80fd\u548c\u6269\u5c55\u6027\u3002\nPG\u662f\u4e00\u79cd\u95f4\u5740\uff0cPG\u7684\u6570\u91cf\u6709\u9650\uff0c\u8bb0\u5f55PG\u8ddfOSD\u95f4\u7684\u6620\u5c04\u5173\u7cfb\u53ef\u884c\uff0c\u800c\u8bb0\u5f55object\u5230OSD\u4e4b\u95f4\u7684\u6620\u5c04\u56e0\u4e3a\u6570\u91cf\u5de8\u5927\u800c\u5b9e\u9645\u4e0d\u53ef\u884c\u6216\u6548\u7387\u592a\u4f4e\u3002\u4ece\u7528\u9014\u6765\u8bf4\uff0c\u641e\u4e2a\u6620\u5c04\u672c\u8eab\u4e0d\u662f\u76ee\u7684\uff0c\u8ba9\u6545\u969c\u6216\u8005\u8d1f\u8f7d\u5747\u8861\u53d8\u5f97\u53ef\u64cd\u4f5c\u662f\u76ee\u7684\u3002\n\nOSD\n\nObject Storage Device\uff0cPG\u901a\u8fc7CRUSH\u7b97\u6cd5\u6620\u5c04\u5230OSD\u4e2d\u5b58\u50a8\u3002\u5982\u679c\u662f\u4e8c\u526f\u672c\u7684\uff0c\u5219\u6bcf\u4e2aPG\u90fd\u4f1a\u6620\u5c04\u5230\u4e8c\u4e2aosd\uff0c\u6bd4\u5982[osd.1,osd.2]\uff0c\u90a3\u4e48osd.1\u662f\u5b58\u653e\u8be5PG\u7684\u4e3b\u526f\u672c\uff0cosd.2\u662f\u5b58\u653e\u8be5PG\u7684\u4ece\u526f\u672c\uff0c\u4fdd\u8bc1\u4e86\u6570\u636e\u7684\u5197\u4f59\u3002\u6d41\u7a0b\u7ed3\u6784\n\u5c06file\u5207\u7247\u4e3a\u591a\u4e2aobject\uff0c\u6bcf\u4e2aobject\u6709\u4e00\u4e2aoid\u3002\n\n\n\u5207\u5272\u89c4\u5219\u672c\u8d28\u4e0a\u5c31\u662f\u6309\u7167object\u7684\u5927\u5c0f\u6765\u5207file\uff0c\u4f18\u70b9\uff1a\nobject\u5927\u5c0f\u4e00\u81f4\u4fbf\u4e8eRADOS\u9ad8\u6548\u7ba1\u7406\nfile\u7684\u4e32\u884c\u5904\u7406\u53d8\u6210object\u7684\u5e76\u884c\u5904\u7406\n\n\n\noid = ino (identity number) + ono (object number)\uff0cino\u662ffile\u7684id\uff0cono\u662fobject\u7684id\uff0c\u524d\u8005\u7528\u4e8e\u6587\u4ef6\u5b9a\u4f4d\uff0c\u540e\u8005\u7528\u4e8e\u6587\u4ef6\u5207\u7247\u4f4d\u7f6e\u7684\u5b9a\u4f4d\u3002\n\n\u4e00\u4e2a\u6216\u591a\u4e2aobject\u6620\u5c04\u5230PG\u4e2d\uff0c\u6620\u5c04\u89c4\u5219\uff1aoid = hash(oid) % m\n\n\nceph\u5229\u7528\u9759\u6001hash\u51fd\u6570\u5c06oid\u96c6\u5408\u6620\u5c04\u4e3a\u8fd1\u4f3c\u5747\u5300\u5206\u5e03\u7684\u4f2a\u968f\u673a\u503c\u96c6\u5408\uff0c\u5e76\u4e14\u96c6\u5408\u4e2d\u6bcf\u4e2aoid\u90fd\u4e0ePG\u7684\u6570\u91cf\u53bb\u6a21\u5f97\u5230PG\u5e8f\u53f7 (PGid)\u3002PG\u7684\u6570\u91cf\u591a\u5be1\u76f4\u63a5\u51b3\u5b9a\u4e86\u6570\u636e\u5206\u5e03\u7684\u5747\u5300\u6027\uff0c\u6240\u4ee5\u5408\u7406\u8bbe\u7f6e\u7684PG\u6570\u91cf\u53ef\u4ee5\u5f88\u597d\u7684\u63d0\u5347CEPH\u96c6\u7fa4\u7684\u6027\u80fd\u5e76\u4f7f\u6570\u636e\u5747\u5300\u5206\u5e03\u3002\nhash\u5b8c\u6210\u5747\u5300\u5206\u5e03\n\u53d6\u6a21\u968f\u673a\u9009\u53d6\n\n\u56e0\u4e3a\u53ea\u6709\u5927\u91cfobject\u548cPG\uff0c\u8fd9\u79cd\u4f2a\u968f\u673a\u5173\u7cfb\u7684\u8fd1\u4f3c\u5747\u5300\u624d\u80fd\u6210\u7acb\uff0c\u6545\u8981\u6ce8\u610f\u4e24\u70b9\uff1a\nobject\u7684size\u8981\u5408\u7406\u914d\u7f6e\uff0c\u4f7f\u5f97file\u80fd\u88ab\u5207\u5206\u6210\u8db3\u591f\u591a\u7684object\nPG\u6570\u91cf\u5e94\u8be5\u4e3aOSD\u603b\u6570\u7684\u6570\u767e\u500d\uff0c\u624d\u80fd\u4fdd\u8bc1\u6709\u8db3\u591f\u6570\u91cf\u7684PG\u63d0\u4f9b\u6620\u5c04\u3002\n\n\n\n\u4e00\u4e2aPG\u6620\u5c04\u5230n\u4e2aOSD\u4e2d\uff08\u79f0\u4e3an\u526f\u672c\uff0c\u5e38\u75283\u526f\u672c\uff09\uff0cPGid\u901a\u8fc7CRUSH\u8ba1\u7b97\uff0c\u5f97\u5230n\u4e2aOSD\uff0c\u5176\u4e0a\u8fd0\u884c\u7684OSD deamon\u8d1f\u8d23\u6267\u884c\u6620\u5c04\u5230\u672c\u5730\u7684object\u5728\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u5b58\u50a8\u3001\u8bbf\u95ee\u3001\u5143\u6570\u636e\u7ef4\u62a4\u7b49\u64cd\u4f5c\u3002\n\n2.2 \u6570\u636e\u7684\u64cd\u4f5c\u6d41\u7a0b\n\u6a21\u62dffile\u7684\u5199\u5165\u6d41\u7a0b\uff0c\u4e3a\u4fbf\u4e8e\u7406\u89e3\u5148\u5047\u8bbe\u5982\u4e0b\u524d\u63d0\uff1a\nfile\u8f83\u5c0f\uff0c\u65e0\u9700\u5207\u5206\uff0c\u6545\u88ab\u6620\u5c04\u5230\u4e00\u4e2aobject\u4e0a\n\u4e09\u526f\u672c\u60c5\u51b5\n\nfile\u5199\u5165\u6d41\u7a0b\u6d41\u7a0b\u63cf\u8ff0\n\u672c\u5730RADOS\u5bf9\u8c61\u5bfb\u5740\uff0c\u5f97\u5230OSDs\u7684id\n\nclient\u5411ceph\u96c6\u7fa4\u5199\u5165file\u65f6\uff0c\u5148\u5728\u672c\u5730\u8fdb\u884cRADOS\u5bf9\u8c61\u5bfb\u5740\uff0c\u5c06file\u8f6c\u4e3aobject\uff0c\u5e76\u5f97\u5230\u4e00\u7ec4\u76843\u4e2aOSDid\uff0c\u6309\u7167\u5e8f\u53f7\u5927\u5c0f\uff0c\u5206\u522b\u4e3aPrimary OSD, Secondary OSD, Tertiary OSD\u3002\n\u53d1\u8d77\u5199\u5165\u64cd\u4f5c\n\nclient\u76f4\u63a5\u4e0ePrimary OSD\u901a\u4fe1\uff0c\u53d1\u8d77\u5199\u5165\u64cd\u4f5c\uff0cPrimary OSD\u63a5\u6536\u5230\u4e4b\u540e\uff0c\u5e76\u4e0d\u7acb\u5373\u6267\u884c\u5199\u5165\u64cd\u4f5c\uff0c\u800c\u5148\u5411Secondary OSD, Tertiary OSD\u53d1\u8d77\u5199\u5165\u64cd\u4f5c\uff0c\u7b49\u5f85\u786e\u8ba4\u4fe1\u606f\u3002\n\u56de\u590d\u786e\u8ba4\u4fe1\u606f\n\nSecondary OSD\u548cTertiary OSD\u5b8c\u6210\u5199\u5165\u64cd\u4f5c\u540e\uff0c\u56de\u590dPrimary OSD\u786e\u8ba4\u4fe1\u606f\uff0cPrimary OSD\u624d\u6267\u884c\u5199\u5165\u64cd\u4f5c\uff0c\u5e76\u56de\u590dclient\u786e\u8ba4\u4fe1\u606f\uff0c\u81f3\u6b64\u5b8c\u6210\u5199\u5165\u64cd\u4f5c\u3002\n\u7b49\u5f85\u786e\u8ba4\u4fe1\u606f\u7684\u8fc7\u7a0b\u4f1a\u6709\u8f83\u5927\u7684\u5ef6\u65f6\uff0c\u56e0\u6b64\uff0cceph\u53ef\u4ee5\u5206\u4e24\u6b21\u5411client\u56de\u590d\u786e\u8ba4\u4fe1\u606f\u3002\n\u7b2c\u4e00\u6b21\uff0c\u6570\u636e\u5199\u5165OSD\u5185\u5b58\u7f13\u51b2\u533a\u65f6\uff0c\u56de\u590dclient\u3002\u6b64\u65f6client\u53ef\u7ee7\u7eed\u6267\u884c\u64cd\u4f5c\u3002\n\u7b2c\u4e8c\u6b21\uff0c\u6570\u636e\u4ece\u7f13\u5b58\u5199\u5165\u786c\u76d8\u540e\uff0c\u518d\u56de\u590dclient\u3002\u6b64\u65f6client\u53ef\u6839\u636e\u9700\u8981\u5220\u9664\u672c\u5730\u6570\u636e\uff0c\u4ece\u800c\u5b8c\u6210\u5199\u5165\u64cd\u4f5c\u3002\n\n\n\u4ece\u4e0a\u8ff0\u6d41\u7a0b\u53ef\u4ee5\u770b\u5230\uff0cclient\u5bfb\u5740\u76f4\u63a5\u5728\u672c\u5730\u5b8c\u6210\uff0c\u65e0\u9700\u4e2d\u5fc3\u5316\u7ec4\u4ef6\u3002\u6545client\u4e0eOSD\u4e4b\u95f4\u53ef\u4ee5\u591a\u5bf9\u591a\u5e76\u884c\u901a\u4fe1\uff0c\u6ee1\u8db3\u4e86\u5206\u5e03\u5f0f\u7684\u8981\u6c42\u3002\u5e76\u4e14\uff0cOSD\u5728\u5404\u4e2aPG\u4e2d\u53ef\u80fd\u62c5\u4efb\u7684\u89d2\u8272\u4e0d\u540c\uff0c\u4ece\u800c\u5c3d\u6700\u5927\u53ef\u80fd\u5747\u5206\u4e86\u5de5\u4f5c\u8d1f\u62c5\uff0c\u907f\u514d\u5355\u4e2aOSD\u7684\u6027\u80fd\u95ee\u9898\u9020\u6210\u7cfb\u7edf\u7684\u6027\u80fd\u74f6\u9888\u3002\u8bfb\u53d6\u6570\u636e\u540c\u7406\uff0cclient\u76f4\u63a5\u548cPrimary OSD\u901a\u4fe1\uff0c\u6700\u7ec8\u7531Primary OSD\u8fd4\u56de\u8bfb\u6570\u636e\u3002\nQ&amp;A\uff1a\n\u8bfb\u6570\u636e\u662f\u5426\u53ef\u4ee5\u4ece\u4efb\u610f\u4eceOSD\u8bfb\u53d6\u800c\u975e\u4ec5\u4ec5\u4ece\u4e3bOSD\u8bfb\u53d6\uff1f\n\u6216\u8005\u662f\u5426\u53ef\u4ee5\u4ecen\u4e2aOSD\u5e76\u884c\u8bfb\u53d6\u5462\uff1f\u4ece\u800c\u63d0\u9ad8\u5e26\u5bbd\u5229\u7528\u7387\u3002\n\n\n2.3 \u96c6\u7fa4\u7ef4\u62a4\n\u82e5\u5e72Monitor\u5171\u540c\u8d1f\u8d23\u4e86Ceph\u96c6\u7fa4\u6240\u6709OSD\u72b6\u6001\u7684\u53d1\u73b0\u4e0e\u8bb0\u5f55\uff0c\u5e76\u5f62\u6210Cluster Map\uff0c\u5e76\u5206\u53d1\u5230\u5404\u4e2aOSD\u548cclient\u4e2d\u3002OSD\u5229\u7528Cluster Map\u8fdb\u884c\u6570\u636e\u7684\u7ef4\u62a4\uff0cclient\u5229\u7528Cluster Map\u8fdb\u884c\u5bfb\u5740\u64cd\u4f5c\u3002Monitor\u4e4b\u95f4\u4e3a\u4e3b\u4ece\u5907\u4efd\u5173\u7cfb\uff0cMonitor\u5e76\u4e0d\u4e3b\u52a8\u8f6e\u8be2OSD\uff08\u8fd9\u6837\u505a\u65f6\u95f4\u5f00\u9500\u592a\u5927\uff09\uff0c\u800c\u662fOSD\u4e3b\u52a8\u4e0a\u62a5\u72b6\u6001\u4fe1\u606f\u3002Monitor\u6536\u5230\u4fe1\u606f\u540e\u66f4\u65b0Cluster Map\u3002\u89e6\u53d1\u6761\u4ef6\u6709\uff1a\n\u65b0OSD\u52a0\u5165\u96c6\u7fa4\n\u67d0\u4e2aOSD\u53d1\u73b0\u81ea\u8eab\n\u5176\u4ed6OSD\u51fa\u73b0\u5f02\u5e38\n\nCluster Map\u7684\u7ec4\u6210\nMonitor Map\n\n\u5305\u542b\u96c6\u7fa4\u7684 fsid \u3001\u4f4d\u7f6e\u3001\u540d\u5b57\u3001\u5730\u5740\u548c\u7aef\u53e3\uff0c\u4e5f\u5305\u62ec\u5f53\u524d\u7248\u672c\u3001\u521b\u5efa\u65f6\u95f4\u3001\u6700\u8fd1\u4fee\u6539\u65f6\u95f4\u3002\u8981\u67e5\u770b\u76d1\u89c6\u5668\u56fe\uff0c\u7528 ceph mon dump \u547d\u4ee4\u3002\nOSD Map\n\n\u5305\u542b\u96c6\u7fa4 fsid \u3001\u521b\u5efa\u65f6\u95f4\u3001\u6700\u8fd1\u4fee\u6539\u65f6\u95f4\u3001\u5b58\u50a8\u6c60\u5217\u8868\u3001\u526f\u672c\u6570\u91cf\u3001\u5f52\u7f6e\u7ec4\u6570\u91cf\u3001 OSD \u5217\u8868\u53ca\u5176\u72b6\u6001\uff08\u5982 up \u3001 in \uff09\u3002\u8981\u67e5\u770bOSD\u8fd0\u884c\u56fe\uff0c\u7528 ceph osd dump \u547d\u4ee4\u3002OSD\u72b6\u6001\u7684\u63cf\u8ff0\u5206\u4e3a\u4e24\u4e2a\u7ef4\u5ea6\uff1aup\u6216\u8005down\uff08\u8868\u660eOSD\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\uff09\uff0cin\u6216\u8005out\uff08\u8868\u660eOSD\u662f\u5426\u627f\u8f7dPG\uff09\u3002\u56e0\u6b64\uff0c\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2aOSD\uff0c\u5171\u6709\u56db\u79cd\u53ef\u80fd\u7684\u72b6\u6001\uff1a\u2014\u2014 Up\u4e14in\uff1a\u8bf4\u660e\u8be5OSD\u6b63\u5e38\u8fd0\u884c\uff0c\u4e14\u5df2\u7ecf\u627f\u8f7d\u81f3\u5c11\u4e00\u4e2aPG\u7684\u6570\u636e\u3002\u8fd9\u662f\u4e00\u4e2aOSD\u7684\u6807\u51c6\u5de5\u4f5c\u72b6\u6001\uff1b\u2014\u2014 Up\u4e14out\uff1a\u8bf4\u660e\u8be5OSD\u6b63\u5e38\u8fd0\u884c\uff0c\u4f46\u5e76\u672a\u627f\u8f7d\u4efb\u4f55PG\uff0c\u5176\u4e2d\u4e5f\u6ca1\u6709\u6570\u636e\u3002\u4e00\u4e2a\u65b0\u7684OSD\u521a\u521a\u88ab\u52a0\u5165Ceph\u96c6\u7fa4\u540e\uff0c\u4fbf\u4f1a\u5904\u4e8e\u8fd9\u4e00\u72b6\u6001\u3002\u800c\u4e00\u4e2a\u51fa\u73b0\u6545\u969c\u7684OSD\u88ab\u4fee\u590d\u540e\uff0c\u91cd\u65b0\u52a0\u5165Ceph\u96c6\u7fa4\u65f6\uff0c\u4e5f\u662f\u5904\u4e8e\u8fd9\u4e00\u72b6\u6001\uff1b\u2014\u2014 Down\u4e14in\uff1a\u8bf4\u660e\u8be5OSD\u53d1\u751f\u5f02\u5e38\uff0c\u4f46\u4ecd\u7136\u627f\u8f7d\u7740\u81f3\u5c11\u4e00\u4e2aPG\uff0c\u5176\u4e2d\u4ecd\u7136\u5b58\u50a8\u7740\u6570\u636e\u3002\u8fd9\u79cd\u72b6\u6001\u4e0b\u7684OSD\u521a\u521a\u88ab\u53d1\u73b0\u5b58\u5728\u5f02\u5e38\uff0c\u53ef\u80fd\u4ecd\u80fd\u6062\u590d\u6b63\u5e38\uff0c\u4e5f\u53ef\u80fd\u4f1a\u5f7b\u5e95\u65e0\u6cd5\u5de5\u4f5c\uff1b\u2014\u2014 Down\u4e14out\uff1a\u8bf4\u660e\u8be5OSD\u5df2\u7ecf\u5f7b\u5e95\u53d1\u751f\u6545\u969c\uff0c\u4e14\u5df2\u7ecf\u4e0d\u518d\u627f\u8f7d\u4efb\u4f55PG\u3002\nPG Map\n\n\u5305\u542b\u5f52\u7f6e\u7ec4\u7248\u672c\u3001\u5176\u65f6\u95f4\u6233\u3001\u6700\u65b0\u7684 OSD \u8fd0\u884c\u56fe\u7248\u672c\u3001\u5360\u6ee1\u7387\u3001\u4ee5\u53ca\u5404\u5f52\u7f6e\u7ec4\u8be6\u60c5\uff0c\u50cf\u5f52\u7f6e\u7ec4 ID \u3001 up set \u3001 acting set \u3001 PG \u72b6\u6001\uff08\u5982 active+clean \uff09\uff0c\u548c\u5404\u5b58\u50a8\u6c60\u7684\u6570\u636e\u4f7f\u7528\u60c5\u51b5\u7edf\u8ba1\u3002\nCRUSH Map\n\n\u5305\u542b\u5b58\u50a8\u8bbe\u5907\u5217\u8868\u3001\u6545\u969c\u57df\u6811\u72b6\u7ed3\u6784\uff08\u5982\u8bbe\u5907\u3001\u4e3b\u673a\u3001\u673a\u67b6\u3001\u884c\u3001\u623f\u95f4\u3001\u7b49\u7b49\uff09\u3001\u548c\u5b58\u50a8\u6570\u636e\u65f6\u5982\u4f55\u5229\u7528\u6b64\u6811\u72b6\u7ed3\u6784\u7684\u89c4\u5219\u3002\u8981\u67e5\u770b CRUSH \u89c4\u5219\uff0c\u6267\u884c ceph osd getcrushmap -o {filename} \u547d\u4ee4\uff1b\u7136\u540e\u7528 crushtool -d {comp-crushmap-filename} -o {decomp-crushmap-filename} \u53cd\u7f16\u8bd1\uff1b\u7136\u540e\u5c31\u53ef\u4ee5\u7528 cat \u6216\u7f16\u8f91\u5668\u67e5\u770b\u4e86\u3002\nMDS Map\n\n\u5305\u542b\u5f53\u524d MDS \u56fe\u7684\u7248\u672c\u3001\u521b\u5efa\u65f6\u95f4\u3001\u6700\u8fd1\u4fee\u6539\u65f6\u95f4\uff0c\u8fd8\u5305\u542b\u4e86\u5b58\u50a8\u5143\u6570\u636e\u7684\u5b58\u50a8\u6c60\u3001\u5143\u6570\u636e\u670d\u52a1\u5668\u5217\u8868\u3001\u8fd8\u6709\u54ea\u4e9b\u5143\u6570\u636e\u670d\u52a1\u5668\u662f up \u4e14 in \u7684\u3002\u8981\u67e5\u770b MDS \u56fe\uff0c\u6267\u884c ceph mds dump \u30022.4 \u589e\u52a0OSD\u6d41\u7a0b\n\n\u65b0OSD\u4e0a\u7ebf\u540e\uff0c\u5982\u679cPG\u5904\u4e8e\u6b63\u5e38\u72b6\u6001\uff0c\u5219\u65b0OSD\u9996\u5148\u6839\u636e\u914d\u7f6e\u4fe1\u606f\u4e0emonitor\u901a\u4fe1\u3002Monitor\u5c06\u5176\u52a0\u5165cluster map\uff0c\u5e76\u8bbe\u7f6e\u4e3aup\u4e14out\u72b6\u6001\uff0c\u518d\u5c06\u6700\u65b0\u7248\u672c\u7684cluster map\u53d1\u7ed9\u8fd9\u4e2a\u65b0OSD\u3002\u6536\u5230monitor\u53d1\u6765\u7684cluster map\u4e4b\u540e\uff0c\u8fd9\u4e2a\u65b0OSD\u8ba1\u7b97\u51fa\u81ea\u5df1\u6240\u627f\u8f7d\u7684PG\uff08\u4e3a\u7b80\u5316\u8ba8\u8bba\uff0c\u6b64\u5904\u6211\u4eec\u5047\u5b9a\u8fd9\u4e2a\u65b0\u7684OSD\u5f00\u59cb\u53ea\u627f\u8f7d\u4e00\u4e2aPG\uff09\uff0c\u4ee5\u53ca\u548c\u81ea\u5df1\u627f\u8f7d\u540c\u4e00\u4e2aPG\u7684\u5176\u4ed6OSD\u3002\u7136\u540e\uff0c\u65b0OSD\u5c06\u4e0e\u8fd9\u4e9bOSD\u53d6\u5f97\u8054\u7cfb\u3002\u5982\u56fe\uff1a\n\nPG\u5904\u4e8e\u6b63\u5e38\u72b6\u6001\uff0cOSD\u672a\u542f\u7528\n\u65b0OSD\u4e0a\u7ebf\u540e\uff0c\u5982\u679cPG\u5904\u4e8e\u964d\u7ea7\u72b6\u6001\uff08\u5373\u627f\u8f7d\u8be5PG\u7684OSD\u4e2a\u6570\u5c11\u4e8e\u6b63\u5e38\u503c\uff0c\u5982\u6b63\u5e38\u5e94\u8be5\u662f3\u4e2a\uff0c\u6b64\u65f6\u53ea\u67092\u4e2a\u62161\u4e2a\u3002\u8fd9\u79cd\u60c5\u51b5\u901a\u5e38\u662fOSD\u6545\u969c\u6240\u81f4\uff09\uff0c\u5219\u5176\u4ed6OSD\u5c06\u628a\u8fd9\u4e2aPG\u5185\u7684\u6240\u6709\u5bf9\u8c61\u548c\u5143\u6570\u636e\u590d\u5236\u7ed9\u65b0OSD\u3002\u6570\u636e\u590d\u5236\u5b8c\u6210\u540e\uff0c\u65b0OSD\u88ab\u7f6e\u4e3aup\u4e14in\u72b6\u6001\u3002\u800ccluster map\u5185\u5bb9\u4e5f\u5c06\u636e\u6b64\u66f4\u65b0\u3002\u8fd9\u4e8b\u5b9e\u4e0a\u662f\u4e00\u4e2a\u81ea\u52a8\u5316\u7684failure recovery\u8fc7\u7a0b\u3002\u5f53\u7136\uff0c\u5373\u4fbf\u6ca1\u6709\u65b0\u7684OSD\u52a0\u5165\uff0c\u964d\u7ea7\u7684PG\u4e5f\u5c06\u8ba1\u7b97\u51fa\u5176\u4ed6OSD\u5b9e\u73b0failure recovery\uff0c\u5982\u56fe\uff1a\n\nPG\u5904\u4e8e\u964d\u7ea7\u72b6\u6001\u65f6\n\u5982\u679c\u8be5PG\u76ee\u524d\u4e00\u5207\u6b63\u5e38\uff0c\u5219\u8fd9\u4e2a\u65b0OSD\u5c06\u66ff\u6362\u6389\u73b0\u6709OSD\u4e2d\u7684\u4e00\u4e2a\uff08PG\u5185\u5c06\u91cd\u65b0\u9009\u51faPrimary OSD\uff09\uff0c\u5e76\u627f\u62c5\u5176\u6570\u636e\u3002\u5728\u6570\u636e\u590d\u5236\u5b8c\u6210\u540e\uff0c\u65b0OSD\u88ab\u7f6e\u4e3aup\u4e14in\u72b6\u6001\uff0c\u800c\u88ab\u66ff\u6362\u7684OSD\u5c06\u9000\u51fa\u8be5PG\uff08\u4f46\u72b6\u6001\u901a\u5e38\u4ecd\u7136\u4e3aup\u4e14in\uff0c\u56e0\u4e3a\u8fd8\u8981\u627f\u8f7d\u5176\u4ed6PG\uff09\u3002\u800ccluster map\u5185\u5bb9\u4e5f\u5c06\u636e\u6b64\u66f4\u65b0\u3002\u8fd9\u4e8b\u5b9e\u4e0a\u662f\u4e00\u4e2a\u81ea\u52a8\u5316\u7684\u6570\u636ere-balancing\u8fc7\u7a0b\uff0c\u5982\u56fe\uff1a\n\nPG\u5904\u4e8e\u6b63\u5e38\u72b6\u6001\uff0c\u65b0\u65e7OSD\u66f4\u6362\n3. Ceph (Luminous)\u96c6\u7fa4\u521b\u5efa\n\u4e00\u4e2aCeph\u96c6\u7fa4\u81f3\u5c11\u9700\u89813\u4e2aOSD\u624d\u80fd\u5b9e\u73b0\u5197\u4f59\u548c\u9ad8\u53ef\u7528\u6027\uff0c\u5e76\u4e14\u81f3\u5c11\u9700\u8981\u4e00\u4e2amon\u548c\u4e00\u4e2amds\u3002\u5176\u4e2dmon\u548cmds\u53ef\u4ee5\u90e8\u7f72\u5728\u5176\u4e2d\u4e00\u4e2aosd\u8282\u70b9\u4e0a\uff0c\u8be6\u7ec6\u53ef\u53c2\u8003\u5b98\u65b9\u5b89\u88c5\u6587\u6863\u30023.1 \u670d\u52a1\u5668\u521d\u59cb\u5316\n\u4e0d\u8981\u7528CentOS 8\uff01\uff01\uff01\u4e0d\u8981\u7528CentOS 8\uff01\uff01\uff01\u4e0d\u8981\u7528CentOS 8\uff01\uff01\uff01\u4e0d\u8981\u95ee\u6211\u600e\u4e48\u77e5\u9053\u7684\uff0c\u5168\u662f\u6cea\u2026\u2026\u5b98\u65b9\u6587\u6863\u7ed9\u51fa\u4e86\u5efa\u8bae\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e0d\u770b\u5b98\u65b9\u6587\u6863\u7684\u540e\u679c\u5c31\u662f\u2026\u5410\u8840\u672c\u6765\u60f3\u7528\u865a\u62df\u673a\u7684\uff0c\u540e\u6765\u60f3\u5230\u6211\u5728Vultr\u4e0a\u8fd8\u6709100$\u8d60\u9001\u5238\u6ca1\u7528\uff0c\u7d22\u6027\u76f4\u63a5\u7528VPS\u6765\u5b9e\u73b0\u4e86\u3002\u7ed3\u679cVultr\u7ed9\u6211\u57cb\u4e86\u4e2a\u5751\uff01\u5382\u5546\u521d\u59cb\u5316\u7684\u7cfb\u7edf\uff0c\u53ea\u6709\u4e00\u4e2avda\u78c1\u76d8\uff0c\u4e14\u6240\u6709\u7684\u5bb9\u91cf\u90fd\u6302\u8f7d\u6839\u5206\u533a\u4e86\u3002\u800cCeph\u9700\u8981\u4e00\u4e2a\u683c\u5f0f\u4e3axfs\u7684\u5355\u72ec\u5206\u533a\uff0c\u641c\u4e86\u4e0blinux\u7f29\u5c0f\u6839\u5206\u533a\u8981\u8fdbrescue\u6a21\u5f0f\uff0cVPS\u53c8\u4e0d\u597d\u5f04\u2026\u89e3\u94c3\u8fd8\u987b\u7cfb\u94c3\u4eba\uff0c\u641c\u4e86\u534a\u5929\uff0c\u6700\u7ec8\u627e\u5230\u89e3\u51b3\u529e\u6cd5\u4e86\u3002\u5c31\u662f\u4f7f\u7528VPS\u5382\u5546\u63d0\u4f9b\u7684Block Storage\u529f\u80fd\u6765\u6269\u5c55\u51fa\u4e00\u4e2a\u5206\u533a\u3002\u4e0d\u8fc7\u6700\u86cb\u75bc\u7684\u662f\u8fd9\u4e2a\u529f\u80fd\u652f\u6301\u7ebd\u7ea6\u673a\u623f\u7684VPS\uff0c\u4e4b\u524d\u641e\u4e86\u534a\u5929\u897f\u96c5\u56fe\u7684\u673a\u623f\uff0c\u53c8\u5f97\u91cd\u6765...\u88c2\u5f00\u4e86\u6269\u5c55\u597d\u5206\u533a\u4e4b\u540e\uff0c\u786c\u76d8\u60c5\u51b5\u5982\u4e0b\uff1a\u786c\u76d8\u5206\u533a\u60c5\u51b5\u5404\u4e2a\u8282\u70b9\u914d\u7f6e\u5982\u4e0b\uff1a\n\n\n  \u4e3b\u673a\u540d\n  \u7cfb\u7edf\n  IP\n  \u6570\u636e\u78c1\u76d8\n  \u5907\u6ce8\n\n\n\n\n  ceph-client\n  CentOS 7 X64\n  140.82.15.88\n  25G\n  client\n\n\n  ceph-node1\n  CentOS 7 X64\n  104.207.133.105\n  25G\n  mgr.mon.osd.0\n\n\n  ceph-node2\n  CentOS 7 X64\n  45.63.5.140\n  25G\n  osd.1\n\n\n  ceph-node3\n  CentOS 7 X64\n  149.28.40.16\n  25G\n  osd.2\n\n\n\n\nmgr\uff1a\u7ba1\u7406\u8282\u70b9mon\uff1a\u76d1\u63a7\u8282\u70b9osd\uff1a\u5b58\u50a8\u8282\u70b9Ceph\u96c6\u7fa4\u8981\u6c42\u5fc5\u987b\u662f\u5947\u6570\u4e2amon\u76d1\u63a7\u8282\u70b9\uff0c\u4e00\u822c\u5efa\u8bae\u81f3\u5c11\u662f3\u4e2aCeph\u7684\u6587\u4ef6\u7cfb\u7edf\u4f5c\u4e3a\u4e00\u4e2a\u76ee\u5f55\u6302\u8f7d\u5230\u5ba2\u6237\u7aefcephclient\u7684/cephfs\u76ee\u5f55\u4e0b\uff0c\u53ef\u4ee5\u50cf\u64cd\u4f5c\u666e\u901a\u76ee\u5f55\u4e00\u6837\u5bf9\u6b64\u76ee\u5f55\u8fdb\u884c\u64cd\u4f5c\u3002\n3.2 \u73af\u5883\u51c6\u5907\nok\uff0c\u8bdd\u4e0d\u591a\u8bf4\uff0c\u5148\u628a\u73af\u5883\u914d\u597d\u3002(1) \u4fee\u6539hostname\u5e76\u7ed1\u5b9a\u4e3b\u673a\u540d\u6620\u5c04\n\u8fd9\u4e00\u6b65\u662f\u4e3a\u4e86\u7edf\u4e00\u540d\u79f0\uff0c\u65b9\u4fbf\u540e\u9762\u547d\u4ee4\u64cd\u4f5c\u4f7f\u7528\u7684\u3002\u57284\u4e2a\u4e3b\u673a\u4e0a\u4fee\u6539hostname[root@ceph1 ~]# hostnamectl set-hostname ceph-client\n[root@ceph2 ~]# hostnamectl set-hostname ceph-node1\n[root@ceph3 ~]# hostnamectl set-hostname ceph-node2\n[root@ceph4 ~]# hostnamectl set-hostname ceph-node3\n\n\n\u5982\u679c\u4f7f\u7528ssh\u767b\u9646\u7684\u8fdc\u7a0bVPS\uff0c\u8bbe\u7f6e\u4e4b\u540e\u53ef\u80fd\u6ca1\u6709\u5237\u65b0hostname\uff0cexit\u9000\u51fa\u91cd\u65b0\u767b\u9646\u5373\u53ef\n\u57283\u4e2a\u8282\u70b9\u673a\u4e0a\u6dfb\u52a0hosts[root@ceph-node1 ~]# vi /etc/hosts\n\n104.207.133.105 ceph-node1\n45.63.5.140 ceph-node2\n149.28.40.16 ceph-node3\n\n\u8fde\u901a\u6027\u6d4b\u8bd5[root@ceph-client ~]# ping -c 2 ceph-node1\n[root@ceph-client ~]# ping -c 2 ceph-node2\n[root@ceph-client ~]# ping -c 2 ceph-node3\n\n\u8fde\u901a\u6027\u6d4b\u8bd5\u6210\u529f\u53e6\u59162\u4e2a\u8282\u70b9\u673a\u540c\u7406\u6267\u884c\u5982\u4e0a\u64cd\u4f5c(2) \u521b\u5efaceph\u7528\u6237\n\u6211\u4eec\u4e00\u822c\u4e0d\u4f1a\u518droot\u4e0b\u5de5\u4f5c\uff0c\u6240\u4ee5\u521b\u5efa\u4e00\u4e2aceph\u7528\u6237\u6765\u4f7f\u7528\u3002\u57283\u4e2a\u8282\u70b9\u673a\u4e0a\u521b\u5efa\u7528\u6237ceph\uff0c\u5bc6\u7801\u7edf\u4e00\u4e3aceph[root@ceph-node1 ~]# adduser ceph &amp;&amp; echo &quot;ceph:ceph&quot;|chpasswd\n\n\u4e3a\u6bcf\u4e2aceph\u8282\u70b9\u7528\u6237\u589e\u52a0root\u6743\u9650[root@ceph-node1 ~]# echo &quot;ceph ALL = (root) NOPASSWD:ALL&quot; | sudo tee /etc/sudoers.d/ceph &amp;&amp; chmod 0440 /etc/sudoers.d/ceph\n\n\u6d4b\u8bd5root\u6743\u9650\uff0cexit\u9000\u56de\u5207\u6362\u524d\u7528\u6237[root@ceph-node1 ~]# su - ceph \n[ceph@ceph-node1 ~]# sudo su -\n\n(3) \u5b89\u88c5NTP\n\u5efa\u8bae3\u4e2a\u8282\u70b9\u673a\u5b89\u88c5NTP\uff0c\u4ee5\u514d\u56e0\u65f6\u949f\u6f02\u79fb\u5bfc\u81f4\u6545\u969c\uff08mon\u8282\u70b9\u5fc5\u987b\uff09[root@ceph-node1 ~]# yum install ntp ntpdate ntp-doc -y \n[root@ceph-node1 ~]# systemctl restart ntpd\n[root@ceph-node1 ~]# systemctl status ntpd\n\n(4) \u5173\u95ed\u9632\u706b\u5899\u548cSelinux\n\u4fdd\u8bc1\u5404\u4e2a\u8282\u70b9\u4e4b\u95f4\u7684\u8054\u901a\uff0c\u5728\u5f00\u53d1\u9636\u6bb5\u5b8c\u5168\u53ef\u4ee5\u5173\u95ed\u9632\u706b\u5899\uff0c\u4e4b\u540e\u518d\u91cd\u65b0\u6253\u5f00\u914d\u7f6e\u3002SELinux\u662f\u4e00\u79cd\u57fa\u4e8e \u57df-\u7c7b\u578b \u6a21\u578b\uff08domain-type\uff09\u7684\u5f3a\u5236\u8bbf\u95ee\u63a7\u5236\uff08MAC\uff09\u5b89\u5168\u7cfb\u7edf\uff0c\u8bf4\u4eba\u8bdd\u5c31\u662fLinux\u7684\u4e00\u4e2a\u5b89\u5168\u5b50\u7cfb\u7edf\uff0c\u5b83\u662f\u9ed8\u8ba4\u5f00\u542f\u7684 \uff0c\u4f1a\u5bf9\u6211\u4eecCeph\u5b89\u88c5\u8fc7\u7a0b\u9020\u6210\u4e00\u5b9a\u7684\u5f71\u54cd\uff0c\u6240\u4ee5\u5148\u5173\u6389\u5b83\u3002\u5173\u95ed\u9632\u706b\u5899[root@ceph-node1 ~]# systemctl stop firewalld\n[root@ceph-node1 ~]# systemctl disable firewalld\n\n\u5173\u95edselinux[root@ceph-node1 ~]# sed -i &#39;s/SELINUX=enforcing/SELINUX=disabled/g&#39; /etc/selinux/config &amp;&amp; setenforce 0\n\n(5) epel\u6e90\u914d\u7f6e\nyum\u9ed8\u8ba4\u7684\u6e90\u662f\u56fd\u5916\u7684\uff0c\u56e0\u4e3a\u4f17\u6240\u5468\u77e5\u7684\u539f\u56e0\uff0c\u5b83\u7684\u901f\u5ea6\u53ef\u80fd\u4f1a\u6bd4\u8f83\u6162\u3002\u6240\u4ee5\u6211\u4eec\u6362\u6210\u56fd\u5185\u7684\u6e90\u3002\u628a\u8f6f\u4ef6\u5305\u6e90\u52a0\u5165\u8f6f\u4ef6\u4ed3\u5e93\u7528\u6587\u672c\u7f16\u8f91\u5668\u521b\u5efa\u4e00\u4e2a YUM \u5e93\u6587\u4ef6\uff1a[root@ceph-node1 ~]# vi /etc/yum.repos.d/ceph.repo\n\n[ceph]\nname=Ceph packages for $basearch\nbaseurl=http://mirrors.aliyun.com/ceph/rpm-luminous/el7/$basearch\nenabled=1\ngpgcheck=1\npriority=1\ntype=rpm-md\ngpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc\n\n[ceph-noarch]\nname=Ceph noarch packages\nbaseurl=http://mirrors.aliyun.com/ceph/rpm-luminous/el7/noarch\nenabled=1\ngpgcheck=1\npriority=1\ntype=rpm-md\ngpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc\n\n[ceph-source]\nname=Ceph source packages\nbaseurl=http://mirrors.aliyun.com/ceph/rpm-luminous/el7/SRPMS\nenabled=0\ngpgcheck=1\ntype=rpm-md\ngpgkey=https://mirrors.aliyun.com/ceph/keys/release.asc\npriority=1\n\n\u7f13\u5b58\u670d\u52a1\u5668\u7684\u5305\u4fe1\u606f[root@ceph-node1 ~]# yum makecache\n\n\u66f4\u65b0yum[root@ceph-node1 ~]# yum update -y\n\n(5) mgr\u8282\u70b9\u5b89\u88c5ceph-deploy\n\u4e4b\u524d\u7684\u64cd\u4f5c\uff0c\u90fd\u9700\u8981\u5728\u6240\u6709\u975e\u5ba2\u6237\u7aef\u8282\u70b9\u8fdb\u884c\uff0c\u8fd9\u4e2a\u53ea\u9700\u8981\u5728\u4f5c\u4e3amgr\u8282\u70b9\u7684ceph-node1\u4e0a\u64cd\u4f5c\u5373\u53ef\u3002\u5b89\u88c5ceph-deploy\u7ba1\u7406\u5de5\u5177[root@ceph-node1 ~]# yum install -y ceph-deploy\n\nceph-deploy\u90e8\u7f72\u5de5\u5177\u5b89\u88c5\u6210\u529f(6) \u914d\u7f6eSSH\u670d\u52a1\u5668\n\u6b63\u56e0\u4e3a ceph-deploy \u4e0d\u652f\u6301\u8f93\u5165\u5bc6\u7801\uff0c\u4f60\u5fc5\u987b\u5728\u7ba1\u7406\u8282\u70b9\u4e0a\u751f\u6210 SSH \u5bc6\u94a5\u5e76\u628a\u5176\u516c\u94a5\u5206\u53d1\u5230\u5404 Ceph \u8282\u70b9\uff0c\u5b8c\u6210\u8282\u70b9\u95f4\u7684\u514d\u5bc6\u7801\u767b\u9646\u3002\u7ba1\u7406\u8282\u70b9\u6dfb\u52a0\u5230\u5404\u4e2a\u8282\u70b9\u673a\u4e4b\u95f4\u914d\u7f6essh\u670d\u52a1\u5668\u6839\u636e\u5b98\u65b9\u6587\u6863\u5efa\u8bae\uff0c\u4e0d\u8981\u4f7f\u7528root\u7528\u6237\u6216sudo\uff0c\u5207\u6362\u56deceph\u7528\u6237\u3002[root@ceph-node1 ~]$ su - ceph\n\n\u65b0\u5efa\u5bc6\u94a5\uff08\u4e00\u8def\u56de\u8f66\u5373\u53ef\uff09[ceph@ceph-node1 ~]$ ssh-keygen\n\n\u516c\u94a5\u5206\u53d1\uff0c\u671f\u95f4\u63d0\u793a\u8f93\u5165\u5176\u4ed6\u8282\u70b9ceph\u7528\u6237\u7684\u5bc6\u7801\uff0c\u6211\u4eec\u540c\u6837\u4e5f\u662f\u914d\u7f6e\u7684ceph[ceph@ceph-node1 ~]$ ssh-copy-id  ceph@ceph-node2\n[ceph@ceph-node1 ~]$ ssh-copy-id  ceph@ceph-node3\n\n\u914d\u7f6e.ssh/config\u6587\u4ef6\u4fee\u6539 ceph-deploy \u7ba1\u7406\u8282\u70b9ceph-node1\u4e0a\u7684 ~/.ssh/config\u6587\u4ef6\uff0c\u8fd9\u6837 ceph-deploy \u5c31\u80fd\u7528\u4f60\u6240\u5efa\u7684\u7528\u6237\u540d\u767b\u5f55 Ceph \u8282\u70b9\u4e86\uff0c\u800c\u65e0\u9700\u6bcf\u6b21\u6267\u884c ceph-deploy \u90fd\u8981\u6307\u5b9a \u2013username {username} \u3002\u8fd9\u6837\u505a\u540c\u65f6\u4e5f\u7b80\u5316\u4e86 ssh \u7684\u7528\u6cd5\u3002[ceph@ceph-node1 ~]$ vi ~/.ssh/config\n\nHost node1\n   Hostname ceph-node1\n   User ceph\nHost node2\n   Hostname ceph-node2\n   User ceph\nHost node3\n   Hostname ceph-node3\n   User ceph\n\n\nHost\u540e\u4e3assh\u8fde\u63a5\u7684\u540d\u79f0Hostname\u63a5host\u6587\u4ef6\u4e2d\u7684\u540d\u5b57\uff0c\u4e5f\u662fceph-deploy\u6240\u7528\u7684\u540d\u5b57\n\u91cd\u542fssh\u670d\u52a1\uff08\u9700\u8981\u8f93\u5165root\u6743\u9650\u7684\u5bc6\u7801\uff09[ceph@ceph-node1 ~]$ sudo chmod 600 .ssh/config &amp;&amp; systemctl restart sshd\n\n\u6d4b\u8bd5ssh\u8fde\u63a5[ceph@ceph-node1 ~]$ ssh node2\n[ceph@ceph-node2 ~]$ exit\n\n3.3 \u521b\u5efa\u96c6\u7fa4\n(1) \u521b\u5efaceph\u5de5\u4f5c\u76ee\u5f55\u5e76\u914d\u7f6eceph.conf\n\u7531\u4e8eceph-deploy\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4ea7\u751f\u6587\u4ef6\uff0c\u6545\u65b0\u5efa\u4e00\u4e2a\u76ee\u5f55\u3002\u5728mgr\u8282\u70b9\u4e0a\u521b\u5efaceph\u5de5\u4f5c\u76ee\u5f55[ceph@ceph-node1 ~]$ mkdir my-cluster &amp;&amp; cd my-cluster\n\n\u521b\u5efaceph\u96c6\u7fa4\uff0cnew\u540e\u63a5mon\u8282\u70b9\u7684\u4e3b\u673a\u540d\u3002[ceph@ceph-node1 cluster ~]$ ceph-deploy new ceph-node1\n\n\u5b89\u88c5\u6210\u529f\n\u5982\u679c\u9047\u5230python\u7684import error\uff1a\u8fd9\u4e2a\u95ee\u9898\u901a\u5e38\u662f\u7531\u4e8e\u5347\u7ea7\u5230python2.7\u540e\u6267\u884cpip\u4ea7\u751f\u7684\uff0c\u89e3\u51b3\u65b9\u6848\u662f\u91cd\u65b0\u5728python2.7\u73af\u5883\u4e2d\u5b89\u88c5pip\uff0c\u6216\u8005\u5b89\u88c5setuptools\u5373\u53ef\uff1a\n[ceph@ceph-node1 ~]$ sudo yum install -y python-setuptools\n\nceph-deploy\u7684new\u5b50\u547d\u4ee4\u80fd\u591f\u90e8\u7f72\u4e00\u4e2a\u9ed8\u8ba4\u540d\u79f0\u4e3aceph\u7684\u65b0\u96c6\u7fa4\uff0c\u5e76\u4e14\u5b83\u80fd\u751f\u6210\u96c6\u7fa4\u914d\u7f6e\u6587\u4ef6\u548c\u5bc6\u94a5\u6587\u4ef6\u3002\u5217\u51fa\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\uff0c\u4f60\u4f1a\u770b\u5230ceph.conf\u548cceph.mon.keyring\u6587\u4ef6\u3002\u4ea7\u751f\u7684\u6587\u4ef6\n\u5982\u679c\u9700\u8981(\u65b0\u5b89\u88c5\u7684\u7cfb\u7edf\u901a\u5e38\u4e0d\u9700\u8981)\uff0c\u90e8\u7f72\u4e4b\u524d\u786e\u4fddceph\u6bcf\u4e2a\u8282\u70b9\u6ca1\u6709ceph\u6570\u636e\u5305\uff08\u5148\u6e05\u7a7a\u4e4b\u524d\u6240\u6709\u7684ceph\u6570\u636e\uff0c\u5982\u679c\u662f\u65b0\u88c5\u4e0d\u7528\u6267\u884c\u6b64\u6b65\u9aa4\uff0c\u5982\u679c\u662f\u91cd\u65b0\u90e8\u7f72\u7684\u8bdd\u4e5f\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff09\n[ceph@ceph-node1]$ ceph-deploy purge ceph-deploy ceph-u0-m0 ceph-u0-l0 ceph-u0-r0\n[ceph@ceph-node1]$ ceph-deploy purgedata ceph-deploy ceph-u0-m0 ceph-u0-l0 ceph-u0-r0\n[ceph@ceph-node1]$ ceph-deploy forgetkeys\n\n\u914d\u7f6e\u76d1\u63a7\u8282\u70b9ceph.conf[ceph@ceph-node1 cluster ~]$ vi ceph.conf\n# \u4fee\u6539mon_host\nmon_host = 104.207.133.105\t\t//\u76d1\u63a7\u8282\u70b9ip\n\nceph.conf\u7684\u914d\u7f6e\u6587\u6863(2) \u8282\u70b9\u5b89\u88c5ceph\n\u5728\u7ba1\u7406\u8282\u70b9\uff0c\u5229\u7528ceph-deploy\u5de5\u5177\u4e3a\u5404\u4e2a\u8282\u70b9\u5b89\u88c5ceph[ceph@ceph-node1 cluster ~]$ ceph-deploy install ceph-node1 ceph-node2 ceph-node3\n\n\u5728\u5404\u4e2a\u8282\u70b9\u68c0\u67e5\u5b89\u88c5\u60c5\u51b5[ceph@ceph-node1 ~]$ ceph --version\n[ceph@ceph-node2 ~]$ ceph --version\n[ceph@ceph-node3 ~]$ ceph --version\n\n\u5b89\u88c5\u60c5\u51b5\u68c0\u67e5(3) mon\u8282\u70b9\u521d\u59cb\u5316\n\u521d\u59cb\u5316\u7684\u65f6\u5019\uff0c\u4f1a\u751f\u6210mon\u8282\u70b9\u76d1\u6d4b\u96c6\u7fa4\u6240\u4f7f\u7528\u7684\u79d8\u94a5[ceph@ceph-node1 cluster ~]$ ceph-deploy mon create-initial\n\n\n\u672c\u6587\u5728\u7ba1\u7406\u8282\u70b9\u5b89\u88c5\u7684mon\uff0c\u5982\u679c\u9700\u8981\u5728\u5176\u4ed6\u8282\u70b9\u5b89\u88c5mon\uff0c\u53ef\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff1a\n[ceph@ceph-node1 cluster ~]$ ceph-deploy mon node1 node2 node3 node4\n\n\u5c06\u7ba1\u7406\u8282\u70b9\u7684\u914d\u7f6e\u5206\u53d1\u5230\u5176\u5b83\u8282\u70b9\u6536\u96c6\u6240\u6709\u5bc6\u94a5\uff0cOSD\u6dfb\u52a0\u597d\u540e\uff0c\u7528 ceph-deploy \u628a\u914d\u7f6e\u6587\u4ef6\u548c \u7ba1\u7406\u8282\u70b9\u5bc6\u94a5\u62f7\u8d1d\u5230\u7ba1\u7406\u8282\u70b9\u548c Ceph \u8282\u70b9\uff0c\u8fd9\u6837\u6bcf\u6b21\u6267\u884c Ceph \u547d\u4ee4\u884c\u65f6\u5c31\u65e0\u9700\u6307\u5b9a mon\u8282\u70b9 \u5730\u5740\u548c ceph.client.admin.keyring \u4e86[ceph@ceph-node1 cluster ~]$ ceph-deploy admin ceph-node1 ceph-node2 ceph-node3\n\n\u5c06mon\u8282\u70b9\u751f\u6210\u7684\u5bc6\u94a5\u73af\u5206\u53d1\u5230\u5404\u4e2a\u8282\u70b9[ceph@ceph-node1 cluster ~]$ sudo scp *.keyring ceph-node1:/etc/ceph/\n[ceph@ceph-node1 cluster ~]$ sudo scp *.keyring ceph-node2:/etc/ceph/\n[ceph@ceph-node1 cluster ~]$ sudo scp *.keyring ceph-node3:/etc/ceph/\n\n\u5141\u8bb8ceph\u7528\u6237\u8bbf\u95eeetc/ceph\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6sudo chown -R ceph:ceph /etc/ceph\n\n\u8f93\u5165ceph -s\u67e5\u770b\u5f53\u524d\u96c6\u7fa4\u7684\u72b6\u6001\u4fe1\u606fceph\u96c6\u7fa4\u72b6\u6001(4) \u914d\u7f6emgr\nmgr (manager)\uff0c\u7528\u4e8e\u7ba1\u7406\u96c6\u7fa4[ceph@ceph-node1 cluster ~]$ ceph-deploy mgr create ceph-node1\n\n\u5f00\u542f\u4eea\u8868\u76d8[ceph@ceph-node1 cluster ~]$ ceph mgr module enable dashboard\n\n\u901a\u8fc7http://104.207.133.105:7000/\u67e5\u770b\u96c6\u7fa4\u4fe1\u606f\u7ba1\u7406\u754c\u9762(5) \u6dfb\u52a0OSD\u5230\u96c6\u7fa4\n\u68c0\u67e5OSD\u8282\u70b9\u4e0a\u6240\u6709\u53ef\u7528\u7684\u78c1\u76d8[ceph@ceph-1 cluster]$ ceph-deploy disk list ceph-node1 ceph-node2 ceph-node3\n\n\u4f7f\u7528zap\u9009\u9879\u5220\u9664\u6240\u6709osd\u8282\u70b9\u4e0a\u7684\u5206\u533a[ceph@ceph-1 cluster]$ ceph-deploy disk zap ceph-node1 /dev/vdb\n[ceph@ceph-1 cluster]$ ceph-deploy disk zap ceph-node2 /dev/vdb\n[ceph@ceph-1 cluster]$ ceph-deploy disk zap ceph-node3 /dev/vdb\n\n\nCeph12\u7248\u672c\u4ee5\u540eprepare\u548cactivate\u547d\u4ee4\u5df2\u7ecf\u6ca1\u6709\u4e86\uff0c\u7528create\u66ff\u4ee3\n\u51c6\u5907OSD\uff08\u4f7f\u7528prepare\u547d\u4ee4\uff09[ceph@ceph-1 cluster]$ ceph-deploy osd prepare ceph-node1:/data/osd0 ceph-node2:/data/osd1 ceph-node3:/data/osd2\n\n\u6fc0\u6d3bOSD\uff08\u4f7f\u7528activate\u547d\u4ee4\uff09[ceph@ceph-1 cluster]$ ceph-deploy osd activate ceph-node1:/data/osd0 ceph-node2:/data/osd1 ceph-node3:/data/osd2\n\n\u521b\u5efaOSD\u4f7f\u7528ceph-deploy osd create --data {device} {ceph-node}\u521b\u5efaOSD\u5e76\u6dfb\u52a0\u5230\u96c6\u7fa4\u4e2d[ceph@ceph-1 cluster]$ ceph-deploy osd create --data /dev/vdb ceph-node1\n[ceph@ceph-1 cluster]$ ceph-deploy osd create --data /dev/vdb ceph-node2\n[ceph@ceph-1 cluster]$ ceph-deploy osd create --data /dev/vdb ceph-node3\n\n\u6dfb\u52a0OSD\u6210\u529fok\uff0c\u81f3\u6b64\u5b8c\u5de5\uff01\u53ef\u4ee5\u53bb\u6d4f\u89c8\u5668\u4eea\u8868\u76d8\u76f4\u89c2\u5730\u67e5\u770b\u90e8\u7f72\u540e\u7684\u60c5\u51b5\u30023.4 \u96c6\u7fa4\u7ba1\u7406\n\u5982\u679c\u4e4b\u524d\u90e8\u7f72\u51fa\u4e86\u95ee\u9898\uff0c\u53ef\u4ee5\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u4e88\u4ee5\u4fee\u6b63\u3002\u68c0\u67e5\u96c6\u7fa4\u72b6\u6001[ceph@ceph-node1 cluster ~]$ sudo ceph health\n\n\u6e05\u9664\u914d\u7f6e[ceph@ceph-node1 cluster ~]$ ceph-deploy purgedata ceph-node1 ceph-node2 ceph-node3\n[ceph@ceph-node1 cluster ~]$ ceph-deploy forgetkeys\n\n\u6e05\u9664ceph\u5305[ceph@ceph-node1 cluster ~]$ ceph-deploy purge ceph-node1 ceph-node2 ceph-node3\n\n\n\u5f15\u7528\nCeph\u5206\u5e03\u5f0f\u5b58\u50a8\u5de5\u4f5c\u539f\u7406 \u53ca \u90e8\u7f72\u4ecb\u7ecd-\u6563\u5c3d\u6d6e\u534eCeph-deploy\u5feb\u901f\u90e8\u7f72Ceph\u5206\u5e03\u5f0f\u5b58\u50a8Ceph\u5b66\u4e60\u4e4b\u8def-\u70df\u96e8\u6d6e\u534e\u5168\u7f51\u6700\u8be6\u7ec6\u7684Ceph14.2.5\u96c6\u7fa4\u90e8\u7f72\u53ca\u914d\u7f6e\u6587\u4ef6\u8be6\u89e3-PassZhangCentos7.6\u5b89\u88c5Ceph\uff08luminous\uff09-\u4f1a\u98de\u7684\u51ac\u74dc", "categories": [{"name": "\u5b66\u4e60", "slug": "\u5b66\u4e60", "permalink": "https://blog.imadamtang.cn/category/%E5%AD%A6%E4%B9%A0/"}], "tags": []}, {"title": "\u5434\u6069\u8fbe\u673a\u5668\u5b66\u4e60\u7684\u5b66\u4e60", "date": "2024-06-03T22:32:00+08.00", "path": "https://blog.imadamtang.cn/archives/%E5%90%B4%E6%81%A9%E8%BE%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%9A%84%E5%AD%A6%E4%B9%A0/", "text": "1 \u6982\u8ff0\n1.1 \u5b9a\u4e49\nArthur Samuel\u201cField of study that gives computers the ability to learn without being explicitly programmed.\u201d\n\u673a\u5668\u5b66\u4e60\uff1a\u5728\u6ca1\u6709\u8fdb\u884c\u7279\u5b9a\u7f16\u7a0b\u7684\u60c5\u51b5\u4e0b\u7ed9\u4e88\u8ba1\u7b97\u673a\u5b66\u4e60\u80fd\u529b\u7684\u9886\u57df\u3002\nTom Mitchell*\u201cA computer program is said to learn from experience E with respect to some task T and some performance measure P, if its performance on T, as measured by P, improves with experience E.\u201d*\n\u673a\u5668\u5b66\u4e60\uff1a\u673a\u5668\u5b66\u4e60\u662f\u4e3a\u4e86\u6267\u884c\u4efb\u52a1T\uff0c\u4ece\u7ecf\u9a8cE\u4e2d\u5b66\u4e60\uff0c\u7528\u8868\u73b0P\u6765\u8bc4\u5224\u5b83\u5b8c\u6210\u4efb\u52a1\u7684\u6027\u80fd\uff0c\u5e76\u4ece\u4e2d\u63d0\u5347\u3002\n\u4e3e\u4f8b\n\u8fc7\u6ee4\u5783\u573e\u90ae\u4ef6\n\n\u7528Tom\u7684\u5b9a\u4e49\u6765\u8bf4\uff0cT=\u6b63\u786e\u5206\u7c7b\u5783\u573e\u90ae\u4ef6\u548c\u666e\u901a\u90ae\u4ef6\uff0cE=\u67e5\u770b\u4f60\u5bf9\u90ae\u4ef6\u7684\u4eba\u5de5\u6807\u8bb0\uff08\u662f\u5426\u662f\u5783\u573e\u90ae\u4ef6\uff09\uff0cP=\u6b63\u786e\u5206\u7c7b\u7684\u6570\u91cf\u6216\u6982\u7387\u30021.2 \u5b66\u4e60\u7b97\u6cd5\n1.2.1 \u76d1\u7763\u5b66\u4e60\n\u76d1\u7763\u5b66\u4e60\uff1a\u63d0\u4f9b\u201c\u6b63\u786e\u7b54\u6848\u201d\u7684\u6570\u636e\u96c6\uff0c\u6765\u6559\u8ba1\u7b97\u673a\u5982\u4f55\u5b66\u4e601.2.1.1 \u56de\u5f52\u95ee\u9898\n\u56de\u5f52\u95ee\u9898\uff1a\u9884\u6d4b\u51fa\u8fde\u7eed\u503c\u5c5e\u6027\u7684\u7c7b\u578b\u4e3e\u4f8b\n\u623f\u4ef7\u9884\u6d4b\n\n\u6839\u636e\u5df2\u77e5\u7684\u9762\u79ef-\u623f\u4ef7\u6570\u636e\uff0c\u5f97\u5230\u4e00\u6761\u8f83\u4e3a\u62df\u5408\u7684\u51fd\u6570\uff08\u56fe\u4e2d\u7684\u7d2b\u8272\u975e\u7ebf\u6027\u51fd\u6570\uff0c\u84dd\u8272\u7ebf\u6027\u51fd\u6570\uff09\uff0c\u901a\u8fc7\u56de\u5f52\u9884\u6d4b\u51faX\u9762\u79ef\u623f\u5b50\u7684\u623f\u4ef7Y\u3002\u623f\u4ef7\u9884\u6d4b1.2.1.2 \u5206\u7c7b\u95ee\u9898\n\u5206\u7c7b\u95ee\u9898\uff1a\u9884\u6d4b\u51fa\u79bb\u6563\u503c\u5c5e\u6027\u7684\u7c7b\u578b\u4e3e\u4f8b\n\u80bf\u7624\u9884\u6d4b\n\n\u6839\u636e\u5df2\u77e5\u7684\u5e74\u9f84;\u80bf\u7624\u5927\u5c0f-\u826f\u6027/\u6076\u6027\u6570\u636e\uff0c\u5f97\u5230\u4e00\u6761\u62df\u5408\u76f4\u7ebf\u6765\u533a\u5206\u826f\u6027\u548c\u6076\u6027\uff0c\u4ece\u800c\u901a\u8fc7\u5e74\u9f84\u548c\u80bf\u7624\u5927\u5c0f\u6765\u5224\u65ad\u80bf\u7624\u662f\u826f\u6027\u6216\u6076\u6027\u7684\uff08\u84dd\u5708\u826f\u6027\uff0c\u7ea2\u53c9\u6076\u6027\uff09\u3002\u80bf\u7624\u9884\u6d4b\u901a\u8fc7\u4f8b\u5b50\uff0c\u6211\u4eec\u4e86\u89e3\u5230\uff0c\u6211\u4eec\u9700\u8981\u901a\u8fc7\u4e8b\u7269\u7684\u8bb8\u591a\u5c5e\u6027\uff08\u623f\u5b50\u9762\u79ef\u3001\u80bf\u7624\u5927\u5c0f\u548c\u60a3\u8005\u5e74\u9f84\u7b49\uff09\u6765\u5f97\u5230\u6211\u4eec\u9700\u8981\u7684\u7ed3\u679c\uff08\u623f\u4ef7\u3001\u826f\u6027\u6216\u6076\u6027\uff09\u3002\u5c5e\u6027\u662f\u5f71\u54cd\u7ed3\u679c\u7684\u4e00\u4e9b\u5173\u952e\u6027\u56e0\u7d20\uff0c\u800c\u5728\u5b9e\u9645\u4e2d\uff0c\u6211\u4eec\u5f71\u54cd\u4e8b\u7269\u7684\u5c5e\u6027\u975e\u5e38\u591a\uff0c\u53ef\u8ba1\u7b97\u673a\u5b58\u50a8\u7a7a\u95f4\u6709\u9650\uff0c\u4e0d\u53ef\u80fd\u5b58\u653e\u65e0\u9650\u591a\u7684\u5c5e\u6027\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u7528\u5230 \u652f\u6301\u5411\u91cf\u673a \u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u652f\u6301\u5411\u91cf\u673a\u901a\u8fc7\u4e00\u4e2a\u7b80\u6d01\u7684\u6570\u5b66\u6280\u5de7\uff0c\u5141\u8bb8\u8ba1\u7b97\u57fa\u7840\u62a4\u7406\u65e0\u9650\u591a\u7684\u5c5e\u6027\u30021.2.2 \u975e\u76d1\u7763\u5b66\u4e60\n\u975e\u76d1\u7763\u5b66\u4e60\uff1a\u6ca1\u6709\u6b63\u786e\u7b54\u6848\u7684\u6570\u636e\u96c6\uff0c\u8ba9\u8ba1\u7b97\u673a\u4ece\u4e2d\u81ea\u4e3b\u627e\u5230\u67d0\u79cd\u8574\u542b\u7684\u7ed3\u67841.2.2.1 \u805a\u7c7b\u7b97\u6cd5\n\u805a\u7c7b\u7b97\u6cd5\uff1a\u627e\u51fa\u6570\u636e\u96c6\u4e2d\u201c\u8574\u542b\u201d\u7684\u5206\u7c7b\u4e3e\u4f8b\n\u80bf\u7624\u5206\u7c7b\n\n\u80bf\u7624\u5206\u7c7b\n\u65b0\u95fb\u5206\u7c7b\n\n\u65b0\u95fb\u5206\u7c7b\u9e21\u5c3e\u9152\u4f1a\u7b97\u6cd5\u901a\u8fc7Microphone #1\u548cMicrophone #2\u7684\u58f0\u97f3\uff0c\u5206\u79bb\u4ec5\u6709\u51faSpeaker #1\u548cSpeaker #2\u7684\u58f0\u97f3\u9e21\u5c3e\u9152\u4f1a\u7b97\u6cd5[W,s,v]=svd((repmat(sum(x.*x,1),size(x,1),1).*x)*x&#39;);\n# svd:\u5947\u5f02\u503c\u5206\u89e3\n\n\n2 \u5355\u7279\u5f81\u7ebf\u6027\u56de\u5f52\n2.1 \u5b9a\u4e49\nm=\u8bad\u7ec3\u96c6\u6837\u672c\u6570\u91cfx=\u8f93\u5165\u53d8\u91cf/\u7279\u5f81y=\u8f93\u51fa\u53d8\u91cfh=\u6620\u5c04\u51fd\u6570(prediction)\u8f6e\u5ed3\u56fe(contour plot)\u8f6e\u5ed3\u56fe\n\u76f8\u540c\u989c\u8272\u7684\u6bcf\u4e00\u5708\u8868\u793a$J(\\theta_0,\\theta_1)$\u503c\u76f8\u7b49\u70b9\u96c6\u5408\n$J(\\theta_0,\\theta_1)$\u6700\u5c0f\u503c\u7684\u70b9\u5728\u5708\u6700\u5c0f\u7684\u70b9\u96c6\u4e2d\n\n2.2 \u5047\u8bbe\u51fd\u6570\n$h_\u03b8(x)=\u03b8\u2080+\u03b8\u2081x$\u7ebf\u6027\u56de\u5f52\u635f\u5931\u51fd\u6570\u9009\u62e9\u601d\u8def\uff1a\u9009\u62e9\u4e00\u4e2a\u51fd\u6570$J(\u03b8_0,\u03b8_1)$\uff0c\u4f7f\u5f97\u6837\u672c$y$\u4e0e$h_\u03b8(x)$\u4e4b\u5dee\u6700\u5c0f\u3002\u5047\u8bbe\u51fd\u6570\u548c\u635f\u5931\u51fd\u6570\u7684\u533a\u522b\uff1a\u5047\u8bbe\u51fd\u6570\u662f\u8f93\u5165\u503c\u548c\u8f93\u51fa\u503c\u7684\u51fd\u6570\uff0c\u662f\u6211\u4eec\u89e3\u51b3\u95ee\u9898\u6700\u7ec8\u9700\u8981\u5f97\u5230\u7684\u51fd\u6570\uff0c\u6211\u4eec\u5e94\u8be5\u5c3d\u91cf\u4f7f\u5176\u4e0e\u6837\u672c\u6570\u636e\u62df\u5408\u3002\u635f\u5931\u51fd\u6570\u662f\u4e3a\u4e86\u6c42\u89e3\u6700\u4f18\u5047\u8bbe\u51fd\u6570\u800c\u8bbe\u7684\u51fd\u6570\uff0c\u5176\u76ee\u7684\u662f\u5f97\u5230\u5047\u8bbe\u51fd\u6570\u4e2d\u7684\u5404\u4e2a\u5e38\u91cf\u503c\u3002\u635f\u5931\u51fd\u6570\u8861\u91cf\u4e86\u5047\u8bbe\u51fd\u6570\u4e0e\u5b9e\u9645\u95ee\u9898\u4e4b\u95f4\u7684\u63a5\u8fd1\u7a0b\u5ea6\u30022.3 \u635f\u5931\u51fd\u6570\n2.3.1 \u5e73\u65b9\u5dee\u51fd\u6570\n\u5e73\u65b9\u5dee\u51fd\u6570\u662f\u57fa\u4e8e\uff1a\u201c\u79bb\u5dee\u5e73\u65b9\u548c\u201d\uff0c\u5b83\u53cd\u6620\u4e86x\u4e0e\u5176\u6570\u5b66\u671f\u671bEx\u7684\u504f\u79bb\u7a0b\u5ea6\u3002Prediction: $h_\\theta(x)=\\theta_0+\\theta_1x$Parameters: $\\theta_0,\\theta_1$**Cost Function: **$J(\\theta_0,\\theta_1)=\\frac{1}{2m}  \\sum ^m _{i=1} (h_\u03b8(x^{(i)})-y^{(i)})^2$Goal: $J(\\theta_0,\\theta_1)min$\n\u95ee\uff1a\u6b64\u5904\u672c\u6765\u4e58\u4ee51/m\u5373\u53ef\uff0c\u4e3a\u4ec0\u4e48\u8981\u4e58\u4ee51/2m\u5462\uff1f\u7b54\uff1a\u56e0\u4e3a\u6211\u4eec\u9700\u8981\u6c42$J_{min}$\uff0c\u5229\u7528\u68af\u5ea6\u4e0b\u964d\u6cd5\u5bf9J\u6c42\u5bfc\u65f6\uff0c\u5982\u679c\u662f1/2m\uff0c\u6c42\u5bfc\u7ed3\u679c\u4e3a\uff1a\uff0c$\\frac{\u2202J}{\u2202 {\\theta}i}=\\frac{1}{m} \\sum ^m _{i=1} (h\\theta(x^{(i)})-y^{(i)}) \\frac{\u2202h_{\\theta}(x^{(i)})}{\u2202\\theta}$\u6b63\u597d\u6c42\u5bfc\u65f6\u5e73\u65b9\u76842\u53ef\u4ee5\u6d88\u53bb\uff0c\u7b80\u5316\u4e86\u8ba1\u7b97\u3002\u8fd9\u91cc\u65e0\u8bba\u9664\u4ee52m\u8fd8\u662fm\uff0c\u51fd\u6570J\u6700\u5c0f\u503c\u7684\u03b8\u90fd\u662f\u76f8\u540c\u7684\u3002\n\u5e73\u65b9\u5dee\u51fd\u65702.4 \u635f\u5931\u51fd\u6570\u6700\u5c0f\u5316\n2.4.1 \u68af\u5ea6\u4e0b\u964d\u6cd5\n\u68af\u5ea6\u4e0b\u964d\u6cd5\u7684\u8ba1\u7b97\u8fc7\u7a0b\u5c31\u662f\u6cbf\u68af\u5ea6\u4e0b\u964d/\u4e0a\u5347\u7684\u65b9\u5411\u6c42\u89e3\u6781\u5c0f\u503c/\u6781\u5927\u503c\uff08\u5c40\u90e8/\u5168\u5c40\u6700\u4f18\u89e3\uff09\u3002\u7528\u4e8e\u7ebf\u6027\u56de\u5f52\u7684\u635f\u5931\u51fd\u6570\u90fd\u662f\u201c\u5f13\u578b\u201d\u7684\uff0c\u5373\u51f8\u51fd\u6570\uff0c\u4e0d\u5b58\u5728\u5c40\u90e8\u6700\u4f18\u89e3\uff0c\u4e00\u5b9a\u5b58\u5728\u5e76\u4e14\u4ec5\u6709\u4e00\u4e2a\u5168\u5c40\u6700\u4f18\u89e3\u3002\u6c42\u89e3\u6b65\u9aa4\uff1a\n\u9009\u62e9\u4e00\u4e2a\u635f\u5931\u51fd\u6570$J(\\theta_0,\\theta_1 )$\n\u521d\u59cb\u5316\uff1a$(\\theta_0,\\theta_1)=(0,0)$\n\u9009\u62e9\u4e00\u4e2a\u5b66\u4e60\u901f\u7387$\u03b1$ (\u5373\u68af\u5ea6\u4e0b\u964d\u7684\u901f\u5ea6)\n\u5f00\u59cb\u8fed\u4ee3\uff0c\u4ee4$\\theta_j:=\\theta_j-\u03b1 \\frac{\\partial}{\\partial \\theta_j} J(\\theta_0,\\theta_1)$\n\u68c0\u67e5$\\theta_j$\u662f\u5426\u8d8b\u4e8e\u6536\u655b\uff08$\\frac{\\partial}{\\partial \\theta_j} J(\\theta_0,\\theta_1) \\to 0$ \u6216 $\\theta_j \\to \\theta_{j-1}$\uff09\uff0c\u82e5\u6536\u655b\u5219\u5f97\u5230$(\\theta_0,\\theta_1)$\uff0c\u53cd\u4e4b\u91cd\u590d\u6b65\u9aa43\n\n\u68af\u5ea6\u4e0b\u964d\u6c42\u89e3\u5173\u4e8e\u521d\u59cb\u503c\uff1a\n\u82e5\u635f\u5931\u51fd\u6570\u5b58\u5728\u591a\u4e2a\u5c40\u90e8\u6700\u4f18\u89e3\uff0c\u5219\u4ece\u4e0d\u540c\u7684\u521d\u59cb\u503c\u8fdb\u884c\u68af\u5ea6\u4e0b\u964d\uff0c\u53ef\u80fd\u5f97\u5230\u4e0d\u540c\u7684\u5c40\u90e8\u6700\u4f18\u89e3\u3002\n\n\u5c40\u90e8\u6700\u4f18\u89e3\u5173\u4e8e\u504f\u5bfc\uff1a\n$\\theta_0:=\\theta_0-\u03b1 \\frac{1}{m} \\sum ^m _{i=1} (h_\u03b8(x^{(i)})-y^{(i)}) $\n$\\theta_1:=\\theta_1-\u03b1 \\frac{1}{m} \\sum ^m _{i=1} (h_\u03b8(x^{(i)})-y^{(i)})\\cdot x^{(i)}$\n\n\u5173\u4e8e\u5b66\u4e60\u901f\u7387$\u03b1$ \uff1a\n$\u03b1$\u5982\u679c\u8fc7\u5927\uff0c\u53ef\u80fd\u5bfc\u81f4\u65e0\u6cd5\u6536\u655b\uff1b\u8fc7\u5c0f\uff0c\u53ef\u80fd\u5bfc\u81f4\u6c42\u89e3\u901f\u5ea6\u592a\u6162\u3002\n$\u03b1$\u4e0d\u9700\u8981\u5728\u5faa\u73af\u4e2d\u6539\u53d8\u5927\u5c0f\u7684\u539f\u56e0\uff1a\u56e0\u4e3a\u8d8a\u63a5\u8fd1min\uff0c\u5bfc\u6570\u8d8a\u63a5\u8fd10\uff0c\u6240\u4ee5\u5bfc\u00d7$\u03b1$\u4e5f\u4f1a\u8d8b\u4e8e0\uff0c\u6545\u68af\u5ea6\u4e0b\u964d\u7b97\u6cd5\u4f1a\u81ea\u52a8\u91c7\u53d6\u66f4\u5c0f\u7684\u4e0b\u964d\u6b65\u6cd5\u3002\n\n\u68af\u5ea6\u4e0b\u964d\u6b65\u6cd5\u81ea\u52a8\u51cf\u5c0f\u68af\u5ea6\u4e0b\u964d\u7684\u4e09\u79cd\u5f62\u5f0f\uff1a\u8be5\u4e09\u79cd\u5f62\u5f0f\u7684\u635f\u5931\u51fd\u6570\u4e0d\u540c\n\u6279\u91cf\u68af\u5ea6\u4e0b\u964d\uff08Batch Gradient Descent\uff0cBGD\uff09\n\n$$J(\\theta_0,\\theta_1)=\\frac{1}{2m}  \\sum ^m _{i=1} (h_\u03b8(x^{(i)})-y^{(i)})^2$$\n\nrepeat{\n    \u03b8j:=\u03b8j\u2212\u03b11m\u2211mi=1(h\u03b8(x(i))\u2212y(i))x(i)j\n    (for j =0,1)\n}\n\n\n\u968f\u673a\u68af\u5ea6\u4e0b\u964d\uff08Stochastic Gradient Descent\uff0cSGD\uff09\n\n$$J^{(i)}(\\theta_0,\\theta_1)=\\frac{1}{2} (h_\u03b8(x^{(i)})-y^{(i)})^2$$\n\nrepeat{\n    for i=1,...,m{\n    \t\u03b8j:=\u03b8j\u2212\u03b1(h\u03b8(x(i))\u2212y(i))x(i)j\n    \t(for j =0,1)\n    }\n}\n\n\n\u5c0f\u6279\u91cf\u68af\u5ea6\u4e0b\u964d\uff08Mini-Batch Gradient Descent, MBGD\uff09\n\n$$J(\\theta_0,\\theta_1)=\\frac{1}{2m}  \\sum ^k _{i=1} (h_\u03b8(x^{(i)})-y^{(i)})^2 ,k\\in(0,m)$$\n\nrepeat{\n    for i=1,11,21,31,...,991{\n    \t\u03b8j:=\u03b8j\u2212\u03b1110\u2211(i+9)k=i(h\u03b8(x(k))\u2212y(k))x(k)j\n    \t(for j =0,1)\n    }\n}\n\n\u53c2\u8003\uff1a\u4e09\u79cd\u68af\u5ea6\u4e0b\u964d\u5f62\u5f0f\u7684\u4ecb\u7ecd\u68af\u5ea6\u4e0b\u964d\u7406\u89e32.5 \u7ec3\u4e60\n\n\u6839\u636e\u5206\u5b50\u4e2d\u78b3\u542b\u91cf\u548c\u71c3\u70e7\u91ca\u653e\u80fd\u91cf\u7684\u8bad\u7ec3\u96c6\uff0c\u6784\u5efa\u4e00\u4e2a\u7ebf\u6027\u56de\u5f52\u51fd\u6570\n\n\u9898\u76ee\u95ee\u9898\u89e3\u51b3\u601d\u8def\n\u6839\u636e\u6761\u4ef6\u5212\u51fa\u70b9\u96c6\u56fe\uff0c\u70b9\u96c6\u5206\u5e03\u7b26\u5408\u7ebf\u6027\u56de\u5f52\u95ee\u9898\uff0c\u6545\u786e\u8ba4\u8be5\u95ee\u9898\u7c7b\u578b\n\u7ebf\u6027\u56de\u5f52\u95ee\u9898\u6784\u5efa\u5047\u8bbe\u51fd\u6570\uff1a$h_\\theta(x)=\\theta_0+\\theta_1*x$\n\u660e\u786e\u6240\u9700\u6c42\u53c2\u4e3a $\\theta_0,\\theta_1$ \uff0c\u6784\u5efa\u635f\u5931\u51fd\u6570\uff0c\u6b64\u5904\u91c7\u7528\u5e73\u65b9\u5dee\u51fd\u6570\uff1a$J(\\theta_0,\\theta_1)=\\frac{1}{2m}  \\sum ^m _{i=1} (h_\u03b8(x^{(i)})-y^{(i)})^2$\n\u660e\u786e\u6700\u5c0f\u5316\u635f\u5931\u51fd\u6570\u65b9\u6cd5\uff0c\u6b64\u5904\u91c7\u7528\u6279\u91cf\u68af\u5ea6\u4e0b\u964d\u6cd5\uff1a\n\u521d\u59cb\u5316\uff1a$(\\theta_0,\\theta_1)=(0,0)$\n\u9009\u62e9\u4e00\u4e2a\u5b66\u4e60\u901f\u7387$\u03b1$ \uff08\u5e38\u4ee50.001\u5f00\u59cb\u9012\u589e\u5c1d\u8bd5\uff09\n\u9009\u62e9\u4e00\u4e2a\u8fed\u4ee3\u6b21\u6570iteraNum\uff08\u5e38\u4ee51500\u5f00\u59cb\uff09\n\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u4ee4$\\theta_j:=\\theta_j-\u03b1 \\frac{\\partial}{\\partial \\theta_j} J(\\theta_0,\\theta_1)$\n\n\n\nOctave\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1adata = load(&#39;trainingset.txt&#39;);\nX = data(:,1);\ny = data(:,2);\n\n%\u5b9a\u4e49\u68af\u5ea6\u4e0b\u964d\u7b97\u6cd5\nfunction theta = gradientDescent(X, y, alpha, iteraNum)\ntheta = [0;0];\nm = length(y);\nfor i=1:iteraNum;\ndist = theta(1) + X*theta(2) - y;\ntheta(1) = theta(1) - alpha*(1/m)*sum(dist);\ntheta(2) = theta(2) - alpha*(1/m)*sum(dist.*X);\nend\nend\n\n%\u9ed8\u8ba4\u5b66\u4e60\u901f\u7387\u4e3a0.01 \u8fed\u4ee3\u6b21\u6570\u4e3a5000\u6b21\ntheta = gradientDescent(X, y, 0.01, 5000);\nplot(X, y, &#39;xr&#39;, X, theta(1) + theta(2)*X);\nlegend(&#39;Training Data&#39;,&#39;Linear Regression&#39;);\nxlabel(&#39;Number of hydrocarbons in molecule&#39;);\nylabel(&#39;Heat release when burned(kJ/mol)&#39;);\n\n%theta = [-569,60; -530,91]\n\n\u8bad\u7ec3\u540e\u5f97\u5230\u7684\u56de\u5f52\u51fd\u6570\u4e3a $h_\\theta(x)=-569.6 - 530.9*x$ :\u6548\u679c\u56fe\u77e9\u9635\u5728\u8be5\u7b97\u6cd5\u4e2d\u7684\u5e94\u7528\uff1a\n\u5bf9\u4e8e\u8bad\u7ec3\u96c6$(x_0,x_1,x_2,...,x_n,y)$\uff0c\u5c06$(x_0,x_1,x_2,...,x_n)$\u4f5c\u4e3a\u77e9\u9635$X$\uff0c$(y)$\u4f5c\u4e3a\u77e9\u9635(\u5411\u91cf) $y$\n\u5bf9\u635f\u5931\u51fd\u6570\u7684\u504f\u5bfc$\\frac{\\partial}{\\partial \\theta_j} J(\\theta_0,\\theta_1)$ \u5305\u542b $\\sum ^m {i=1} (h_\u03b8(x^{(i)})-y^{(i)})$ \uff0c\u4e3a\u4fdd\u8bc1\u540c\u65f6\u66f4\u65b0\u7684\u8981\u6c42\uff0c\u5e94\u5148\u7528\u77e9\u9635\u4e58\u6cd5\u8868\u793a\u4e3a\uff1a$dist=h\\theta(x^{(i)})-y^{(i)}= \\theta_0 + X\\cdot\\theta_1 - y$\n$\\theta_1= \\theta_1 - \u03b1(1/m)sum(dist)$\n$\\theta_2= \\theta_2 - \u03b1(1/m)sum(dist.X)$ \uff0c\u56e0\u4e3a$J(\\theta_1,\\theta_2)$\u7684\u4e24\u4e2a\u504f\u5bfc\u4e0d\u540c\uff0c\u5bf9$\\theta_2$\u7684\u504f\u5bfc\u9700\u8981\u518d\u4e58\u4ee5$x$\uff0c\u6545\u6b64\u5904\u9700\u8981\u91c7\u7528$dist.X$\uff0c\u5176\u4e2d\u7684\u201c $.$ \u201d\u662f\u6307\u540c\u578b\u77e9\u9635$a_{ij}b_{ij}$\n\n\n3 \u591a\u7279\u5f81\u7ebf\u6027\u56de\u5f52\n3.1 \u5b9a\u4e49\n$m$=\u6837\u672c\u6570\u91cf$n$ = \u7279\u5f81\u6570\u91cf$x^{(i)}$=\u7b2ci\u4e2a\u6837\u672c$x^{(i)}_j$=\u7b2ci\u4e2a\u6837\u672c\u7684\u7b2cj\u4e2a\u7279\u5f813.2 \u5047\u8bbe\u51fd\u6570\n$$h_\\theta(x)=\\theta_0+\\theta_1x_1+\\theta_2x_2+\\cdots+\\theta_nx_n $$\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u4ee4 $x_0=1$\uff0c\u5373 $x^{(i)}_0=1$\n\u4ee4 $x= \\begin{bmatrix} x_0\\x_1\\x_2\\\\vdots\\x_n\\end{bmatrix} $ \uff0c $\\theta=\\begin{bmatrix}\\theta_0\\\\theta_1\\\\theta_2\\\\vdots\\\\theta_n\\end{bmatrix}$ \uff0c\u5219 $h_\\theta(x)=\\theta_0+\\theta_1x_1+\\theta_2x_2+\\cdots+\\theta_nx_n=\\theta^Tx$\n\nCode\u4f9d\u636e\u516c\u5f0f\uff1a$h_\\theta(x)=\\theta_0+\\theta_1x_1+\\theta_2x_2+\\cdots+\\theta_nx_n=\\theta^Tx$\u516c\u5f0fprediciton = X*theta;\n\n3.3 \u635f\u5931\u51fd\u6570\n3.3.1 \u5e73\u65b9\u5dee\u51fd\u6570\n\u5e73\u65b9\u5dee\u51fd\u6570\u662f\u57fa\u4e8e\uff1a\u201c\u79bb\u5dee\u5e73\u65b9\u548c\u201d\uff0c\u5b83\u53cd\u6620\u4e86x\u4e0e\u5176\u6570\u5b66\u671f\u671bEx\u7684\u504f\u79bb\u7a0b\u5ea6\u3002Prediction: $h_\\theta(x)=\\theta_0+\\theta_1x_1+\\theta_2x_2+\\cdots+\\theta_nx_n =  X\\theta$Parameters: $\\theta_0,\\theta_1,\\cdots,\\theta_n$ \u4e5f\u5c31\u662f $\\theta^T=[\\theta_0  \\theta_1 \\cdots \\theta_n]$**Cost Function: **$J(\\theta)=\\frac{1}{2m}  \\sum ^m _{i=1} (h_\u03b8(x^{(i)})-y^{(i)})^2$Goal: $J(\\theta)min$Code\u4f9d\u636e\u516c\u5f0f\uff1a$J(\\theta)=\\frac{1}{2m}  \\sum ^m _{i=1} (h_\u03b8(x^{(i)})-y^{(i)})^2$sqrErrors = (X*theta-y).^2;\t\t%squared errors\nJ = 1/(2*m) * sum(sqrErrors);\n\n3.4 \u635f\u5931\u51fd\u6570\u6700\u5c0f\u5316\n3.4.1 \u68af\u5ea6\u4e0b\u964d\u6cd5\n\u6c42\u89e3\u6b65\u9aa4\uff08\u5b8c\u5584\uff09\uff1a\n\u9009\u62e9\u4e00\u4e2a\u635f\u5931\u51fd\u6570$J(\\theta)$\n\u521d\u59cb\u5316\uff1a$\\theta=0$\n\u7279\u5f81\u7684\u7f29\u653e\u4ee5\u53ca\u5747\u503c\u5f52\u4e00\u5316\n\u9009\u62e9\u4e00\u4e2a\u5b66\u4e60\u901f\u7387$\u03b1$ \uff0c\u753b\u51fa $J(\\theta)$ \u2014 $iteraNum$ \u7684\u56fe\u50cf\uff0c\u627e\u51fa\u6700\u5408\u9002\u7684\u5b66\u4e60\u901f\u7387\n\u5f00\u59cb\u8fed\u4ee3\uff0c\u4ee4$\\theta_j:=\\theta_j-\u03b1\\frac{\\partial}{\\partial\\theta_j}J(\\theta)$\n\u68c0\u67e5$\\theta_j$\u662f\u5426\u8d8b\u4e8e\u6536\u655b\uff08$\\frac{\\partial}{\\partial \\theta_j} J(\\theta) \\to 0$ \u6216 $\\theta^j \\to \\theta^{j-1}$\uff09\uff0c\u82e5\u6536\u655b\u5219\u5f97\u5230 $\\theta$\uff0c\u53cd\u4e4b\u91cd\u590d\u6b65\u9aa43\n\n\u5173\u4e8e\u504f\u5bfc\uff1a\n$\\theta_0:=\\theta_0-\u03b1 \\frac{1}{m} \\sum ^m _{i=1} (h_\u03b8(x^{(i)})-y^{(i)}) $\n$\\theta_j:=\\theta_j-\u03b1 \\frac{1}{m} \\sum ^m _{i=1} (h_\u03b8(x^{(i)})-y^{(i)})\\cdot x^{(i)}_j$\n\nCode\u4f9d\u636e\u516c\u5f0f\uff1a$\\theta_j:=\\theta_j-\u03b1 \\frac{1}{m} \\sum ^m _{i=1} (h_\u03b8(x^{(i)})-y^{(i)})\\cdot x^{(i)}_j$for iter = 1:num_iters\n    % X\u8865\u5145\u4e86\u4e00\u52171\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u4e58X&#39;\n    theta = theta - (alpha/m)*X&#39;*(X*theta - y);\nend\n\n3.4.2 \u6b63\u89c4\u65b9\u7a0b\u6cd5\n\u91c7\u7528\u6570\u5b66\u4e2d\u6c42\u89e3\u591a\u9879\u5f0f\u51fd\u6570\u7684\u65b9\u6cd5\uff1a\n\u6c42\u6bcf\u4e2a\u53c2\u6570\u7684\u504f\u5bfc\n\u504f\u5bfc\u7f6e\u96f6\u5f97\u6781\u503c\u70b9\n\u6781\u503c\u70b9\u4e2d\u9009\u62e9\u51fa\u6700\u5c0f\u503c\u70b9\n\n\u57fa\u672c\u601d\u60f3\u5982\u4e0b\uff1a\u03b8\u7684\u4e3e\u8bc1\u8868\u793aCode\u4f9d\u636e\u516c\u5f0f\uff1a $\\theta=(X^TX)^{-1}X^Ty$theta = pinv(X&#39; * X) * X&#39; * y;\t\t\t%pinv()\u8fd4\u56de\u77e9\u9635\u4f2a\u9006\u9635\n\n\u5bf9\u4e8e\u6781\u5c11\u6570\u4e0d\u53ef\u9006\u7684\u77e9\u9635$X^TX$\uff0c\u6211\u4eec\u4ecd\u7136\u7528pinv()\u51fd\u6570\u3002\u56e0\u4e3a\u8be5\u51fd\u6570\u662f\u201c\u4f2a\u9006\u201d\u7684\uff0c\u4ed6\u5728\u8fd0\u7b97\u8fc7\u7a0b\u4e2d\u4e0e\u771f\u6b63\u7684\u6c42\u9006\u51fd\u6570inv()\u4e0d\u540c\uff0c\u4f1a\u5728\u4e00\u4e9b\u6b65\u9aa4\u4e2d\u6709\u4e00\u70b9\u53d8\u52a8\uff0c\u4f46\u4e0d\u5f71\u54cd\u7ed3\u679c\u3002\u77e9\u9635\u4e0d\u53ef\u9006\u7684\u4e24\u4e2a\u539f\u56e0\uff1a\n\u5f53\u77e9\u9635\u7684\u4e24\u4e2a\u7279\u5f81\u9009\u53d6\u4e0d\u6070\u5f53\u65f6\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4$X^TX$\u4e0d\u53ef\u9006\u7684\u60c5\u51b5\u51fa\u73b0\u3002\u4f8b\u5982\u7279\u5f81\u201d\u82f1\u5c3a\u201c\u548c\u201d\u7c73\u201c\u4f5c\u4e3a\u4e24\u4e2a\u7279\u5f81\uff0c\u4f46\u5b9e\u9645\u4e0a\u4e24\u4e2a\u7279\u5f81\u7ebf\u6027\u76f8\u5173\uff0c\u5219\u77e9\u9635\u4e00\u5b9a\u4f1a\u4e0d\u53ef\u9006\u3002\n\u6837\u672c\u6570&lt;\u7279\u5f81\u6570\u65f6\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e0d\u53ef\u9006\u60c5\u51b5\u3002\u6b64\u65f6\u5c31\u9700\u8981\u91c7\u7528\u6b63\u5219\u5316\u7b49\u65b9\u6cd5\uff0c\u4f7f\u8f83\u5c11\u7684\u6837\u672c\u4ecd\u7136\u80fd\u5f97\u5230\u6709\u5f88\u591a\u7279\u5f81\u7684\u53c2\u6570\u3002\n\n\u77e9\u9635\u4e0d\u53ef\u9006\u65f6\uff0c\u5e94\u5148\u5c1d\u8bd5\u6392\u9664\u5197\u4f59\u7684\u7279\u5f81\u30023.4.3 \u65b9\u6cd5\u6bd4\u8f83\n\n\n\n  \u68af\u5ea6\u4e0b\u964d\u6cd5\n  \u6b63\u89c4\u65b9\u7a0b\u6cd5\n\n\n\n\n  \u9700\u8981\u901a\u8fc7\u591a\u6b21\u8c03\u8bd5\uff0c\u627e\u5230\u5408\u9002\u7684\u5b66\u4e60\u901f\u7387\u03b1\n  \u4e0d\u9700\u8981\u5b66\u4e60\u901f\u7387\u03b1\n\n\n  \u9700\u8981\u591a\u6b21\u8fed\u4ee3\n  \u4e0d\u9700\u8981\u8fed\u4ee3\n\n\n  \u7279\u5f81\u7684\u6570\u91cf\u5bf9\u7b97\u6cd5\u901f\u5ea6\u5f71\u54cd\u4e0d\u5927\n  \u03b8\u5305\u542b$(X^TX)^{-1}$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(n^3)$\uff0c\u6545\u7279\u5f81\u4e0d\u5b9c\u592a\u591a\n\n\n  \n  \u7ecf\u9a8c\uff1a\u7279\u5f81\u6570\u91cf&gt;1\u4e07\u65f6\uff0c\u901f\u5ea6\u5c06\u4f1a\u6709\u8f83\u5927\u5f71\u54cd\n\n\n\n3.5 \u7279\u5f81\u9009\u62e9\n\u5bf9\u4e8e\u591a\u4e2a\u7279\u5f81\uff0c\u4f8b\u5982\u623f\u5b50\u7684\u5bbd\u5ea6\u548c\u6df1\u5ea6\uff0c\u53ef\u4ee5\u8bbe\u9762\u79ef=\u5bbd\u5ea6*\u6df1\u5ea6\uff0c\u4ece\u800c\u5c06\u7279\u5f81\u51cf\u5c11\u3002\u4e5f\u5373\u63d0\u9192\uff0c\u7279\u5f81\u7684\u9009\u62e9\u5e94\u8be5\u9075\u5faa\u8be5\u7279\u5f81\u662f\u5bf9\u7ed3\u679c\u6709\u5f71\u54cd\u7684\u30023.5.1 \u591a\u9879\u5f0f\u56de\u5f52\n\u591a\u9879\u5f0f\u56de\u5f52\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u91c7\u53d6\u7ebf\u6027\u56de\u5f52\u7684\u65b9\u6cd5\u53bb\u62df\u5408\u975e\u5e38\u590d\u6742\u751a\u81f3\u662f\u975e\u7ebf\u6027\u7684\u51fd\u6570\u3002\u5982\u4e0b\u56fe\uff0c\u5c06\u4e00\u5143\u975e\u7ebf\u6027\u591a\u9879\u5f0f\u51fd\u6570\u7684n\u6b21\u65b9\u53d8\u91cf(n&gt;1)\uff0c\u4f5c\u4e3a\u4e00\u4e2a\u65b0\u7279\u5f81\u503c\uff0c\u4ece\u800c\u53d8\u6362\u6210\u591a\u5143\u7ebf\u6027\u591a\u9879\u5f0f\u51fd\u6570\u3002\u4f46\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6b64\u65f6\u9700\u8981\u5bf9n\u6b21\u65b9\u7684\u53d8\u91cf\u8fdb\u884c\u7279\u5f81\u7f29\u653e\u64cd\u4f5c\u3002\u591a\u9879\u5f0f\u66ff\u4ee3\u975e\u7ebf\u6027\u51fd\u65703.6 \u7279\u5f81\u5904\u7406\n3.5.1 \u5f52\u4e00\u5316\n\u82e5\u591a\u7279\u5f81\u503c\u95ee\u9898\u4e2d\uff0c\u4e0d\u540c\u7279\u5f81\u503c\u5728\u76f8\u8fd1\u8303\u56f4\u4e2d\u65f6\uff0c\u91c7\u7528\u7279\u5f81\u7f29\u653e\u53ef\u4f7f\u68af\u5ea6\u4e0b\u964d\u66f4\u5feb\u5730\u6536\u655b\u3002$x_i=\\frac{x_i}{s_i}$  \u5176\u4e2d$s_i$\u662f$x_i$\u7684\u53d6\u503c\u8303\u56f4\u5927\u5c0f$|max-min|$\u4e0b\u56fe\u4e2d\uff0c\u9488\u5bf9\u201c\u623f\u5c4b\u9762\u79ef\u201d\u548c\u201c\u623f\u95f4\u6570\u91cf\u201d\u4e24\u4e2a\u7279\u5f81\uff0c\u5176\u76f8\u53bb\u751a\u8fdc\uff0c\u8f6e\u5ed3\u56fe\u5982\u5de6\u4fa7\u6240\u793a\uff0c\u91c7\u7528\u68af\u5ea6\u4e0b\u964d\u65f6\uff0c\u5f80\u5f80\u9700\u8981\u5f88\u957f\u65f6\u95f4\u624d\u80fd\u66f2\u6298\u627e\u5230\u6536\u655b\u7684\u503c\u3002\u5f53\u6211\u4eec\u5c06\u7279\u5f81\u503c\u7684\u53d6\u503c\u8303\u56f4\u7f29\u653e\u5230[0,1]\u4e2d\u65f6\uff0c\u8f6e\u5ed3\u56fe\u5448\u8fd1\u4f3c\u5706\u5f62\uff0c\u6545\u6b64\u65f6\u8fdb\u884c\u68af\u5ea6\u4e0b\u964d\uff0c\u5c06\u4f1a\u66f4\u52a0\u5feb\u6377\u3002\u7279\u5f81\u7f29\u653e\u793a\u610f\u5b9e\u9645\u4e2d\u5e38\u7f29\u653e\u5230[-1,1]\u4e2d\uff0c\u4f46\u5e76\u975e\u8981\u6c42\u6bcf\u4e2a\u7279\u5f81\u503c\u90fd\u8981\u7f29\u653e\u5230\u8be5\u8303\u56f4\uff0c\u53ea\u8981\u5728[-1,1] \u7684\u9644\u8fd1\u5747\u53ef\uff0c\u4f8b\u5982[0,3] [-2,0.5]\uff0c\u672c\u8d28\u53ea\u662f\u5c06\u7279\u5f81\u503c\u8303\u56f4\u7684\u76f8\u5dee\u51cf\u5c0f\u3002\u540c\u7406\uff0c\u8fc7\u5c0f\u4e5f\u9700\u8981\u653e\u5927\u3002\u76ee\u524d\u7ecf\u9a8c\u5efa\u8bae\u7684\u8303\u56f4\u662f[-3,3] \u81f3 [-1/3,1/3] \u90fd\u65e0\u9700\u7f29\u653e\u3002\u5747\u503c\u5f52\u4e00\u5316\uff1a\u5c06\u7279\u5f81\u503c\u7684\u8303\u56f4\u5c3d\u91cf\u5173\u4e8e0\u5bf9\u79f0$x_i=\\frac{x_i-\\mu_i}{s_i}$  \u5176\u4e2d$\\mu_i$\u662f$x_i$\u7684\u5e73\u5747\u503c$\\frac{\\sum ^n _{i=1} {x_i}}{n}$3.4.2 \u6807\u51c6\u5316\n\u5c06\u7279\u5f81\u503c\u8f6c\u53d8\u4e3a\u5e73\u5747\u6570\u4e3a0\uff0c\u6807\u51c6\u5dee\u4e3a1\u7684\u96c6\u5408$x_i=\\frac{x_i-\\mu_i}{\\sigma}$ \u5176\u4e2d$\\sigma$\u662f\u8be5\u7279\u5f81\u96c6\u5408\u7684\u6807\u51c6\u5dee\n\u5f52\u4e00\u5316\u548c\u6807\u51c6\u5316\u7684\u533a\u522b\uff1a\u5f52\u4e00\u5316\u662f\u5c06\u6837\u672c\u7684\u7279\u5f81\u503c\u8f6c\u6362\u5230\u540c\u4e00\u91cf\u7eb2\u4e0b\u628a\u6570\u636e\u6620\u5c04\u5230[0,1]\u6216\u8005[-1, 1]\u533a\u95f4\u5185\uff0c\u4ec5\u7531\u53d8\u91cf\u7684\u6781\u503c\u51b3\u5b9a\uff0c\u56e0\u533a\u95f4\u653e\u7f29\u6cd5\u662f\u5f52\u4e00\u5316\u7684\u4e00\u79cd\u3002\u6807\u51c6\u5316\u662f\u4f9d\u7167\u7279\u5f81\u77e9\u9635\u7684\u5217\u5904\u7406\u6570\u636e\uff0c\u5176\u901a\u8fc7\u6c42z-score\u7684\u65b9\u6cd5\uff0c\u8f6c\u6362\u4e3a\u6807\u51c6\u6b63\u6001\u5206\u5e03\uff0c\u548c\u6574\u4f53\u6837\u672c\u5206\u5e03\u76f8\u5173\uff0c\u6bcf\u4e2a\u6837\u672c\u70b9\u90fd\u80fd\u5bf9\u6807\u51c6\u5316\u4ea7\u751f\u5f71\u54cd\u3002\u5b83\u4eec\u7684\u76f8\u540c\u70b9\u5728\u4e8e\u90fd\u80fd\u53d6\u6d88\u7531\u4e8e\u91cf\u7eb2\u4e0d\u540c\u5f15\u8d77\u7684\u8bef\u5dee\uff1b\u90fd\u662f\u4e00\u79cd\u7ebf\u6027\u53d8\u6362\uff0c\u90fd\u662f\u5bf9\u5411\u91cfX\u6309\u7167\u6bd4\u4f8b\u538b\u7f29\u518d\u8fdb\u884c\u5e73\u79fb\u3002\n3.4.3 \u8c03\u8bd5\n\u68af\u5ea6\u4e0b\u964d\u6b63\u5e38\u5de5\u4f5c\u7684\u6807\u51c6\uff1a $J(\\theta)$\u968f\u7740\u8fed\u4ee3\u6b21\u6570\u7684\u589e\u52a0\uff0c\u5355\u8c03\u9012\u51cf\uff0c\u4e14\u8d8b\u4e8e\u5e73\u7f13\u3002\u753b\u51fa $J(\\theta)$ \u2014 $iteraNum$ \u7684\u56fe\u50cf\uff0c\u4e0b\u56fe\u4e3a\u6b63\u5e38\u5de5\u4f5c\u7684\u56fe\u50cf\u3002\u6b63\u5e38\u5de5\u4f5c\u7684Gradient-Descent\u4e0b\u56fe\u4e3a\u5b66\u4e60\u901f\u7387$\u03b1$\u4e0d\u5408\u9002\u5bfc\u81f4\u6ca1\u6709\u6b63\u5e38\u5de5\u4f5c\u7684\u56fe\u50cf\u3002\u975e\u6b63\u5e38\u5de5\u4f5c\u7684Gradient-Descent\n\u5982\u679c$\u03b1$\u592a\u5c0f\uff0c\u5219\u6536\u655b\u901f\u5ea6\u592a\u6162\u3002\n\u5982\u679c$\u03b1$\u592a\u5927\uff0c\u5219\u53ef\u80fd\u65e0\u6cd5\u8fed\u4ee3\u51fa\u6700\u5c0f\u503c\u3002\n\n\u6545\u5b66\u4e60\u901f\u7387$\u03b1$\u53ef\u4ee5\u901a\u8fc7\u4e0a\u8ff0 $J(\\theta)$ \u2014 $iteraNum$ \u56fe\uff0c\u6765\u5224\u65ad\u68af\u5ea6\u4e0b\u964d\u7b97\u6cd5\u662f\u5426\u80fd\u6b63\u5e38\u8fdb\u884c\u30023.7 \u7ebf\u6027\u56de\u5f52\u603b\u7ed3\u53caCode\n\n\u6839\u636e\u8fde\u9501\u5e97\u5728\u57ce\u5e02\u7684\u6b22\u8fce\u7a0b\u5ea6\uff0c\u5224\u65ad\u76c8\u5229\n\u6839\u636e\u6570\u636e\u96c6\u4e2d\uff0c\u623f\u5b50\u9762\u79ef\u3001\u623f\u95f4\u6570\uff0c\u5224\u65ad\u623f\u5b50\u51fa\u552e\u4ef7\u683c\n\n\u5355\u7279\u5f81\u7ebf\u6027\u56de\u5f52clear ; close all; clc\n\ninp_iterations = input(&#39;Please input iterations: &#39;);\t%\u8fed\u4ee3\u6b21\u6570\ninp_alpha = input(&#39;Please input alpha: &#39;);\t\t\t\t%\u5b66\u4e60\u901f\u7387\n\n%% ========== \u8bfb\u53d6\u6570\u636e ==========\nfprintf(&#39;\\nLoading dataset...\\n&#39;);\ndata = load(&#39;ex1data1.txt&#39;);\nn = size(data,2);\t\t\t\t\t\t%\u7279\u5f81+\u7ed3\u679c\u6570\uff08\u5217\u6570\uff09\nm = size(data,1);\t\t\t\t\t\t%\u6837\u672c\u6570\uff08\u884c\u6570\uff09\nX = data(:,1:n-1);\t\t\t\t\t%\u591a\u7279\u5f81\u7684\u5c5e\u6027\u503c\u77e9\u9635X\ny = data(:,n);\t\t\t\t\t\t%\u7ed3\u679c\u5411\u91cf\n\n%% ========== \u67e5\u770b\u6563\u70b9\u56fe\uff08\u5355\u7279\u5f81\uff09 ==========\nfprintf(&#39;\\nPlotting Data...\\n&#39;);\nfigure;\nplot(X, y, &#39;rx&#39;, &#39;MarkerSize&#39;, 10);\t\t\t%\u5927\u5c0f\u4e3a10\u7684\u7ea2\u8272\u5341\u5b57\u6563\u70b9\nxlabel(&#39;description of x-axis&#39;);\nylabel(&#39;description of y-axis&#39;);\n%kbhit();\t\t\t\t\t\t\t%\u6682\u505c\n\n%% ========== \u521d\u59cb\u5316 ==========\nfprintf(&#39;\\nInitialing Variables...\\n&#39;);\nX = [ones(m, 1), X];\t\t\t\t\t%\u8865\u5145\u4e00\u5217\u5e38\u65701\ntheta = zeros(n, 1);\t\t\t\t\t%\u521d\u59cb\u5316theta\u4e3an\u7ef4\u5411\u91cf\nfprintf(&#39;\\n&#39;);\niterations = inp_iterations;\t\t\t\t\t\t%\u8fed\u4ee3\u6b21\u6570\nalpha = inp_alpha;\t\t\t\t\t\t\t%\u5b66\u4e60\u901f\u7387\n\n%% ========== \u68af\u5ea6\u4e0b\u964d\u6cd5 ==========\n[theta, J_history] = gradientDescent(X, y, theta, alpha, iterations);\nfprintf(&#39;\\nTheta computed from gradient descent: \\n&#39;);\nfprintf(&#39; %f \\n&#39;, theta);\n%kbhit();\n\n%% ========== \u753b\u51fa\u7ebf\u6027\u56de\u5f52\u5f97\u51fa\u7684\u7ebf\u6027\u51fd\u6570\uff08\u5355\u7279\u5f81\uff09 ==========\nhold on;\t\t\t\t\t\t\t\t%\u5728\u79bb\u6563\u56fe\u4e2d\u753b\u7ebf\nplot(X(:,2:size(X,2)), X*theta, &#39;-&#39;);\t\t\t%X\u76842~n\u5217\u7528-\u7ebf\u753b\u51fa\nlegend(&#39;Training data&#39;,&#39;Linear regression&#39;);\nhold off;\n\n%% ========== \u5b66\u4e60\u901f\u7387-\u8fed\u4ee3\u6b21\u6570\u5173\u7cfb\u56fe ==========\nfigure;\nplot(1:numel(J_history), J_history, &#39;-b&#39;, &#39;LineWidth&#39;, 2);\nxlabel(&#39;Number of iterations&#39;);\nylabel(&#39;Cost J&#39;);\n\n%% ========== \u68af\u5ea6\u4e0b\u964d\u7ebf\u6027\u56de\u5f52\u9884\u6d4b ==========\n%\u68af\u5ea6\u4e0b\u964d\u6cd5\uff0c\u9700\u8981\u5bf9\u53c2\u6570\u8fdb\u884c\u76f8\u5e94\u7684\u7279\u5f81\u5904\u7406\nx_pre = [1650];\nx_pre = [ones(size(x_pre,1),1),x_pre];\t\t%\u8865\u51451\u5217\nprofit = x_pre * theta;\nfprintf([&#39;\\nPredicted profit ... \\n (using gradient descent):\\n $%f\\n&#39;], profit);\n\n%% ========== \u635f\u5931\u51fd\u6570\u8c03\u8bd5\uff08\u5355\u7279\u5f81\uff09 ==========\ncheckJtheta(X, y, theta);\n\n%% ========== \u6b63\u89c4\u65b9\u7a0b\u6cd5 ==========\ntheta = normalEqn(X, y);\nfprintf(&#39;\\nTheta computed from gradient descent: \\n&#39;);\nfprintf(&#39; %f \\n&#39;, theta);\n%kbhit();\n\n%% ========== \u6b63\u89c4\u65b9\u7a0b\u7ebf\u6027\u56de\u5f52\u9884\u6d4b ==========\n%\u6b63\u89c4\u65b9\u7a0b\u6cd5\u76f4\u63a5\u4ee3\u5165\u53c2\u6570\u5373\u53ef\nx_pre = [1650];\nx_pre = [ones(size(x_pre,1),1),x_pre];\nprofit = x_pre * theta;\nfprintf([&#39;\\nPredicted profit ... \\n (using normal equations):\\n $%f\\n&#39;], profit);\n\n\u591a\u7279\u5f81\u7ebf\u6027\u56de\u5f52clear ; close all; clc\n\ninp_iterations = input(&#39;Please input iterations: &#39;);\t%\u8fed\u4ee3\u6b21\u6570\ninp_alpha = input(&#39;Please input alpha: &#39;);\t\t\t\t%\u5b66\u4e60\u901f\u7387\n\n%% ========== \u8bfb\u53d6\u6570\u636e ==========\nfprintf(&#39;\\nLoading dataset...\\n&#39;);\ndata = load(&#39;ex1data2.txt&#39;);\nn = size(data,2);\t\t\t\t\t\t%\u7279\u5f81+\u7ed3\u679c\u6570\uff08\u5217\u6570\uff09\nm = size(data,1);\t\t\t\t\t\t%\u6837\u672c\u6570\uff08\u884c\u6570\uff09\nX = data(:,1:n-1);\t\t\t\t\t%\u591a\u7279\u5f81\u7684\u5c5e\u6027\u503c\u77e9\u9635X\ny = data(:,n);\t\t\t\t\t\t%\u7ed3\u679c\u5411\u91cf\n\n%% ========== \u7279\u5f81\u6807\u51c6\u5316\uff08\u591a\u7279\u5f81\uff09 ==========\n[X mu sigma] = featureNormalize(X);\t\t\t%\u5f97\u5230\u6807\u51c6\u5316\u7684X\u4ee5\u53ca\u5747\u503c\u548c\u6807\u51c6\u5dee\n\n%% ========== \u521d\u59cb\u5316 ==========\nfprintf(&#39;\\nInitialing Variables...\\n&#39;);\nX = [ones(m, 1), X];\t\t\t\t\t%\u8865\u5145\u4e00\u5217\u5e38\u65701\ntheta = zeros(n, 1);\t\t\t\t\t%\u521d\u59cb\u5316theta\u4e3an\u7ef4\u5411\u91cf\niterations = inp_iterations;\t\t\t\t\t\t%\u8fed\u4ee3\u6b21\u6570\nalpha = inp_alpha;\t\t\t\t\t\t\t%\u5b66\u4e60\u901f\u7387\n\n%% ========== \u68af\u5ea6\u4e0b\u964d\u6cd5 ==========\n[theta, J_history] = gradientDescent(X, y, theta, alpha, iterations);\nfprintf(&#39;\\nTheta computed from gradient descent: \\n&#39;);\nfprintf(&#39; %f \\n&#39;, theta);\n%kbhit();\n\n%% ========== \u68af\u5ea6\u4e0b\u964d\u7ebf\u6027\u56de\u5f52\u9884\u6d4b ==========\n%\u68af\u5ea6\u4e0b\u964d\u6cd5\uff0c\u9884\u6d4b\u65f6\u9700\u8981\u5bf9\u53c2\u6570\u8fdb\u884c\u76f8\u5e94\u7684\u7279\u5f81\u5904\u7406\nx_pre = [1650 3];\nx_pre_norm = (x_pre - mu)./sigma;\t\t\t\t\t\t\t%\u7279\u5f81\u6807\u51c6\u5316\nx_pre_norm = [ones(size(x_pre_norm,1),1),x_pre_norm];\t\t%\u8865\u51451\u5217\nprice = x_pre_norm * theta;\nfprintf([&#39;\\nPredicted price ... \\n (using gradient descent):\\n $%f\\n&#39;], price);\n\n%% ========== \u5b66\u4e60\u901f\u7387-\u8fed\u4ee3\u6b21\u6570\u5173\u7cfb\u56fe ==========\nfigure;\nplot(1:numel(J_history), J_history, &#39;-b&#39;, &#39;LineWidth&#39;, 2);\nxlabel(&#39;Number of iterations&#39;);\nylabel(&#39;Cost J&#39;);\n\n%% ========== \u6b63\u89c4\u65b9\u7a0b\u6cd5 ==========\nX = data(:,1:n-1);\t\t\t\t\t%\u6d88\u9664\u7279\u5f81\u6807\u51c6\u5316\u5f71\u54cd\nX = [ones(m, 1), X];\t\t\t\t\t%\u8865\u5145\u4e00\u5217\u5e38\u65701\ntheta = normalEqn(X, y);\nfprintf(&#39;\\nTheta computed from gradient descent: \\n&#39;);\nfprintf(&#39; %f \\n&#39;, theta);\n%kbhit();\n\n%% ========== \u6b63\u89c4\u65b9\u7a0b\u7ebf\u6027\u56de\u5f52\u9884\u6d4b ==========\n%\u6b63\u89c4\u65b9\u7a0b\u6cd5\u76f4\u63a5\u4ee3\u5165\u53c2\u6570\u5373\u53ef\nx_pre = [1650 3];\nx_pre = [ones(size(x_pre,1),1),x_pre];\nprice = x_pre * theta;\nfprintf([&#39;\\nPredicted price ... \\n (using normal equations):\\n $%f\\n&#39;], price);\n\n\u635f\u5931\u51fd\u6570\u4f9d\u636e\u516c\u5f0f\uff1a$J(\\theta)=\\frac{1}{2m}  \\sum ^m _{i=1} (h_\u03b8(x^{(i)})-y^{(i)})^2$%\u8be5\u635f\u5931\u51fd\u6570\u4e3a\u5e73\u65b9\u5dee\u51fd\u6570\nfunction J = computeCost(X, y, theta)\n\nm = length(y);\t\t\t\t% number of training examples\nsqrErrors = (X*theta-y).^2;\t\t%squared errors\nJ = 1/(2*m) * sum(sqrErrors);\n\nend\n\n\u7279\u5f81\u6807\u51c6\u5316\u51fd\u6570\u4f9d\u636e\u516c\u5f0f\uff1a$x_i=\\frac{x_i-\\mu_i}{\\sigma}$function [X_norm, mu, sigma] = featureNormalize(X)\n\nX_norm = X;\nmu = zeros(1, size(X, 2));\t\t\t\t%\u5747\u503c\u5411\u91cf\u521d\u59cb\u5316\nsigma = zeros(1, size(X, 2));\t\t\t%\u6807\u51c6\u5dee\u5411\u91cf\u521d\u59cb\u5316\n\nmu = mean(X);    \t\t\t\t\t\t%\u8ba1\u7b97\u6bcf\u4e2a\u7279\u5f81\u7684\u5747\u503c\nsigma = std(X);    \t\t\t\t\t\t%\u8ba1\u7b97\u6bcf\u4e2a\u7279\u5f81\u7684\u6807\u51c6\u5dee\nX_norm = (X - mu) ./ sigma;    \t\t\t%\u8ba1\u7b97\u6807\u51c6\u5316\u540e\u7684\u7279\u5f81\u77e9\u9635\n\nend\n\n\u68af\u5ea6\u4e0b\u964d\u51fd\u6570\u4f9d\u636e\u516c\u5f0f\uff1a$\\theta_j:=\\theta_j-\u03b1 \\frac{1}{m} \\sum ^m _{i=1} (h_\u03b8(x^{(i)})-y^{(i)})\\cdot x^{(i)}_j$function [theta, J_history] = gradientDescent(X, y, theta, alpha, num_iters)\n\n% Initialize some useful values\nm = length(y); % number of training examples\nJ_history = zeros(num_iters, 1);\n\nfor iter = 1:num_iters\n    theta = theta - (alpha/m)*X&#39;*(X*theta - y);\n    J_history(iter) = computeCost(X, y, theta);\nend\n\nend\n\n\u6b63\u89c4\u65b9\u7a0b\u51fd\u6570\u4f9d\u636e\u516c\u5f0f\uff1a $\\theta=(X^TX)^{-1}X^Ty$function [theta] = normalEqn(X, y)\n\ntheta = zeros(size(X, 2), 1);\ntheta = pinv(X&#39; * X) * X&#39; * y;\t\t\t%pinv()\u8fd4\u56de\u77e9\u9635\u4f2a\u9006\u9635\n\nend\n\n3D\u51fd\u6570&amp;\u8f6e\u5ed3\u56fe\u5224\u65ad\u68af\u5ea6\u4e0b\u964d\u6027\u80fd\u51fd\u6570\uff08\u5355\u7279\u5f81\uff09\uff1a%\u5224\u65ad\u635f\u5931\u51fd\u6570\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\nfunction checkJtheta(X, y, theta)\n\nfprintf(&#39;\\nVisualizing J(theta_0, theta_1) ...\\n&#39;);\n\ntheta0_vals = linspace(-10, 10, 100);\t\t\t%theta0\u8303\u56f4\ntheta1_vals = linspace(-1, 4, 100);\t\t\t\t%theta1\u8303\u56f4\nJ_vals = zeros(length(theta0_vals), length(theta1_vals));\t%\u521d\u59cb\u5316J\u4e3a0\u9635\n\n% \u8ba1\u7b97\u4e0d\u540c\u03b8\u8303\u56f4\u5185\uff0cJ\u7684\u503c\nfor i = 1:length(theta0_vals)\n    for j = 1:length(theta1_vals)\n      t = [theta0_vals(i); theta1_vals(j)];\n      J_vals(i,j) = computeCost(X, y, t);\n    end\nend\n\nJ_vals = J_vals&#39;;\n\n% \u66f2\u9762\u56fe\nsubplot(1,2,1);\nsurf(theta0_vals, theta1_vals, J_vals);\nxlabel(&#39;\\theta_0&#39;); ylabel(&#39;\\theta_1&#39;);\n\n% \u8f6e\u5ed3\u56fe\nsubplot(1,2,2);\n% Plot J_vals as 15 contours spaced logarithmically between 0.01 and 100\ncontour(theta0_vals, theta1_vals, J_vals, logspace(-2, 3, 20))\nxlabel(&#39;\\theta_0&#39;); ylabel(&#39;\\theta_1&#39;);\nhold on;\nplot(theta(1), theta(2), &#39;rx&#39;, &#39;MarkerSize&#39;, 10, &#39;LineWidth&#39;, 2);\n\nend\n\n\n4 \u903b\u8f91\u56de\u5f52\n4.1 \u903b\u8f91\u56de\u5f52\u4e0e\u7ebf\u6027\u56de\u5f52\u5173\u7cfb\n\u903b\u8f91\u56de\u5f52\u662f\u5206\u7c7b\u95ee\u9898\uff0c\u5e76\u975e\u56de\u5f52\u95ee\u9898\uff0c\u4f46\u5b83\u662f\u57fa\u4e8e\u7ebf\u6027\u51fd\u6570\u7684\u3002\u7528\u6765\u9884\u6d4b\u5b83\u5c5e\u4e8e\u67d0\u4e2a\u5206\u7c7b\u7684\u6982\u7387\u3002\u601d\u8003\uff1a\u6211\u4eec\u4e4b\u524d\u5b66\u8fc7\u7ebf\u6027\u56de\u5f52\uff0c\u6211\u4eec\u662f\u5426\u80fd\u901a\u8fc7\u7ebf\u6027\u56de\u5f52\u89e3\u51b3\u95ee\u9898\u5462\uff1f\u5982\u679c\u6309\u7167\u7ebf\u6027\u56de\u5f52\u7684\u601d\u8def\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4eba\u4f53\u5185\u80bf\u7624\u7684\u5927\u5c0f\u7ebf\u6027\u56de\u5f52\u5f97\u5230\u4e00\u4e2a\u503c\uff0c\u7136\u540e\u6211\u4eec\u8bbe\u7f6e\u4e00\u4e2a\u5e73\u5747\u503c\u6216\u9608\u503c\uff0c\u8bbe\u4e3ay\u3002\u5f53\u7ebf\u6027\u56de\u5f52\u51fa\u7684\u503c\u5927\u4e8ey\u5219\u4e3a\u6076\u6027\u80bf\u7624\uff0c\u5c0f\u4e8ey\u5219\u4e3a\u826f\u6027\u80bf\u7624\u3002\u4e8e\u662f\uff0c\u6211\u4eec\u901a\u8fc7\u8bbe\u7f6e \u5e73\u5747\u503c/\u9608\u503c\uff08\u51b3\u7b56\u8fb9\u754c\uff09 \uff0c\u5c06\u7ebf\u6027\u56de\u5f52\u95ee\u9898\u8f6c\u5316\u4e3a\u4e86\u5206\u7c7b\u95ee\u9898\u3002\u5982\u4e0b\u56fe\uff1a\u7528\u7ebf\u6027\u56de\u5f52\u505a\u5206\u7c7b\u95ee\u9898\u56fe\u4e2d\uff0c0.5\u4e3a\u9608\u503c\uff0c\u659c\u7ebf\u4e3a\u7ebf\u6027\u56de\u5f52\u7684\u5047\u8bbe\u51fd\u6570\uff0c\u5f53\u503c\u5c0f\u4e8e\u9608\u503c\u65f6\uff0c\u4e3a\u826f\u6027\uff0c\u53cd\u4e4b\u4e3a\u6076\u6027\u3002\u4f46\u8fd9\u4e2a\u505a\u6cd5\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff0c\u5f53\u51fa\u73b0\u79bb\u7fa4\u503c\uff08\u5f02\u5e38\u503c\uff09\u65f6\uff0c\u7ebf\u6027\u56de\u5f52\u4f1a\u53d7\u5230\u5f88\u5927\u7684\u5f71\u54cd\uff0c\u5982\u4e0b\u56fe\uff1a\u7ebf\u6027\u56de\u5f52\u51fa\u73b0\u79bb\u7fa4\u503c\u7684\u60c5\u51b5\u4ece\u4e0a\u56fe\u6211\u4eec\u53ef\u4ee5\u4e86\u89e3\u5230\uff0c\u901a\u8fc7\u7ebf\u6027\u56de\u5f52\u62df\u5408\u51fa\u51fd\u6570\u518d\u53d6\u9608\u503c\u5206\u7c7b\u7684\u65b9\u6cd5\u4e0d\u4e00\u5b9a\u6709\u6548\uff0c\u56e0\u4e3a\u7ebf\u6027\u51fd\u6570\u662f\u201c\u76f4\u201d\u7684\uff0c\u82e5\u5b58\u5728\u79bb\u7fa4\u503c\u5219\u5bf9\u51fd\u6570\u5f71\u54cd\u975e\u5e38\u5927\u3002\u6240\u4ee5\u6211\u4eec\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u505a\u4e9b\u5904\u7406\uff1a\n\u5047\u8bbe\u51fd\u6570\u6539\u7528\u975e\u7ebf\u6027\u51fd\u6570\n\u53bb\u6389\u4e25\u91cd\u5f71\u54cd\u51fd\u6570\u7684\u79bb\u7fa4\u503c\n\u9009\u5b9a\u4e00\u4e2a\u5408\u9002\u7684\u9608\u503c\n\n4.2 \u5047\u8bbe\u51fd\u6570\u7684\u9009\u62e9\n\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u4e86\u89e3\u4e00\u4e2a\u51fd\u6570\uff1aSigmoid Function (S\u5f62\u51fd\u6570)\n$S(x)=\\frac{1}{1+e^{-x}}$  \uff0c\u5b83\u662f\u4e00\u4e2a\u975e\u7ebf\u6027\u51fd\u6570\n$S^{'}(x)=\\frac{e^{-x}}{(1+e^{-x})^2}=S(x)(1-S(x))$ \uff0c\u5b83\u6613\u4e8e\u6c42\u5bfc\uff0c\u5355\u8c03\u9012\u589e\uff0c\u4e14\u53cd\u51fd\u6570\u540c\u6837\u5355\u589e\n$S(0)=0.5$\n$S(x)\\in(0,1)$ \u5728x\u8d8b\u4e8e\u65e0\u7a77\u65f6\uff0c\u51fd\u6570\u63a5\u8fd1\u4e8e\u5e73\u6ed1\uff0c\u6545\u5bf9\u8d85\u8fc7\u4e00\u5b9a\u8303\u56f4\u7684\u8f93\u5165\u503c\u4e0d\u654f\u611f\n$S(x)$\u80fd\u5c06$(-\u221e,+\u221e)$\u7684\u8f93\u5165\u6620\u5c04\u5230$(0,1)$\uff0c\u4ece\u800c\u53ef\u4ee5\u4f5c\u4e3a\u6982\u7387\u7684\u5f62\u5f0f\u3002\n\u53ef\u505a\u903b\u8f91\u56de\u5f52\u4e2d\u7684\u4e8c\u5206\u7c7b\u3001\u795e\u7ecf\u7f51\u7edc\u7684\u6fc0\u6d3b\u51fd\u6570\n\nsigmoid\u51fd\u6570\u56fe\u50cf\u57fa\u4e8e\u4ee5\u4e0a\u7279\u70b9\uff0c\u6211\u4eec\u5728\u903b\u8f91\u56de\u5f52\u4e2d\u4fbf\u9009\u62e9\u4f7f\u7528\u5b83\u4f5c\u4e3a\u5047\u8bbe\u51fd\u6570\uff1a$h_\\theta(x)=g(\\theta^Tx)$\n$z=\\theta^Tx$\n$g(z)=\\frac{1}{1+e^{\u2212z}}$\n$h_\\theta(x) = P(y=1 | x ; \\theta) = 1 - P(y=0 | x ; \\theta)$\n$P(y = 0 | x;\\theta) + P(y = 1 | x ; \\theta) = 1$\n\n\n\u5173\u4e8e\u4e3a\u4ec0\u4e48\u9009\u62e9\u7684\u662fSigmoid\u51fd\u6570\uff0c\u8bf7\u53c2\u8003\u6731\u5148\u751f1994\u7684\u535a\u5ba2\n4.3 \u9608\u503c\u7684\u9009\u62e9\n", "categories": [{"name": "\u5b66\u4e60", "slug": "\u5b66\u4e60", "permalink": "https://blog.imadamtang.cn/category/%E5%AD%A6%E4%B9%A0/"}], "tags": []}], "pages": [{"title": "\u5173\u4e8e", "date": "2024-06-01T00:00:00+08.00", "path": "https://blog.imadamtang.cn/About/", "text": "Hope the only prescription is suffering.", "categories": [], "tags": []}]}